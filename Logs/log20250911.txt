2025-09-11 14:05:33.078 +03:00 [INF] DB tables already exist. Exit install
2025-09-11 14:05:35.200 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 14:05:36.435 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 14:05:37.129 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 14:05:37.343 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-09-11 14:05:37.364 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-11 14:05:37.374 +03:00 [INF] Starting data seeding...
2025-09-11 14:05:37.401 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-11 14:05:38.011 +03:00 [INF] Executed DbCommand (118ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-09-11 14:05:38.093 +03:00 [INF] Role 'Admin' already exists.
2025-09-11 14:05:38.250 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-09-11 14:05:38.258 +03:00 [INF] Role 'User' already exists.
2025-09-11 14:05:38.439 +03:00 [INF] Executed DbCommand (80ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-09-11 14:05:38.847 +03:00 [INF] Admin user already exists. Skipping provider/method creation.
2025-09-11 14:05:38.850 +03:00 [INF] Data seeding completed successfully.
2025-09-11 14:05:40.448 +03:00 [INF] Now listening on: http://localhost:5069
2025-09-11 14:05:40.704 +03:00 [INF] Starting Hangfire Server using job storage: 'Server: mysql-3581f657-omargamal1132004-b0c1.b.aivencloud.com@Fashion_Site'
2025-09-11 14:05:42.180 +03:00 [INF] Using the following options for SQL Server job storage:
2025-09-11 14:05:42.552 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-09-11 14:05:43.642 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-09-11 14:05:46.892 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-11 14:05:47.069 +03:00 [INF] Server mrrobot:19504:e37a0ac6 successfully announced in 161.3607 ms
2025-09-11 14:05:47.662 +03:00 [INF] Hosting environment: Development
2025-09-11 14:05:47.707 +03:00 [INF] Server mrrobot:19504:e37a0ac6 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-09-11 14:05:47.739 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-09-11 14:05:48.393 +03:00 [INF] Server mrrobot:19504:e37a0ac6 all the dispatchers started
2025-09-11 14:05:48.799 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-09-11 14:05:50.857 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 2046.2515ms
2025-09-11 14:05:51.032 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-09-11 14:05:51.035 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-09-11 14:05:51.349 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-09-11 14:05:51.711 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 674.1075ms
2025-09-11 14:05:51.737 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 701.9681ms
2025-09-11 14:05:52.153 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 804.2988ms
2025-09-11 14:05:52.659 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-09-11 14:05:53.311 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 651.4034ms
2025-09-11 14:10:48.053 +03:00 [INF] 1 servers were removed due to timeout
2025-09-11 15:14:34.327 +03:00 [INF] DB tables already exist. Exit install
2025-09-11 15:14:35.445 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 15:14:36.390 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 15:14:37.078 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 15:14:37.254 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-09-11 15:14:37.289 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-11 15:14:37.301 +03:00 [INF] Starting data seeding...
2025-09-11 15:14:37.327 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-11 15:14:37.933 +03:00 [INF] Executed DbCommand (128ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-09-11 15:14:38.000 +03:00 [INF] Role 'Admin' already exists.
2025-09-11 15:14:38.156 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-09-11 15:14:38.174 +03:00 [INF] Role 'User' already exists.
2025-09-11 15:14:38.349 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-09-11 15:14:38.449 +03:00 [INF] Admin user already exists. Skipping provider/method creation.
2025-09-11 15:14:38.453 +03:00 [INF] Data seeding completed successfully.
2025-09-11 15:14:39.676 +03:00 [INF] Now listening on: http://localhost:5069
2025-09-11 15:14:39.756 +03:00 [INF] Starting Hangfire Server using job storage: 'Server: mysql-3581f657-omargamal1132004-b0c1.b.aivencloud.com@Fashion_Site'
2025-09-11 15:14:39.760 +03:00 [INF] Using the following options for SQL Server job storage:
2025-09-11 15:14:39.765 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-09-11 15:14:39.768 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-09-11 15:14:39.780 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-11 15:14:39.783 +03:00 [INF] Hosting environment: Development
2025-09-11 15:14:39.786 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-09-11 15:14:39.977 +03:00 [INF] Server mrrobot:13772:1e588354 successfully announced in 187.2444 ms
2025-09-11 15:14:39.984 +03:00 [INF] Server mrrobot:13772:1e588354 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-09-11 15:14:40.018 +03:00 [INF] Server mrrobot:13772:1e588354 all the dispatchers started
2025-09-11 15:14:41.195 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-09-11 15:14:41.633 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 444.1025ms
2025-09-11 15:14:41.700 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-09-11 15:14:41.701 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-09-11 15:14:41.710 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 9.9974ms
2025-09-11 15:14:41.712 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-09-11 15:14:41.753 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 51.4141ms
2025-09-11 15:14:41.956 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 244.6112ms
2025-09-11 15:14:42.108 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-09-11 15:14:42.628 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 520.2144ms
2025-09-11 15:15:26.130 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/health - null null
2025-09-11 15:15:26.181 +03:00 [WRN] Failed to determine the https port for redirect.
2025-09-11 15:15:26.461 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 15:15:26.474 +03:00 [INF] No cached response available for this request.
2025-09-11 15:15:26.508 +03:00 [INF] Executing endpoint 'Health checks'
2025-09-11 15:15:26.533 +03:00 [INF] Executed endpoint 'Health checks'
2025-09-11 15:15:26.535 +03:00 [INF] The response could not be cached for this request.
2025-09-11 15:15:26.537 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/health - 200 null text/plain 407.3652ms
2025-09-11 15:15:26.678 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/favicon.ico - null null
2025-09-11 15:15:26.686 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 15:15:26.690 +03:00 [INF] No cached response available for this request.
2025-09-11 15:15:26.693 +03:00 [INF] The response could not be cached for this request.
2025-09-11 15:15:26.695 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/favicon.ico - 404 0 null 16.9016ms
2025-09-11 15:15:26.702 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5069/favicon.ico, Response status code: 404
2025-09-11 15:15:49.142 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/health - null null
2025-09-11 15:15:49.187 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 15:15:49.241 +03:00 [INF] No cached response available for this request.
2025-09-11 15:15:49.270 +03:00 [INF] Executing endpoint 'Health checks'
2025-09-11 15:15:49.273 +03:00 [INF] Executed endpoint 'Health checks'
2025-09-11 15:15:49.279 +03:00 [INF] The response could not be cached for this request.
2025-09-11 15:15:49.283 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/health - 200 null text/plain 140.8991ms
2025-09-11 15:15:54.262 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/healthy - null null
2025-09-11 15:15:54.273 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 15:15:54.276 +03:00 [INF] No cached response available for this request.
2025-09-11 15:15:54.279 +03:00 [INF] The response could not be cached for this request.
2025-09-11 15:15:54.287 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/healthy - 404 0 null 24.9225ms
2025-09-11 15:15:54.300 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5069/healthy, Response status code: 404
2025-09-11 15:15:59.187 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/health - null null
2025-09-11 15:15:59.234 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 15:15:59.237 +03:00 [INF] No cached response available for this request.
2025-09-11 15:15:59.283 +03:00 [INF] Executing endpoint 'Health checks'
2025-09-11 15:15:59.301 +03:00 [INF] Executed endpoint 'Health checks'
2025-09-11 15:15:59.308 +03:00 [INF] The response could not be cached for this request.
2025-09-11 15:15:59.320 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/health - 200 null text/plain 133.387ms
2025-09-11 16:44:30.860 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 16:44:31.747 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 16:44:57.608 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 16:44:59.552 +03:00 [INF] Executed DbCommand (103ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 16:45:00.247 +03:00 [INF] Executed DbCommand (78ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 16:45:00.421 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-09-11 16:45:00.453 +03:00 [INF] Applying migration '20250911134433_addrowvsersion'.
2025-09-11 16:45:01.130 +03:00 [ERR] Failed executing DbCommand (198ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `ReturnRequests` ADD `RowVersion` timestamp(6) NOT NULL DEFAULT '0001-01-01 00:00:00' ON UPDATE CURRENT_TIMESTAMP(6);
2025-09-11 16:47:00.365 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 16:47:01.082 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 16:47:03.433 +03:00 [INF] Executed DbCommand (88ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 16:47:03.605 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-09-11 16:48:26.704 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 16:48:27.488 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 16:48:39.756 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 16:48:41.485 +03:00 [INF] Executed DbCommand (84ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 16:48:42.168 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 16:48:42.374 +03:00 [INF] Executed DbCommand (78ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-09-11 16:48:42.409 +03:00 [INF] Applying migration '20250911134828_addrowvsersion'.
2025-09-11 16:48:43.028 +03:00 [INF] Executed DbCommand (205ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `ReturnRequests` ADD `RowVersion` binary(8) NULL;
2025-09-11 16:48:43.141 +03:00 [INF] Executed DbCommand (113ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `ProductVariants` ADD `RowVersion` binary(8) NULL;
2025-09-11 16:48:43.265 +03:00 [INF] Executed DbCommand (124ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `Payments` ADD `RowVersion` binary(8) NULL;
2025-09-11 16:48:43.377 +03:00 [INF] Executed DbCommand (111ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `Orders` ADD `RowVersion` binary(8) NULL;
2025-09-11 16:48:43.475 +03:00 [INF] Executed DbCommand (98ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `CartItems` ADD `RowVersion` binary(8) NULL;
2025-09-11 16:48:43.550 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `__EFMigrationsHistory` (`MigrationId`, `ProductVersion`)
VALUES ('20250911134828_addrowvsersion', '8.0.13');
2025-09-11 17:19:31.658 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 17:19:32.654 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 17:20:29.978 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 17:20:32.532 +03:00 [INF] Executed DbCommand (100ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 17:20:33.282 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 17:20:33.486 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-09-11 17:20:33.532 +03:00 [INF] Applying migration '20250911141934_upadate-delete-behavior'.
2025-09-11 17:20:34.394 +03:00 [INF] Executed DbCommand (190ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `Images` DROP FOREIGN KEY `FK_Images_Categories_CategoryId`;
2025-09-11 17:20:34.482 +03:00 [INF] Executed DbCommand (88ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `Images` DROP FOREIGN KEY `FK_Images_Collections_CollectionId`;
2025-09-11 17:20:34.579 +03:00 [INF] Executed DbCommand (97ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `Images` DROP FOREIGN KEY `FK_Images_Products_ProductId`;
2025-09-11 17:20:34.665 +03:00 [INF] Executed DbCommand (86ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `Images` DROP FOREIGN KEY `FK_Images_SubCategories_SubCategoryId`;
2025-09-11 17:20:34.755 +03:00 [ERR] Failed executing DbCommand (87ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `WishlistItems` DROP INDEX `IX_WishlistItems_CustomerId`;
2025-09-11 17:22:19.933 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 17:22:21.688 +03:00 [INF] Executed DbCommand (98ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 17:22:22.365 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 17:22:22.554 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-09-11 17:22:22.579 +03:00 [INF] Applying migration '20250911141934_upadate-delete-behavior'.
2025-09-11 17:22:23.086 +03:00 [ERR] Failed executing DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `Images` DROP FOREIGN KEY `FK_Images_Categories_CategoryId`;
2025-09-11 17:25:27.613 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 17:25:28.179 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 17:25:30.486 +03:00 [INF] Executed DbCommand (81ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 17:25:30.657 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-09-11 17:25:52.879 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 17:25:53.686 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 17:26:42.001 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 17:26:43.614 +03:00 [INF] Executed DbCommand (81ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 17:26:44.308 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 17:26:44.491 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-09-11 17:26:44.508 +03:00 [INF] Applying migration '20250911142554_update-delete-behavior'.
2025-09-11 17:26:44.991 +03:00 [ERR] Failed executing DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `Images` DROP FOREIGN KEY `FK_Images_Categories_CategoryId`;
2025-09-11 17:27:21.027 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 17:27:22.685 +03:00 [INF] Executed DbCommand (82ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 17:27:23.366 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 17:27:23.536 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-09-11 17:27:23.565 +03:00 [INF] Applying migration '20250911142554_update-delete-behavior'.
2025-09-11 17:27:24.057 +03:00 [ERR] Failed executing DbCommand (77ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `Images` DROP FOREIGN KEY `FK_Images_Collections_CollectionId`;
2025-09-11 17:27:53.451 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 17:27:55.148 +03:00 [INF] Executed DbCommand (81ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 17:27:55.837 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 17:27:56.019 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-09-11 17:27:56.056 +03:00 [INF] Applying migration '20250911142554_update-delete-behavior'.
2025-09-11 17:27:56.523 +03:00 [ERR] Failed executing DbCommand (74ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `WishlistItems` DROP INDEX `IX_WishlistItems_CustomerId`;
2025-09-11 17:28:15.686 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 17:28:17.363 +03:00 [INF] Executed DbCommand (82ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 17:28:18.040 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 17:28:18.208 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-09-11 17:28:18.233 +03:00 [INF] Applying migration '20250911142554_update-delete-behavior'.
2025-09-11 17:28:18.738 +03:00 [ERR] Failed executing DbCommand (83ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `Reviews` DROP INDEX `IX_Reviews_CustomerId`;
2025-09-11 17:28:34.470 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 17:28:36.199 +03:00 [INF] Executed DbCommand (82ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 17:28:36.911 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 17:28:37.080 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-09-11 17:28:37.124 +03:00 [INF] Applying migration '20250911142554_update-delete-behavior'.
2025-09-11 17:28:37.689 +03:00 [INF] Executed DbCommand (129ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `Collections` MODIFY COLUMN `Name` varchar(255) CHARACTER SET utf8mb4 NOT NULL;
2025-09-11 17:28:37.776 +03:00 [INF] Executed DbCommand (87ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_WishlistItems_CustomerId_ProductId` ON `WishlistItems` (`CustomerId`, `ProductId`);
2025-09-11 17:28:37.863 +03:00 [INF] Executed DbCommand (87ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `IX_Warehouses_Name` ON `Warehouses` (`Name`);
2025-09-11 17:28:37.946 +03:00 [INF] Executed DbCommand (82ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_Reviews_CustomerId_ProductId` ON `Reviews` (`CustomerId`, `ProductId`);
2025-09-11 17:28:38.028 +03:00 [INF] Executed DbCommand (82ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_ReturnRequestProducts_ReturnRequestId_ProductId` ON `ReturnRequestProducts` (`ReturnRequestId`, `ProductId`);
2025-09-11 17:28:38.152 +03:00 [INF] Executed DbCommand (124ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `IX_Products_Name` ON `Products` (`Name`);
2025-09-11 17:28:38.292 +03:00 [INF] Executed DbCommand (140ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_Products_SubCategoryId_DiscountId` ON `Products` (`SubCategoryId`, `DiscountId`);
2025-09-11 17:28:38.379 +03:00 [INF] Executed DbCommand (86ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_ProductInventory_ProductId_WarehouseId` ON `ProductInventory` (`ProductId`, `WarehouseId`);
2025-09-11 17:28:38.473 +03:00 [INF] Executed DbCommand (93ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_ProductCollections_ProductId_CollectionId` ON `ProductCollections` (`ProductId`, `CollectionId`);
2025-09-11 17:28:38.610 +03:00 [INF] Executed DbCommand (137ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_Orders_Status` ON `Orders` (`Status`);
2025-09-11 17:28:38.708 +03:00 [INF] Executed DbCommand (98ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_Collections_Name` ON `Collections` (`Name`);
2025-09-11 17:28:38.815 +03:00 [INF] Executed DbCommand (100ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `IX_Categories_Name` ON `Categories` (`Name`);
2025-09-11 17:28:38.913 +03:00 [INF] Executed DbCommand (98ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_CartItems_CartId_ProductId_ProductVariantId` ON `CartItems` (`CartId`, `ProductId`, `ProductVariantId`);
2025-09-11 17:28:39.041 +03:00 [INF] Executed DbCommand (128ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `Images` ADD CONSTRAINT `FK_Images_Categories_CategoryId` FOREIGN KEY (`CategoryId`) REFERENCES `Categories` (`Id`) ON DELETE CASCADE;
2025-09-11 17:28:39.159 +03:00 [INF] Executed DbCommand (118ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `Images` ADD CONSTRAINT `FK_Images_Collections_CollectionId` FOREIGN KEY (`CollectionId`) REFERENCES `Collections` (`Id`) ON DELETE CASCADE;
2025-09-11 17:28:39.270 +03:00 [INF] Executed DbCommand (110ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `Images` ADD CONSTRAINT `FK_Images_Products_ProductId` FOREIGN KEY (`ProductId`) REFERENCES `Products` (`Id`) ON DELETE CASCADE;
2025-09-11 17:28:39.392 +03:00 [INF] Executed DbCommand (121ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `Images` ADD CONSTRAINT `FK_Images_SubCategories_SubCategoryId` FOREIGN KEY (`SubCategoryId`) REFERENCES `SubCategories` (`Id`) ON DELETE CASCADE;
2025-09-11 17:28:39.468 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `__EFMigrationsHistory` (`MigrationId`, `ProductVersion`)
VALUES ('20250911142554_update-delete-behavior', '8.0.13');
2025-09-11 17:28:53.469 +03:00 [INF] DB tables already exist. Exit install
2025-09-11 17:28:54.706 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 17:28:55.785 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 17:28:56.492 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 17:28:56.667 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-09-11 17:28:56.698 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-11 17:28:56.722 +03:00 [INF] Starting data seeding...
2025-09-11 17:28:56.765 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-11 17:28:57.262 +03:00 [INF] Executed DbCommand (113ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-09-11 17:28:57.339 +03:00 [INF] Role 'Admin' already exists.
2025-09-11 17:28:57.492 +03:00 [INF] Executed DbCommand (72ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-09-11 17:28:57.520 +03:00 [INF] Role 'User' already exists.
2025-09-11 17:28:57.698 +03:00 [INF] Executed DbCommand (79ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-09-11 17:28:57.819 +03:00 [INF] Admin user already exists. Skipping provider/method creation.
2025-09-11 17:28:57.822 +03:00 [INF] Data seeding completed successfully.
2025-09-11 17:28:59.289 +03:00 [INF] Now listening on: http://localhost:5069
2025-09-11 17:28:59.413 +03:00 [INF] Starting Hangfire Server using job storage: 'Server: mysql-3581f657-omargamal1132004-b0c1.b.aivencloud.com@Fashion_Site'
2025-09-11 17:28:59.435 +03:00 [INF] Using the following options for SQL Server job storage:
2025-09-11 17:28:59.450 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-09-11 17:28:59.466 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-09-11 17:28:59.504 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-11 17:28:59.520 +03:00 [INF] Hosting environment: Development
2025-09-11 17:28:59.586 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-09-11 17:28:59.685 +03:00 [INF] Server mrrobot:17284:f0c341fd successfully announced in 165.8485 ms
2025-09-11 17:28:59.692 +03:00 [INF] Server mrrobot:17284:f0c341fd is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-09-11 17:28:59.727 +03:00 [INF] Server mrrobot:17284:f0c341fd all the dispatchers started
2025-09-11 17:29:00.269 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-09-11 17:29:00.683 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 414.9333ms
2025-09-11 17:29:00.757 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-09-11 17:29:00.766 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-09-11 17:29:00.988 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-09-11 17:29:01.004 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 247.0247ms
2025-09-11 17:29:01.119 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 131.4283ms
2025-09-11 17:29:01.231 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 465.276ms
2025-09-11 17:29:01.383 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-09-11 17:29:01.635 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 252.2629ms
2025-09-11 17:29:12.509 +03:00 [INF] Executing GetByIdAsync for entity Order with ID: 123
2025-09-11 17:29:12.714 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`Id`, `o`.`CancelledAt`, `o`.`CreatedAt`, `o`.`CustomerAddressId`, `o`.`CustomerId`, `o`.`DeletedAt`, `o`.`DeliveredAt`, `o`.`DiscountAmount`, `o`.`ModifiedAt`, `o`.`Notes`, `o`.`OrderNumber`, `o`.`RestockedAt`, `o`.`RowVersion`, `o`.`ShippedAt`, `o`.`ShippingCost`, `o`.`Status`, `o`.`Subtotal`, `o`.`TaxAmount`, `o`.`Total`
FROM `Orders` AS `o`
WHERE `o`.`Id` = @__id_0
LIMIT 1
2025-09-11 17:29:13.329 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@p1='?' (DbType = Int32), @p2='?' (Size = 8) (DbType = Binary), @p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
UPDATE `Orders` SET `Status` = @p0
WHERE `Id` = @p1 AND `RowVersion` IS NULL;
SELECT `RowVersion`
FROM `Orders`
WHERE ROW_COUNT() = 1 AND `Id` = @p1;
2025-09-11 17:29:22.160 +03:00 [INF] Order 123 auto-expired and restock scheduled
2025-09-11 17:29:22.413 +03:00 [INF] Executing GetByIdAsync for entity Order with ID: 123
2025-09-11 17:29:22.481 +03:00 [INF] Removing cache by tags: [variantlist, variantdata]
2025-09-11 17:29:22.574 +03:00 [INF] Executed DbCommand (79ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`Id`, `o`.`CancelledAt`, `o`.`CreatedAt`, `o`.`CustomerAddressId`, `o`.`CustomerId`, `o`.`DeletedAt`, `o`.`DeliveredAt`, `o`.`DiscountAmount`, `o`.`ModifiedAt`, `o`.`Notes`, `o`.`OrderNumber`, `o`.`RestockedAt`, `o`.`RowVersion`, `o`.`ShippedAt`, `o`.`ShippingCost`, `o`.`Status`, `o`.`Subtotal`, `o`.`TaxAmount`, `o`.`Total`
FROM `Orders` AS `o`
WHERE `o`.`Id` = @__id_0
LIMIT 1
2025-09-11 17:29:22.668 +03:00 [INF] Removing cache by tags: [Product, Productwithdata]
2025-09-11 17:29:22.669 +03:00 [INF] Removing cache by tags: [collection, CollectionWithProduct]
2025-09-11 17:29:22.923 +03:00 [INF] Removing cache by tags: [order]
2025-09-11 17:29:23.634 +03:00 [INF] Execute GetAll for entity OrderItem
2025-09-11 17:29:23.683 +03:00 [WRN] No cache entries found for tags: [variantlist, variantdata]
2025-09-11 17:29:24.019 +03:00 [WRN] No cache entries found for tags: [order]
2025-09-11 17:29:24.182 +03:00 [INF] Executed DbCommand (232ms) [Parameters=[@__orderId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`ProductVariantId`, `o`.`Quantity`
FROM `OrderItem` AS `o`
WHERE `o`.`OrderId` = @__orderId_0
2025-09-11 17:29:24.282 +03:00 [INF] Adding quantity for variant: 6
2025-09-11 17:29:24.295 +03:00 [WRN] No cache entries found for tags: [Product, Productwithdata]
2025-09-11 17:29:24.295 +03:00 [WRN] No cache entries found for tags: [collection, CollectionWithProduct]
2025-09-11 17:29:24.986 +03:00 [INF] Executing GetByIdAsync for entity ProductVariant with ID: 6
2025-09-11 17:29:25.346 +03:00 [INF] Executed DbCommand (342ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Color`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IsActive`, `p`.`Length`, `p`.`ModifiedAt`, `p`.`ProductId`, `p`.`Quantity`, `p`.`RowVersion`, `p`.`Size`, `p`.`Waist`
FROM `ProductVariants` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-09-11 17:29:25.929 +03:00 [INF] Executed DbCommand (277ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32), @p2='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
UPDATE `ProductVariants` SET `Quantity` = @p0
WHERE `Id` = @p1 AND `RowVersion` IS NULL;
SELECT `RowVersion`
FROM `ProductVariants`
WHERE ROW_COUNT() = 1 AND `Id` = @p1;
2025-09-11 17:29:27.969 +03:00 [INF] Removing cache by tags: [subcategory, subcategorywithdata]
2025-09-11 17:29:28.226 +03:00 [INF] Quantity for variant 6 restored to 5
2025-09-11 17:29:28.397 +03:00 [WRN] No cache entries found for tags: [subcategory, subcategorywithdata]
2025-09-11 17:29:28.533 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p2='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
UPDATE `Orders` SET `RestockedAt` = @p0
WHERE `Id` = @p1 AND `RowVersion` IS NULL;
SELECT `RowVersion`
FROM `Orders`
WHERE ROW_COUNT() = 1 AND `Id` = @p1;
2025-09-11 17:29:29.940 +03:00 [INF] Executed DbCommand (86ms) [Parameters=[@__productid_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`Description`, `t`.`DiscountId`, `t`.`Gender`, `t`.`IsActive`, `t`.`ModifiedAt`, `t`.`Name`, `t`.`Price`, `t`.`Quantity`, `t`.`SubCategoryId`, `t`.`fitType`, `p0`.`Id`, `p0`.`Color`, `p0`.`CreatedAt`, `p0`.`DeletedAt`, `p0`.`IsActive`, `p0`.`Length`, `p0`.`ModifiedAt`, `p0`.`ProductId`, `p0`.`Quantity`, `p0`.`RowVersion`, `p0`.`Size`, `p0`.`Waist`
FROM (
    SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
    FROM `Products` AS `p`
    WHERE (`p`.`Id` = @__productid_0) AND `p`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN `ProductVariants` AS `p0` ON `t`.`Id` = `p0`.`ProductId`
ORDER BY `t`.`Id`
2025-09-11 17:29:30.239 +03:00 [INF] Executed DbCommand (86ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
UPDATE `Products` SET `Quantity` = @p0
WHERE `Id` = @p1;
SELECT ROW_COUNT();
2025-09-11 17:29:31.365 +03:00 [INF] Removing cache by tags: [order]
2025-09-11 17:29:31.580 +03:00 [WRN] No cache entries found for tags: [order]
2025-09-11 17:29:32.965 +03:00 [INF] Removing cache by tags: [variantlist, variantdata]
2025-09-11 17:29:32.979 +03:00 [INF] Removing cache by tags: [Product, Productwithdata]
2025-09-11 17:29:32.985 +03:00 [INF] Removing cache by tag: CollectionWithProduct
2025-09-11 17:29:33.199 +03:00 [WRN] No cache entries found for tag: CollectionWithProduct
2025-09-11 17:29:33.366 +03:00 [INF] Restocked inventory for order 123
2025-09-11 17:29:33.391 +03:00 [WRN] No cache entries found for tags: [variantlist, variantdata]
2025-09-11 17:29:33.406 +03:00 [WRN] No cache entries found for tags: [Product, Productwithdata]
2025-09-11 17:29:34.474 +03:00 [INF] Removing cache by tag: subcategorywithdata
2025-09-11 17:29:34.689 +03:00 [WRN] No cache entries found for tag: subcategorywithdata
2025-09-11 17:29:36.070 +03:00 [INF] Removing cache by tags: [Product, Productwithdata]
2025-09-11 17:29:36.091 +03:00 [INF] Removing cache by tags: [collection, CollectionWithProduct]
2025-09-11 17:29:36.213 +03:00 [INF] Removing cache by tags: [subcategory, subcategorywithdata]
2025-09-11 17:29:36.498 +03:00 [WRN] No cache entries found for tags: [Product, Productwithdata]
2025-09-11 17:29:36.523 +03:00 [WRN] No cache entries found for tags: [collection, CollectionWithProduct]
2025-09-11 17:29:36.645 +03:00 [WRN] No cache entries found for tags: [subcategory, subcategorywithdata]
2025-09-11 17:33:25.179 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Account/login - application/json 70
2025-09-11 17:33:25.193 +03:00 [WRN] Failed to determine the https port for redirect.
2025-09-11 17:33:25.295 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 17:33:25.308 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.AccountController.LoginAsync (E-Commerce)'
2025-09-11 17:33:25.337 +03:00 [INF] Route matched with {action = "LoginAsync", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.TokenDtos.TokensDto]]] LoginAsync(E_Commerce.DtoModels.AccountDtos.LoginDTo) on controller E_Commerce.Controllers.AccountController (E-Commerce).
2025-09-11 17:33:25.384 +03:00 [INF] In LoginAsync Method 
2025-09-11 17:33:25.549 +03:00 [INF] Executed DbCommand (83ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-09-11 17:33:25.665 +03:00 [INF] 🔐 Generating Access Token for User ID: ac03a6c3-9450-420a-9e6e-ea8902c018c5
2025-09-11 17:33:25.672 +03:00 [INF] 🔐 Generating Access Token for User ID: ac03a6c3-9450-420a-9e6e-ea8902c018c5
2025-09-11 17:33:25.850 +03:00 [INF] Executed DbCommand (84ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedUserName` = @__normalizedUserName_0)
LIMIT 1
2025-09-11 17:33:26.015 +03:00 [INF] Executed DbCommand (81ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-09-11 17:33:26.266 +03:00 [INF] Executed DbCommand (85ms) [Parameters=[@p22='?' (Size = 255), @p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p23='?' (Size = 4000), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (Size = 256), @p6='?' (DbType = Boolean), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (DbType = DateTime), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 256), @p15='?' (Size = 256), @p16='?' (Size = 4000), @p17='?' (Size = 4000), @p18='?' (DbType = Boolean), @p19='?' (Size = 4000), @p20='?' (DbType = Boolean), @p21='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
UPDATE `AspNetUsers` SET `AccessFailedCount` = @p0, `Age` = @p1, `ConcurrencyStamp` = @p2, `CreateAt` = @p3, `DeletedAt` = @p4, `Email` = @p5, `EmailConfirmed` = @p6, `Gender` = @p7, `ImageId` = @p8, `ImageId1` = @p9, `LastVisit` = @p10, `LockoutEnabled` = @p11, `LockoutEnd` = @p12, `Name` = @p13, `NormalizedEmail` = @p14, `NormalizedUserName` = @p15, `PasswordHash` = @p16, `PhoneNumber` = @p17, `PhoneNumberConfirmed` = @p18, `SecurityStamp` = @p19, `TwoFactorEnabled` = @p20, `UserName` = @p21
WHERE `Id` = @p22 AND `ConcurrencyStamp` = @p23;
SELECT ROW_COUNT();
2025-09-11 17:33:26.462 +03:00 [INF] Executed DbCommand (80ms) [Parameters=[@__userId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a0`.`Name`
FROM `AspNetUserRoles` AS `a`
INNER JOIN `AspNetRoles` AS `a0` ON `a`.`RoleId` = `a0`.`Id`
WHERE `a`.`UserId` = @__userId_0
2025-09-11 17:33:26.579 +03:00 [INF] ✅ Access Token generated successfully for User ID: ac03a6c3-9450-420a-9e6e-ea8902c018c5
2025-09-11 17:33:26.585 +03:00 [INF] 🔑 Generating Refresh Token for User ID: ac03a6c3-9450-420a-9e6e-ea8902c018c5
2025-09-11 17:33:26.805 +03:00 [INF] ✅ RefreshToken generated and stored for User ID: ac03a6c3-9450-420a-9e6e-ea8902c018c5
2025-09-11 17:33:26.856 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.TokenDtos.TokensDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 17:33:26.884 +03:00 [INF] Executed action E_Commerce.Controllers.AccountController.LoginAsync (E-Commerce) in 1534.853ms
2025-09-11 17:33:26.890 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.AccountController.LoginAsync (E-Commerce)'
2025-09-11 17:33:26.900 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Account/login - 200 1251 application/json; charset=utf-8 1721.6953ms
2025-09-11 17:33:52.778 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products?page=1&pageSize=10 - null null
2025-09-11 17:33:52.827 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 17:33:53.012 +03:00 [INF] Executed DbCommand (78ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 17:33:53.024 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetProducts (E-Commerce)'
2025-09-11 17:33:53.044 +03:00 [INF] Route matched with {action = "GetProducts", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.ProductDto]]]] GetProducts(System.String, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean], Int32, Int32) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-09-11 17:33:53.080 +03:00 [INF] Getting cache for key: advsearch__________False_1_10__
2025-09-11 17:33:53.299 +03:00 [WRN] Cache miss for key: advsearch__________False_1_10__
2025-09-11 17:33:53.304 +03:00 [INF] Execute GetAll for entity Product
2025-09-11 17:33:53.664 +03:00 [INF] Executed DbCommand (213ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`Name`, `t`.`Description`, `t`.`Quantity`, `t`.`Gender`, `t`.`SubCategoryId`, `t`.`Price`, `t`.`CreatedAt`, `t`.`ModifiedAt`, `t`.`DeletedAt`, `t`.`fitType`, `t`.`IsActive`, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `t`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `t`.`Price`)
    ELSE `t`.`Price`
END, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`EndDate`
    ELSE NULL
END, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
    ELSE NULL
END, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
    ELSE 0.0
END, `d`.`Id`, `i`.`Id`, `i`.`Url`
FROM (
    SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
    FROM `Products` AS `p`
    ORDER BY `p`.`Name`
    LIMIT @__p_1 OFFSET @__p_0
) AS `t`
LEFT JOIN `Discount` AS `d` ON `t`.`DiscountId` = `d`.`Id`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`ProductId`
ORDER BY `t`.`Name`, `t`.`Id`, `d`.`Id`
2025-09-11 17:33:54.782 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.ProductDtos.ProductDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-11 17:33:54.792 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetProducts (E-Commerce) in 1740.1918ms
2025-09-11 17:33:54.796 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetProducts (E-Commerce)'
2025-09-11 17:33:54.799 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products?page=1&pageSize=10 - 200 9125 application/json; charset=utf-8 2020.2657ms
2025-09-11 17:33:57.221 +03:00 [INF] Setting cache for key: advsearch__________False_1_10__
2025-09-11 17:33:57.523 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_10__ with tags: [product_search]
2025-09-11 18:24:25.967 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 18:24:26.580 +03:00 [INF] Setting cache for key: paymentproviders__page1_size10
2025-09-11 18:24:26.674 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 18:24:27.758 +03:00 [INF] Cache set successfully for key: paymentproviders__page1_size10 with tags: [PaymentProviderCache]
2025-09-11 18:24:31.674 +03:00 [INF] Setting cache for key: product:14:variants:search:color::length::waist::size::active::deleted:
2025-09-11 18:24:31.938 +03:00 [INF] Cache set successfully for key: product:14:variants:search:color::length::waist::size::active::deleted: with tags: [product:14, variantdata]
2025-09-11 18:24:39.966 +03:00 [INF] Executing GetByIdAsync for entity Cart with ID: 1
2025-09-11 18:24:40.203 +03:00 [INF] Executed DbCommand (113ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
FROM `Cart` AS `c`
WHERE `c`.`Id` = @__id_0
LIMIT 1
2025-09-11 18:24:42.950 +03:00 [INF] Removing cache by tag: cart
2025-09-11 18:24:43.166 +03:00 [WRN] No cache entries found for tag: cart
2025-09-11 18:25:26.966 +03:00 [INF] Setting cache for key: variant:9
2025-09-11 18:25:27.191 +03:00 [INF] Cache set successfully for key: variant:9 with tags: [product:14, variantdata]
2025-09-11 18:25:30.240 +03:00 [INF] Setting cache for key: variant:9
2025-09-11 18:25:30.458 +03:00 [INF] Cache set successfully for key: variant:9 with tags: [product:14, variantdata]
2025-09-11 18:25:35.786 +03:00 [INF] Executing GetByIdAsync for entity Cart with ID: 1
2025-09-11 18:25:35.952 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
FROM `Cart` AS `c`
WHERE `c`.`Id` = @__id_0
LIMIT 1
2025-09-11 18:25:36.121 +03:00 [INF] Executed DbCommand (72ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
UPDATE `Cart` SET `CheckoutDate` = @p0
WHERE `Id` = @p1;
SELECT ROW_COUNT();
2025-09-11 18:25:38.331 +03:00 [INF] Removing cache by tag: cart
2025-09-11 18:25:38.547 +03:00 [WRN] No cache entries found for tag: cart
2025-09-11 18:28:33.000 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 18:28:33.292 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 18:35:20.767 +03:00 [INF] Setting cache for key: paymentproviders__page1_size10
2025-09-11 18:35:21.066 +03:00 [INF] Cache set successfully for key: paymentproviders__page1_size10 with tags: [PaymentProviderCache]
2025-09-11 18:35:21.618 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 18:35:21.911 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 18:35:33.549 +03:00 [INF] Executing GetByIdAsync for entity Cart with ID: 1
2025-09-11 18:35:33.748 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
FROM `Cart` AS `c`
WHERE `c`.`Id` = @__id_0
LIMIT 1
2025-09-11 18:36:03.881 +03:00 [INF] Executing GetByIdAsync for entity Cart with ID: 1
2025-09-11 18:36:04.067 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
FROM `Cart` AS `c`
WHERE `c`.`Id` = @__id_0
LIMIT 1
2025-09-11 18:36:04.267 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
UPDATE `Cart` SET `CheckoutDate` = @p0
WHERE `Id` = @p1;
SELECT ROW_COUNT();
2025-09-11 18:36:07.838 +03:00 [INF] Removing cache by tag: cart
2025-09-11 18:36:08.536 +03:00 [INF] Removed 1 cache entries for tag: cart
2025-09-11 18:36:14.121 +03:00 [INF] Executing GetByIdAsync for entity Cart with ID: 1
2025-09-11 18:36:14.320 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
FROM `Cart` AS `c`
WHERE `c`.`Id` = @__id_0
LIMIT 1
2025-09-11 18:36:14.487 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
UPDATE `Cart` SET `CheckoutDate` = @p0
WHERE `Id` = @p1;
SELECT ROW_COUNT();
2025-09-11 18:36:22.776 +03:00 [INF] Executing GetByIdAsync for entity Cart with ID: 1
2025-09-11 18:36:22.971 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
FROM `Cart` AS `c`
WHERE `c`.`Id` = @__id_0
LIMIT 1
2025-09-11 18:36:23.130 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
UPDATE `Cart` SET `CheckoutDate` = @p0
WHERE `Id` = @p1;
SELECT ROW_COUNT();
2025-09-11 18:36:25.458 +03:00 [INF] Removing cache by tag: cart
2025-09-11 18:36:25.681 +03:00 [WRN] No cache entries found for tag: cart
2025-09-11 18:36:33.609 +03:00 [INF] Executing GetByIdAsync for entity Cart with ID: 1
2025-09-11 18:36:33.771 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
FROM `Cart` AS `c`
WHERE `c`.`Id` = @__id_0
LIMIT 1
2025-09-11 18:36:33.949 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
UPDATE `Cart` SET `CheckoutDate` = @p0
WHERE `Id` = @p1;
SELECT ROW_COUNT();
2025-09-11 18:36:36.355 +03:00 [INF] Removing cache by tag: cart
2025-09-11 18:36:36.571 +03:00 [WRN] No cache entries found for tag: cart
2025-09-11 18:37:50.168 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 18:37:50.436 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 18:38:00.675 +03:00 [INF] Executing GetByIdAsync for entity Cart with ID: 1
2025-09-11 18:38:00.853 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
FROM `Cart` AS `c`
WHERE `c`.`Id` = @__id_0
LIMIT 1
2025-09-11 18:38:01.016 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
UPDATE `Cart` SET `CheckoutDate` = @p0
WHERE `Id` = @p1;
SELECT ROW_COUNT();
2025-09-11 18:38:03.268 +03:00 [INF] Removing cache by tag: cart
2025-09-11 18:38:03.500 +03:00 [WRN] No cache entries found for tag: cart
2025-09-11 18:38:25.585 +03:00 [INF] Executing GetByIdAsync for entity Cart with ID: 1
2025-09-11 18:38:25.849 +03:00 [INF] Executed DbCommand (78ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
FROM `Cart` AS `c`
WHERE `c`.`Id` = @__id_0
LIMIT 1
2025-09-11 18:38:26.048 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
UPDATE `Cart` SET `CheckoutDate` = @p0
WHERE `Id` = @p1;
SELECT ROW_COUNT();
2025-09-11 18:40:13.050 +03:00 [INF] Setting cache for key: advsearch__________False_1_100_True_False
2025-09-11 18:40:13.726 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100_True_False with tags: [product_search]
2025-09-11 18:41:10.774 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 18:41:11.027 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 18:41:12.562 +03:00 [INF] Setting cache for key: paymentproviders__page1_size10
2025-09-11 18:41:12.786 +03:00 [INF] Cache set successfully for key: paymentproviders__page1_size10 with tags: [PaymentProviderCache]
2025-09-11 18:41:43.451 +03:00 [INF] Setting cache for key: advsearch__________False_1_50_True_False
2025-09-11 18:41:43.694 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_50_True_False with tags: [product_search]
2025-09-11 18:41:54.259 +03:00 [INF] Setting cache for key: product:14:variants:search:color::length::waist::size::active:True:deleted:False
2025-09-11 18:41:54.491 +03:00 [INF] Cache set successfully for key: product:14:variants:search:color::length::waist::size::active:True:deleted:False with tags: [product:14, variantdata]
2025-09-11 18:44:08.443 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 18:44:08.826 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 18:44:12.754 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 18:44:13.015 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 18:44:45.192 +03:00 [INF] Executing GetByIdAsync for entity Cart with ID: 1
2025-09-11 18:44:45.434 +03:00 [INF] Executed DbCommand (88ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
FROM `Cart` AS `c`
WHERE `c`.`Id` = @__id_0
LIMIT 1
2025-09-11 18:45:37.826 +03:00 [INF] Executing GetByIdAsync for entity Cart with ID: 1
2025-09-11 18:45:37.976 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
FROM `Cart` AS `c`
WHERE `c`.`Id` = @__id_0
LIMIT 1
2025-09-11 18:45:38.137 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
UPDATE `Cart` SET `CheckoutDate` = @p0
WHERE `Id` = @p1;
SELECT ROW_COUNT();
2025-09-11 18:46:05.934 +03:00 [INF] Executing GetByIdAsync for entity Cart with ID: 1
2025-09-11 18:46:06.096 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
FROM `Cart` AS `c`
WHERE `c`.`Id` = @__id_0
LIMIT 1
2025-09-11 18:46:40.953 +03:00 [INF] Executing GetByIdAsync for entity Cart with ID: 1
2025-09-11 18:46:41.112 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
FROM `Cart` AS `c`
WHERE `c`.`Id` = @__id_0
LIMIT 1
2025-09-11 18:46:43.018 +03:00 [INF] Removing cache by tag: cart
2025-09-11 18:46:43.558 +03:00 [INF] Removing cache by tag: cart
2025-09-11 18:46:43.699 +03:00 [INF] Removed 1 cache entries for tag: cart
2025-09-11 18:46:43.779 +03:00 [WRN] No cache entries found for tag: cart
2025-09-11 18:46:58.274 +03:00 [INF] Setting cache for key: paymentproviders__page1_size10
2025-09-11 18:46:58.503 +03:00 [INF] Cache set successfully for key: paymentproviders__page1_size10 with tags: [PaymentProviderCache]
2025-09-11 18:46:58.694 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 18:46:58.958 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 18:47:01.555 +03:00 [INF] Setting cache for key: paymentproviders__page1_size10
2025-09-11 18:47:01.787 +03:00 [INF] Cache set successfully for key: paymentproviders__page1_size10 with tags: [PaymentProviderCache]
2025-09-11 18:51:08.770 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 18:51:09.043 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 18:51:18.044 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 18:51:18.306 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 18:51:24.912 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 18:51:25.173 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 18:51:56.237 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 18:51:56.562 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 18:52:43.364 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 18:52:43.662 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 18:52:46.373 +03:00 [INF] Setting cache for key: paymentproviders__page1_size10
2025-09-11 18:52:46.592 +03:00 [INF] Cache set successfully for key: paymentproviders__page1_size10 with tags: [PaymentProviderCache]
2025-09-11 18:52:46.885 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 18:52:47.160 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 18:52:49.583 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 18:52:49.854 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 18:52:53.324 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 18:52:53.577 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 18:53:07.834 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 18:53:08.100 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 18:53:57.823 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 18:53:58.087 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 18:54:17.969 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 18:54:18.229 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 18:55:07.752 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 18:55:08.014 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 18:55:25.753 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 18:55:26.102 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 18:55:32.589 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 18:55:36.051 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 18:55:36.603 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 18:55:40.748 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 18:56:13.836 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 18:56:14.099 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 18:56:17.152 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 18:56:17.502 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 19:00:59.933 +03:00 [INF] Setting cache for key: paymentproviders__page1_size10
2025-09-11 19:01:00.157 +03:00 [INF] Cache set successfully for key: paymentproviders__page1_size10 with tags: [PaymentProviderCache]
2025-09-11 19:01:01.456 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 19:01:01.744 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 19:01:36.763 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 19:01:37.024 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 19:01:54.098 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 19:01:54.365 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 19:02:01.701 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 19:02:01.964 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 19:02:25.490 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 19:02:25.746 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 19:02:27.963 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 19:02:28.302 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 19:03:28.681 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 19:03:28.980 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 19:03:42.119 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 19:03:42.397 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 19:03:45.379 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 19:03:45.638 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 19:04:23.788 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 19:04:24.098 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 19:04:35.780 +03:00 [INF] Executing GetByIdAsync for entity Cart with ID: 1
2025-09-11 19:04:36.043 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
FROM `Cart` AS `c`
WHERE `c`.`Id` = @__id_0
LIMIT 1
2025-09-11 19:04:39.648 +03:00 [INF] Removing cache by tag: cart
2025-09-11 19:04:39.865 +03:00 [WRN] No cache entries found for tag: cart
2025-09-11 19:04:42.294 +03:00 [INF] Setting cache for key: variant:9
2025-09-11 19:04:42.649 +03:00 [INF] Cache set successfully for key: variant:9 with tags: [product:14, variantdata]
2025-09-11 19:04:47.658 +03:00 [INF] Executing GetByIdAsync for entity Cart with ID: 1
2025-09-11 19:04:47.823 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
FROM `Cart` AS `c`
WHERE `c`.`Id` = @__id_0
LIMIT 1
2025-09-11 19:04:47.991 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
UPDATE `Cart` SET `CheckoutDate` = @p0
WHERE `Id` = @p1;
SELECT ROW_COUNT();
2025-09-11 19:04:50.266 +03:00 [INF] Removing cache by tag: cart
2025-09-11 19:04:52.130 +03:00 [WRN] No cache entries found for tag: cart
2025-09-11 19:05:10.807 +03:00 [INF] Executing GetByIdAsync for entity Cart with ID: 1
2025-09-11 19:05:10.965 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
FROM `Cart` AS `c`
WHERE `c`.`Id` = @__id_0
LIMIT 1
2025-09-11 19:05:11.152 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
UPDATE `Cart` SET `CheckoutDate` = @p0
WHERE `Id` = @p1;
SELECT ROW_COUNT();
2025-09-11 19:05:13.390 +03:00 [INF] Removing cache by tag: cart
2025-09-11 19:05:14.093 +03:00 [INF] Removed 1 cache entries for tag: cart
2025-09-11 19:06:14.007 +03:00 [INF] Setting cache for key: paymentproviders__page1_size10
2025-09-11 19:06:14.286 +03:00 [INF] Cache set successfully for key: paymentproviders__page1_size10 with tags: [PaymentProviderCache]
2025-09-11 19:06:14.901 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 19:06:15.205 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 19:06:33.470 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 19:06:33.934 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 19:06:36.188 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 19:06:36.539 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 19:06:39.588 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 19:06:39.905 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 19:06:46.489 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 19:06:46.972 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 19:08:03.140 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 19:08:05.438 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 19:09:12.338 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 19:09:16.461 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 19:09:22.262 +03:00 [INF] Setting cache for key: advsearch__________False_1_100__
2025-09-11 19:09:28.881 +03:00 [INF] Executing GetByIdAsync for entity Cart with ID: 1
2025-09-11 19:09:42.930 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_100__ with tags: [product_search]
2025-09-11 19:09:48.509 +03:00 [INF] Executed DbCommand (96ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
FROM `Cart` AS `c`
WHERE `c`.`Id` = @__id_0
LIMIT 1
2025-09-11 19:18:42.128 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 19:18:42.930 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 19:19:20.428 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 19:19:22.443 +03:00 [INF] Executed DbCommand (124ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 19:19:23.130 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 19:19:23.311 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-09-11 19:19:23.328 +03:00 [INF] Applying migration '20250911161844_addrowvsersionsec'.
2025-09-11 19:19:24.186 +03:00 [INF] Executed DbCommand (420ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `ProductVariants` MODIFY COLUMN `Color` varchar(255) CHARACTER SET utf8mb4 NOT NULL;
2025-09-11 19:19:24.444 +03:00 [INF] Executed DbCommand (257ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `Products` ADD `RowVersion` binary(8) NULL;
2025-09-11 19:19:24.539 +03:00 [INF] Executed DbCommand (95ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `IX_ProductVariants_ProductId_Color_Size_Waist_Length` ON `ProductVariants` (`ProductId`, `Color`, `Size`, `Waist`, `Length`);
2025-09-11 19:19:24.612 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `__EFMigrationsHistory` (`MigrationId`, `ProductVersion`)
VALUES ('20250911161844_addrowvsersionsec', '8.0.13');
2025-09-11 19:21:39.997 +03:00 [INF] DB tables already exist. Exit install
2025-09-11 19:21:41.425 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 19:21:42.585 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 19:21:43.269 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-11 19:21:43.451 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-09-11 19:21:43.478 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-11 19:21:43.492 +03:00 [INF] Starting data seeding...
2025-09-11 19:21:43.519 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-11 19:21:44.029 +03:00 [INF] Executed DbCommand (111ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-09-11 19:21:44.095 +03:00 [INF] Role 'Admin' already exists.
2025-09-11 19:21:44.248 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-09-11 19:21:44.260 +03:00 [INF] Role 'User' already exists.
2025-09-11 19:21:44.435 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-09-11 19:21:44.562 +03:00 [INF] Admin user already exists. Skipping provider/method creation.
2025-09-11 19:21:44.566 +03:00 [INF] Data seeding completed successfully.
2025-09-11 19:21:46.075 +03:00 [INF] Now listening on: http://localhost:5069
2025-09-11 19:21:46.154 +03:00 [INF] Starting Hangfire Server using job storage: 'Server: mysql-3581f657-omargamal1132004-b0c1.b.aivencloud.com@Fashion_Site'
2025-09-11 19:21:46.158 +03:00 [INF] Using the following options for SQL Server job storage:
2025-09-11 19:21:46.160 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-09-11 19:21:46.163 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-09-11 19:21:46.176 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-11 19:21:46.178 +03:00 [INF] Hosting environment: Development
2025-09-11 19:21:46.181 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-09-11 19:21:46.383 +03:00 [INF] Server mrrobot:17780:bbe95c3e successfully announced in 194.5359 ms
2025-09-11 19:21:46.388 +03:00 [INF] Server mrrobot:17780:bbe95c3e is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-09-11 19:21:46.433 +03:00 [INF] Server mrrobot:17780:bbe95c3e all the dispatchers started
2025-09-11 19:39:14.239 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products?page=1&pageSize=10 - null null
2025-09-11 19:39:14.298 +03:00 [WRN] Failed to determine the https port for redirect.
2025-09-11 19:39:14.575 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:39:14.812 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:39:14.885 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products?page=1&pageSize=10 - 401 null application/json 647.1222ms
2025-09-11 19:39:32.169 +03:00 [INF] Executing GetByIdAsync for entity Cart with ID: 1
2025-09-11 19:39:32.347 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
FROM `Cart` AS `c`
WHERE `c`.`Id` = @__id_0
LIMIT 1
2025-09-11 19:39:36.396 +03:00 [INF] Removing cache by tag: cart
2025-09-11 19:39:36.924 +03:00 [WRN] No cache entries found for tag: cart
2025-09-11 19:40:24.741 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Account/login - application/json 60
2025-09-11 19:40:24.805 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:40:24.960 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:40:24.997 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.AccountController.LoginAsync (E-Commerce)'
2025-09-11 19:40:25.080 +03:00 [INF] Route matched with {action = "LoginAsync", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.TokenDtos.TokensDto]]] LoginAsync(E_Commerce.DtoModels.AccountDtos.LoginDTo) on controller E_Commerce.Controllers.AccountController (E-Commerce).
2025-09-11 19:40:25.502 +03:00 [INF] In LoginAsync Method 
2025-09-11 19:40:25.660 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-09-11 19:40:25.798 +03:00 [INF] 🔐 Generating Access Token for User ID: e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:40:25.804 +03:00 [INF] 🔐 Generating Access Token for User ID: e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:40:25.976 +03:00 [INF] Executed DbCommand (79ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedUserName` = @__normalizedUserName_0)
LIMIT 1
2025-09-11 19:40:26.137 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-09-11 19:40:26.505 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[@p22='?' (Size = 255), @p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p23='?' (Size = 4000), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (Size = 256), @p6='?' (DbType = Boolean), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (DbType = DateTime), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 256), @p15='?' (Size = 256), @p16='?' (Size = 4000), @p17='?' (Size = 4000), @p18='?' (DbType = Boolean), @p19='?' (Size = 4000), @p20='?' (DbType = Boolean), @p21='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
UPDATE `AspNetUsers` SET `AccessFailedCount` = @p0, `Age` = @p1, `ConcurrencyStamp` = @p2, `CreateAt` = @p3, `DeletedAt` = @p4, `Email` = @p5, `EmailConfirmed` = @p6, `Gender` = @p7, `ImageId` = @p8, `ImageId1` = @p9, `LastVisit` = @p10, `LockoutEnabled` = @p11, `LockoutEnd` = @p12, `Name` = @p13, `NormalizedEmail` = @p14, `NormalizedUserName` = @p15, `PasswordHash` = @p16, `PhoneNumber` = @p17, `PhoneNumberConfirmed` = @p18, `SecurityStamp` = @p19, `TwoFactorEnabled` = @p20, `UserName` = @p21
WHERE `Id` = @p22 AND `ConcurrencyStamp` = @p23;
SELECT ROW_COUNT();
2025-09-11 19:40:26.769 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[@__userId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a0`.`Name`
FROM `AspNetUserRoles` AS `a`
INNER JOIN `AspNetRoles` AS `a0` ON `a`.`RoleId` = `a0`.`Id`
WHERE `a`.`UserId` = @__userId_0
2025-09-11 19:40:26.805 +03:00 [INF] ✅ Access Token generated successfully for User ID: e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:40:26.810 +03:00 [INF] 🔑 Generating Refresh Token for User ID: e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:40:27.035 +03:00 [INF] ✅ RefreshToken generated and stored for User ID: e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:40:27.095 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.TokenDtos.TokensDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:40:27.130 +03:00 [INF] Executed action E_Commerce.Controllers.AccountController.LoginAsync (E-Commerce) in 2041.7586ms
2025-09-11 19:40:27.146 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.AccountController.LoginAsync (E-Commerce)'
2025-09-11 19:40:27.156 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Account/login - 200 1249 application/json; charset=utf-8 2415.6783ms
2025-09-11 19:41:02.137 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Order?userId=string&deleted=true&page=1&pageSize=10&status=7 - null null
2025-09-11 19:41:02.149 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:41:02.304 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:41:02.320 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.OrderController.GetOrders (E-Commerce)'
2025-09-11 19:41:02.331 +03:00 [INF] Route matched with {action = "GetOrders", controller = "Order"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.OrderDtos.OrderListDto]]]] GetOrders(System.String, System.Nullable`1[System.Boolean], Int32, Int32, System.Nullable`1[E_Commerce.Enums.OrderStatus]) on controller E_Commerce.Controllers.OrderController (E-Commerce).
2025-09-11 19:41:02.361 +03:00 [INF] Executing GetOrders: role: User, userId: e682f183-1c61-400b-aa5a-171750f446b5, deleted: True, page: 1, size: 10, status: Returned
2025-09-11 19:41:02.372 +03:00 [INF] Filtering orders - UserId: e682f183-1c61-400b-aa5a-171750f446b5, Deleted: true, Page: 1, PageSize: 10, Status: "Returned"
2025-09-11 19:41:02.383 +03:00 [INF] Getting cache for key: order:filter:user:e682f183-1c61-400b-aa5a-171750f446b5_deleted:True_page:1_size:10_status:Returned
2025-09-11 19:41:02.604 +03:00 [WRN] Cache miss for key: order:filter:user:e682f183-1c61-400b-aa5a-171750f446b5_deleted:True_page:1_size:10_status:Returned
2025-09-11 19:41:02.611 +03:00 [INF] Execute GetAll for entity Order
2025-09-11 19:41:02.846 +03:00 [INF] Executed DbCommand (87ms) [Parameters=[@__8__locals1_userId_0='?' (Size = 255), @__8__locals1_status_Value_1='?' (DbType = Int32), @__p_3='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`OrderNumber`, `t0`.`Name`, `t`.`Status`, `t`.`Total`, `t`.`CreatedAt`
FROM (
    SELECT `o`.`Id`, `o`.`CreatedAt`, `o`.`CustomerId`, `o`.`OrderNumber`, `o`.`Status`, `o`.`Total`
    FROM `Orders` AS `o`
    WHERE ((`o`.`CustomerId` = @__8__locals1_userId_0) AND `o`.`DeletedAt` IS NOT NULL) AND (`o`.`Status` = @__8__locals1_status_Value_1)
    ORDER BY `o`.`CreatedAt` DESC
    LIMIT @__p_3 OFFSET @__p_2
) AS `t`
INNER JOIN (
    SELECT `a`.`Id`, `a`.`Name`
    FROM `AspNetUsers` AS `a`
    WHERE `a`.`Discriminator` = 'Customer'
) AS `t0` ON `t`.`CustomerId` = `t0`.`Id`
ORDER BY `t`.`CreatedAt` DESC
2025-09-11 19:41:02.899 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.OrderDtos.OrderListDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-11 19:41:02.927 +03:00 [INF] Executed action E_Commerce.Controllers.OrderController.GetOrders (E-Commerce) in 588.252ms
2025-09-11 19:41:02.949 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.OrderController.GetOrders (E-Commerce)'
2025-09-11 19:41:02.965 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Order?userId=string&deleted=true&page=1&pageSize=10&status=7 - 200 138 application/json; charset=utf-8 829.0345ms
2025-09-11 19:41:12.710 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Order?userId=string&page=1&pageSize=10&status=7 - null null
2025-09-11 19:41:12.718 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:41:12.885 +03:00 [INF] Executed DbCommand (88ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:41:12.893 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.OrderController.GetOrders (E-Commerce)'
2025-09-11 19:41:12.895 +03:00 [INF] Route matched with {action = "GetOrders", controller = "Order"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.OrderDtos.OrderListDto]]]] GetOrders(System.String, System.Nullable`1[System.Boolean], Int32, Int32, System.Nullable`1[E_Commerce.Enums.OrderStatus]) on controller E_Commerce.Controllers.OrderController (E-Commerce).
2025-09-11 19:41:12.909 +03:00 [INF] Executing GetOrders: role: User, userId: e682f183-1c61-400b-aa5a-171750f446b5, deleted: , page: 1, size: 10, status: Returned
2025-09-11 19:41:12.911 +03:00 [INF] Filtering orders - UserId: e682f183-1c61-400b-aa5a-171750f446b5, Deleted: null, Page: 1, PageSize: 10, Status: "Returned"
2025-09-11 19:41:12.916 +03:00 [INF] Getting cache for key: order:filter:user:e682f183-1c61-400b-aa5a-171750f446b5_deleted:all_page:1_size:10_status:Returned
2025-09-11 19:41:13.139 +03:00 [WRN] Cache miss for key: order:filter:user:e682f183-1c61-400b-aa5a-171750f446b5_deleted:all_page:1_size:10_status:Returned
2025-09-11 19:41:13.166 +03:00 [INF] Execute GetAll for entity Order
2025-09-11 19:41:13.332 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__8__locals1_userId_0='?' (Size = 255), @__8__locals1_status_Value_1='?' (DbType = Int32), @__p_3='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`OrderNumber`, `t0`.`Name`, `t`.`Status`, `t`.`Total`, `t`.`CreatedAt`
FROM (
    SELECT `o`.`Id`, `o`.`CreatedAt`, `o`.`CustomerId`, `o`.`OrderNumber`, `o`.`Status`, `o`.`Total`
    FROM `Orders` AS `o`
    WHERE (`o`.`CustomerId` = @__8__locals1_userId_0) AND (`o`.`Status` = @__8__locals1_status_Value_1)
    ORDER BY `o`.`CreatedAt` DESC
    LIMIT @__p_3 OFFSET @__p_2
) AS `t`
INNER JOIN (
    SELECT `a`.`Id`, `a`.`Name`
    FROM `AspNetUsers` AS `a`
    WHERE `a`.`Discriminator` = 'Customer'
) AS `t0` ON `t`.`CustomerId` = `t0`.`Id`
ORDER BY `t`.`CreatedAt` DESC
2025-09-11 19:41:13.345 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.OrderDtos.OrderListDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-11 19:41:13.349 +03:00 [INF] Executed action E_Commerce.Controllers.OrderController.GetOrders (E-Commerce) in 448.889ms
2025-09-11 19:41:13.357 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.OrderController.GetOrders (E-Commerce)'
2025-09-11 19:41:13.360 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Order?userId=string&page=1&pageSize=10&status=7 - 200 138 application/json; charset=utf-8 649.8364ms
2025-09-11 19:41:20.727 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Order?page=1&pageSize=10&status=7 - null null
2025-09-11 19:41:20.746 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:41:20.899 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:41:20.915 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.OrderController.GetOrders (E-Commerce)'
2025-09-11 19:41:20.918 +03:00 [INF] Route matched with {action = "GetOrders", controller = "Order"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.OrderDtos.OrderListDto]]]] GetOrders(System.String, System.Nullable`1[System.Boolean], Int32, Int32, System.Nullable`1[E_Commerce.Enums.OrderStatus]) on controller E_Commerce.Controllers.OrderController (E-Commerce).
2025-09-11 19:41:20.970 +03:00 [INF] Executing GetOrders: role: User, userId: e682f183-1c61-400b-aa5a-171750f446b5, deleted: , page: 1, size: 10, status: Returned
2025-09-11 19:41:20.971 +03:00 [INF] Filtering orders - UserId: e682f183-1c61-400b-aa5a-171750f446b5, Deleted: null, Page: 1, PageSize: 10, Status: "Returned"
2025-09-11 19:41:20.978 +03:00 [INF] Getting cache for key: order:filter:user:e682f183-1c61-400b-aa5a-171750f446b5_deleted:all_page:1_size:10_status:Returned
2025-09-11 19:41:21.190 +03:00 [WRN] Cache miss for key: order:filter:user:e682f183-1c61-400b-aa5a-171750f446b5_deleted:all_page:1_size:10_status:Returned
2025-09-11 19:41:21.193 +03:00 [INF] Execute GetAll for entity Order
2025-09-11 19:41:21.378 +03:00 [INF] Executed DbCommand (107ms) [Parameters=[@__8__locals1_userId_0='?' (Size = 255), @__8__locals1_status_Value_1='?' (DbType = Int32), @__p_3='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`OrderNumber`, `t0`.`Name`, `t`.`Status`, `t`.`Total`, `t`.`CreatedAt`
FROM (
    SELECT `o`.`Id`, `o`.`CreatedAt`, `o`.`CustomerId`, `o`.`OrderNumber`, `o`.`Status`, `o`.`Total`
    FROM `Orders` AS `o`
    WHERE (`o`.`CustomerId` = @__8__locals1_userId_0) AND (`o`.`Status` = @__8__locals1_status_Value_1)
    ORDER BY `o`.`CreatedAt` DESC
    LIMIT @__p_3 OFFSET @__p_2
) AS `t`
INNER JOIN (
    SELECT `a`.`Id`, `a`.`Name`
    FROM `AspNetUsers` AS `a`
    WHERE `a`.`Discriminator` = 'Customer'
) AS `t0` ON `t`.`CustomerId` = `t0`.`Id`
ORDER BY `t`.`CreatedAt` DESC
2025-09-11 19:41:21.389 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.OrderDtos.OrderListDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-11 19:41:21.392 +03:00 [INF] Executed action E_Commerce.Controllers.OrderController.GetOrders (E-Commerce) in 469.9542ms
2025-09-11 19:41:21.410 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.OrderController.GetOrders (E-Commerce)'
2025-09-11 19:41:21.412 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Order?page=1&pageSize=10&status=7 - 200 138 application/json; charset=utf-8 685.4105ms
2025-09-11 19:41:29.048 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Order?userId=string&page=1&pageSize=10 - null null
2025-09-11 19:41:29.070 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:41:29.245 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:41:29.257 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.OrderController.GetOrders (E-Commerce)'
2025-09-11 19:41:29.264 +03:00 [INF] Route matched with {action = "GetOrders", controller = "Order"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.OrderDtos.OrderListDto]]]] GetOrders(System.String, System.Nullable`1[System.Boolean], Int32, Int32, System.Nullable`1[E_Commerce.Enums.OrderStatus]) on controller E_Commerce.Controllers.OrderController (E-Commerce).
2025-09-11 19:41:29.278 +03:00 [INF] Executing GetOrders: role: User, userId: e682f183-1c61-400b-aa5a-171750f446b5, deleted: , page: 1, size: 10, status: 
2025-09-11 19:41:29.279 +03:00 [INF] Filtering orders - UserId: e682f183-1c61-400b-aa5a-171750f446b5, Deleted: null, Page: 1, PageSize: 10, Status: null
2025-09-11 19:41:29.292 +03:00 [INF] Getting cache for key: order:filter:user:e682f183-1c61-400b-aa5a-171750f446b5_deleted:all_page:1_size:10_status:all
2025-09-11 19:41:29.510 +03:00 [WRN] Cache miss for key: order:filter:user:e682f183-1c61-400b-aa5a-171750f446b5_deleted:all_page:1_size:10_status:all
2025-09-11 19:41:29.514 +03:00 [INF] Execute GetAll for entity Order
2025-09-11 19:41:29.700 +03:00 [INF] Executed DbCommand (91ms) [Parameters=[@__8__locals1_userId_0='?' (Size = 255), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`OrderNumber`, `t0`.`Name`, `t`.`Status`, `t`.`Total`, `t`.`CreatedAt`
FROM (
    SELECT `o`.`Id`, `o`.`CreatedAt`, `o`.`CustomerId`, `o`.`OrderNumber`, `o`.`Status`, `o`.`Total`
    FROM `Orders` AS `o`
    WHERE `o`.`CustomerId` = @__8__locals1_userId_0
    ORDER BY `o`.`CreatedAt` DESC
    LIMIT @__p_2 OFFSET @__p_1
) AS `t`
INNER JOIN (
    SELECT `a`.`Id`, `a`.`Name`
    FROM `AspNetUsers` AS `a`
    WHERE `a`.`Discriminator` = 'Customer'
) AS `t0` ON `t`.`CustomerId` = `t0`.`Id`
ORDER BY `t`.`CreatedAt` DESC
2025-09-11 19:41:30.697 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.OrderDtos.OrderListDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-11 19:41:30.706 +03:00 [INF] Executed action E_Commerce.Controllers.OrderController.GetOrders (E-Commerce) in 1429.6966ms
2025-09-11 19:41:30.709 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.OrderController.GetOrders (E-Commerce)'
2025-09-11 19:41:30.711 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Order?userId=string&page=1&pageSize=10 - 200 774 application/json; charset=utf-8 1663.716ms
2025-09-11 19:41:33.895 +03:00 [INF] Setting cache for key: order:filter:user:e682f183-1c61-400b-aa5a-171750f446b5_deleted:all_page:1_size:10_status:all
2025-09-11 19:41:34.171 +03:00 [INF] Cache set successfully for key: order:filter:user:e682f183-1c61-400b-aa5a-171750f446b5_deleted:all_page:1_size:10_status:all with tags: [order]
2025-09-11 19:41:45.540 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Cart - null null
2025-09-11 19:41:45.567 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:41:45.721 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:41:45.817 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-09-11 19:41:45.909 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-09-11 19:41:45.919 +03:00 [INF] Executing GetCart
2025-09-11 19:41:45.930 +03:00 [INF] Getting cart for user: e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:41:45.944 +03:00 [INF] Getting cache for key: cart:user:e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:41:46.167 +03:00 [WRN] Cache miss for key: cart:user:e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:41:46.324 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-09-11 19:41:46.339 +03:00 [INF] Execute GetAll for entity Cart
2025-09-11 19:41:46.655 +03:00 [INF] Executed DbCommand (92ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t`.`CheckoutDate`, `t`.`CreatedAt`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`FinalPrice`, `t0`.`DiscountName`, `t0`.`DiscountPrecentage`, `t0`.`MainImageUrl`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`Id1`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`UnitPrice`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`, `c`.`CheckoutDate`, `c`.`CreatedAt`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`)
        ELSE `p`.`Price`
    END AS `FinalPrice`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `DiscountName`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `DiscountPrecentage`, COALESCE((
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1), (
        SELECT `i0`.`Url`
        FROM `Images` AS `i0`
        WHERE (`p`.`Id` = `i0`.`ProductId`) AND `i0`.`DeletedAt` IS NULL
        LIMIT 1)) AS `MainImageUrl`, `p`.`IsActive`, `p0`.`Color`, `p0`.`Id` AS `Id1`, `p0`.`CreatedAt`, `p0`.`DeletedAt`, `p0`.`ModifiedAt`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `c1`.`UnitPrice`, `d`.`Id` AS `Id2`, `c1`.`CartId`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
    WHERE `p`.`IsActive` AND (`p`.`DeletedAt` IS NULL)
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id2`
2025-09-11 19:41:48.431 +03:00 [INF] Setting cache for key: cart:user:e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:41:48.708 +03:00 [INF] Cache set successfully for key: cart:user:e682f183-1c61-400b-aa5a-171750f446b5 with tags: [cart]
2025-09-11 19:41:48.776 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:41:48.826 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 2911.5833ms
2025-09-11 19:41:48.843 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-09-11 19:41:48.856 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Cart - 200 1013 application/json; charset=utf-8 3315.32ms
2025-09-11 19:41:56.051 +03:00 [INF] Retrieving cart for user: e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:41:56.051 +03:00 [INF] Execute GetAll for entity CartItem
2025-09-11 19:41:56.216 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__cartItemId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AddedAt`, `c`.`CartId`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`ProductId`, `c`.`ProductVariantId`, `c`.`Quantity`, `c`.`RowVersion`, `c`.`UnitPrice`
FROM `CartItems` AS `c`
WHERE (`c`.`Id` = @__cartItemId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:41:56.242 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CheckoutDate`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`RowVersion`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`RowVersion`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-09-11 19:41:56.263 +03:00 [INF] CartItem 48 price updated to 3374.08790000
2025-09-11 19:41:56.629 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@p1='?' (DbType = Int32), @p2='?' (Size = 8) (DbType = Binary), @p0='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
UPDATE `CartItems` SET `UnitPrice` = @p0
WHERE `Id` = @p1 AND `RowVersion` IS NULL;
SELECT `RowVersion`
FROM `CartItems`
WHERE ROW_COUNT() = 1 AND `Id` = @p1;
2025-09-11 19:42:02.609 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Cart/checkout - null 0
2025-09-11 19:42:02.683 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:42:02.871 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:42:02.880 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.CheckOut (E-Commerce)'
2025-09-11 19:42:02.887 +03:00 [INF] Route matched with {action = "CheckOut", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] CheckOut() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-09-11 19:42:02.893 +03:00 [INF] Executing CheckOut
2025-09-11 19:42:02.897 +03:00 [INF] Checkout of cart for user: e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:42:02.900 +03:00 [INF] Retrieving cart for user: e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:42:03.056 +03:00 [INF] Executed DbCommand (79ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CheckoutDate`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`RowVersion`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`RowVersion`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-09-11 19:42:03.216 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
UPDATE `Cart` SET `CheckoutDate` = @p0
WHERE `Id` = @p1;
SELECT ROW_COUNT();
2025-09-11 19:42:03.227 +03:00 [INF] Removing cache for key: cart:user:e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:42:03.233 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-11 19:42:03.242 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.CheckOut (E-Commerce) in 350.5672ms
2025-09-11 19:42:03.250 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.CheckOut (E-Commerce)'
2025-09-11 19:42:03.258 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Cart/checkout - 200 122 application/json; charset=utf-8 648.4418ms
2025-09-11 19:42:03.667 +03:00 [INF] Cache removed successfully for key: cart:user:e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:42:22.095 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/CustomerAddress - null null
2025-09-11 19:42:22.129 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:42:22.290 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:42:22.299 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CustomerAddressController.GetCustomerAddresses (E-Commerce)'
2025-09-11 19:42:22.306 +03:00 [INF] Route matched with {action = "GetCustomerAddresses", controller = "CustomerAddress"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.CustomerAddressDtos.CustomerAddressDto]]]] GetCustomerAddresses() on controller E_Commerce.Controllers.CustomerAddressController (E-Commerce).
2025-09-11 19:42:22.318 +03:00 [INF] Executing GetCustomerAddresses
2025-09-11 19:42:22.325 +03:00 [INF] Getting addresses for customer: e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:42:22.330 +03:00 [INF] Getting cache for key: customer_addresses_e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:42:22.543 +03:00 [WRN] Cache miss for key: customer_addresses_e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:42:22.548 +03:00 [INF] Getting addresses for customer: e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:42:22.722 +03:00 [INF] Executed DbCommand (81ms) [Parameters=[@__customerId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AdditionalNotes`, `c`.`AddressType`, `c`.`City`, `c`.`Country`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`IsDefault`, `c`.`ModifiedAt`, `c`.`PhoneNumber`, `c`.`PostalCode`, `c`.`State`, `c`.`StreetAddress`, `t`.`Id`, `t`.`AccessFailedCount`, `t`.`ConcurrencyStamp`, `t`.`Discriminator`, `t`.`Email`, `t`.`EmailConfirmed`, `t`.`LockoutEnabled`, `t`.`LockoutEnd`, `t`.`NormalizedEmail`, `t`.`NormalizedUserName`, `t`.`PasswordHash`, `t`.`PhoneNumber`, `t`.`PhoneNumberConfirmed`, `t`.`SecurityStamp`, `t`.`TwoFactorEnabled`, `t`.`UserName`, `t`.`Age`, `t`.`CreateAt`, `t`.`DeletedAt`, `t`.`Gender`, `t`.`ImageId`, `t`.`ImageId1`, `t`.`LastVisit`, `t`.`Name`
FROM `CustomerAddresses` AS `c`
INNER JOIN (
    SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
    FROM `AspNetUsers` AS `a`
    WHERE `a`.`Discriminator` = 'Customer'
) AS `t` ON `c`.`CustomerId` = `t`.`Id`
WHERE (`c`.`CustomerId` = @__customerId_0) AND `c`.`DeletedAt` IS NULL
ORDER BY `c`.`IsDefault` DESC, `c`.`CreatedAt`
2025-09-11 19:42:22.788 +03:00 [INF] Setting cache for key: customer_addresses_e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:42:23.012 +03:00 [INF] Cache set successfully for key: customer_addresses_e682f183-1c61-400b-aa5a-171750f446b5 with tags: [customer_address]
2025-09-11 19:42:23.016 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.CustomerAddressDtos.CustomerAddressDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-11 19:42:23.031 +03:00 [INF] Executed action E_Commerce.Controllers.CustomerAddressController.GetCustomerAddresses (E-Commerce) in 716.9907ms
2025-09-11 19:42:23.077 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CustomerAddressController.GetCustomerAddresses (E-Commerce)'
2025-09-11 19:42:23.079 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/CustomerAddress - 200 970 application/json; charset=utf-8 985.3738ms
2025-09-11 19:43:03.754 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Order - application/json 41
2025-09-11 19:43:03.764 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:43:03.913 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:43:03.919 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Order - 401 null application/json 164.6627ms
2025-09-11 19:43:15.754 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Order - application/json 42
2025-09-11 19:43:15.763 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:43:15.912 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:43:15.918 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.OrderController.CreateOrder (E-Commerce)'
2025-09-11 19:43:15.928 +03:00 [INF] Route matched with {action = "CreateOrder", controller = "Order"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.OrderDtos.OrderWithPaymentDto]]] CreateOrder(E_Commerce.DtoModels.OrderDtos.CreateOrderDto) on controller E_Commerce.Controllers.OrderController (E-Commerce).
2025-09-11 19:43:15.945 +03:00 [INF] Executing CreateOrder
2025-09-11 19:43:15.957 +03:00 [INF] Creating order from cart for user: e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:43:16.289 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-09-11 19:43:16.378 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-09-11 19:43:16.427 +03:00 [INF] Checking if address 31 exists for customer: e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:43:16.509 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__addressId_0='?' (DbType = Int32), @__customerId_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `CustomerAddresses` AS `c`
    WHERE ((`c`.`Id` = @__addressId_0) AND (`c`.`CustomerId` = @__customerId_1)) AND `c`.`DeletedAt` IS NULL)
2025-09-11 19:43:16.525 +03:00 [INF] Getting cart for user: e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:43:16.547 +03:00 [INF] Getting cache for key: cart:user:e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:43:16.761 +03:00 [WRN] Cache miss for key: cart:user:e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:43:16.836 +03:00 [INF] Executed DbCommand (72ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-09-11 19:43:16.841 +03:00 [INF] Execute GetAll for entity Cart
2025-09-11 19:43:16.944 +03:00 [INF] Executed DbCommand (99ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t`.`CheckoutDate`, `t`.`CreatedAt`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`FinalPrice`, `t0`.`DiscountName`, `t0`.`DiscountPrecentage`, `t0`.`MainImageUrl`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`Id1`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`UnitPrice`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`, `c`.`CheckoutDate`, `c`.`CreatedAt`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`)
        ELSE `p`.`Price`
    END AS `FinalPrice`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `DiscountName`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `DiscountPrecentage`, COALESCE((
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1), (
        SELECT `i0`.`Url`
        FROM `Images` AS `i0`
        WHERE (`p`.`Id` = `i0`.`ProductId`) AND `i0`.`DeletedAt` IS NULL
        LIMIT 1)) AS `MainImageUrl`, `p`.`IsActive`, `p0`.`Color`, `p0`.`Id` AS `Id1`, `p0`.`CreatedAt`, `p0`.`DeletedAt`, `p0`.`ModifiedAt`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `c1`.`UnitPrice`, `d`.`Id` AS `Id2`, `c1`.`CartId`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
    WHERE `p`.`IsActive` AND (`p`.`DeletedAt` IS NULL)
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id2`
2025-09-11 19:43:18.758 +03:00 [INF] Setting cache for key: cart:user:e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:43:18.980 +03:00 [INF] Cache set successfully for key: cart:user:e682f183-1c61-400b-aa5a-171750f446b5 with tags: [cart]
2025-09-11 19:43:18.994 +03:00 [INF] Execute GetAll for entity ProductVariant
2025-09-11 19:43:19.095 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Color`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IsActive`, `p`.`Length`, `p`.`ModifiedAt`, `p`.`ProductId`, `p`.`Quantity`, `p`.`RowVersion`, `p`.`Size`, `p`.`Waist`, `p0`.`Id`, `p0`.`CreatedAt`, `p0`.`DeletedAt`, `p0`.`Description`, `p0`.`DiscountId`, `p0`.`Gender`, `p0`.`IsActive`, `p0`.`ModifiedAt`, `p0`.`Name`, `p0`.`Price`, `p0`.`Quantity`, `p0`.`RowVersion`, `p0`.`SubCategoryId`, `p0`.`fitType`
FROM `ProductVariants` AS `p`
INNER JOIN `Products` AS `p0` ON `p`.`ProductId` = `p0`.`Id`
WHERE `p`.`Id` = 4
2025-09-11 19:43:19.187 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__orderNumber_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Orders` AS `o`
    WHERE `o`.`OrderNumber` = @__orderNumber_0)
2025-09-11 19:43:19.189 +03:00 [INF] Execute GetAll for entity CartItem
2025-09-11 19:43:19.199 +03:00 [INF] Executing CreateAsync for entity Order
2025-09-11 19:43:19.306 +03:00 [INF] Order added successfully (pending save)
2025-09-11 19:43:19.347 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__cartItemId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AddedAt`, `c`.`CartId`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`ProductId`, `c`.`ProductVariantId`, `c`.`Quantity`, `c`.`RowVersion`, `c`.`UnitPrice`
FROM `CartItems` AS `c`
WHERE (`c`.`Id` = @__cartItemId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:43:19.352 +03:00 [INF] CartItem 48 price updated to 3374.08790000
2025-09-11 19:43:19.518 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = DateTime), @p2='?' (DbType = Int32), @p3='?' (Size = 255), @p4='?' (DbType = DateTime), @p5='?' (DbType = DateTime), @p6='?' (DbType = Decimal), @p7='?' (DbType = DateTime), @p8='?' (Size = 500), @p9='?' (Size = 50), @p10='?' (DbType = DateTime), @p11='?' (DbType = DateTime), @p12='?' (DbType = Decimal), @p13='?' (DbType = Int32), @p14='?' (DbType = Decimal), @p15='?' (DbType = Decimal), @p16='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `Orders` (`CancelledAt`, `CreatedAt`, `CustomerAddressId`, `CustomerId`, `DeletedAt`, `DeliveredAt`, `DiscountAmount`, `ModifiedAt`, `Notes`, `OrderNumber`, `RestockedAt`, `ShippedAt`, `ShippingCost`, `Status`, `Subtotal`, `TaxAmount`, `Total`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
SELECT `Id`, `RowVersion`
FROM `Orders`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-09-11 19:43:19.645 +03:00 [INF] Executing CreateRangeAsync for entity OrderItem
2025-09-11 19:43:19.676 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@p1='?' (DbType = Int32), @p2='?' (Size = 8) (DbType = Binary), @p0='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
UPDATE `CartItems` SET `UnitPrice` = @p0
WHERE `Id` = @p1 AND `RowVersion` IS NULL;
SELECT `RowVersion`
FROM `CartItems`
WHERE ROW_COUNT() = 1 AND `Id` = @p1;
2025-09-11 19:43:19.677 +03:00 [INF] 1 OrderItem entities added successfully (pending save)
2025-09-11 19:43:19.687 +03:00 [INF] Removing 3 from variant: 4
2025-09-11 19:43:19.771 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
UPDATE ProductVariants SET Quantity = Quantity - @p0 WHERE Id = @p1 AND Quantity >= @p0
2025-09-11 19:43:19.778 +03:00 [INF] Executing GetByIdAsync for entity ProductVariant with ID: 4
2025-09-11 19:43:19.858 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Color`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IsActive`, `p`.`Length`, `p`.`ModifiedAt`, `p`.`ProductId`, `p`.`Quantity`, `p`.`RowVersion`, `p`.`Size`, `p`.`Waist`
FROM `ProductVariants` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-09-11 19:43:20.092 +03:00 [INF] Retrieving cart for user: e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:43:20.247 +03:00 [INF] Executed DbCommand (79ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CheckoutDate`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`RowVersion`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`RowVersion`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-09-11 19:43:20.402 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
UPDATE `Cart` SET `CheckoutDate` = @p0
WHERE `Id` = @p1;
SELECT ROW_COUNT();
2025-09-11 19:43:20.410 +03:00 [INF] Checkout date removed for cart of user: e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:43:20.765 +03:00 [INF] Clearing cart: 3
2025-09-11 19:43:20.848 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__cartId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AddedAt`, `c`.`CartId`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`ProductId`, `c`.`ProductVariantId`, `c`.`Quantity`, `c`.`RowVersion`, `c`.`UnitPrice`
FROM `CartItems` AS `c`
WHERE `c`.`CartId` = @__cartId_0
2025-09-11 19:43:20.927 +03:00 [INF] Cart 3 cleared successfully
2025-09-11 19:43:21.170 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 8) (DbType = Binary), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (DbType = Decimal), @p11='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM `CartItems`
WHERE `Id` = @p0 AND `RowVersion` IS NULL;
SELECT ROW_COUNT();

INSERT INTO `OrderItem` (`CreatedAt`, `DeletedAt`, `ModifiedAt`, `OrderId`, `OrderedAt`, `ProductId`, `ProductVariantId`, `Quantity`, `TotalPrice`, `UnitPrice`)
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
SELECT `Id`
FROM `OrderItem`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-09-11 19:43:21.363 +03:00 [INF] Execute AddUserOpreationAsync
2025-09-11 19:43:21.366 +03:00 [INF] Executing CreateAsync for entity UserOperationsLog
2025-09-11 19:43:21.397 +03:00 [INF] UserOperationsLog added successfully (pending save)
2025-09-11 19:43:21.399 +03:00 [INF] Execute GetAll for entity Order
2025-09-11 19:43:21.611 +03:00 [INF] Executed DbCommand (91ms) [Parameters=[@__createdOrder_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t0`.`Id`, `t0`.`CreatedAt`, `t0`.`ModifiedAt`, `t0`.`OrderNumber`, `t0`.`Status`, `t0`.`Subtotal`, `t0`.`TaxAmount`, `t0`.`ShippingCost`, `t0`.`DiscountAmount`, `t0`.`Total`, `t0`.`Notes`, `t0`.`DeletedAt`, `t0`.`ShippedAt`, `t0`.`DeliveredAt`, `t0`.`CancelledAt`, `t0`.`c`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Email`, `t0`.`PhoneNumber`, `t1`.`Id`, `t1`.`CreatedAt`, `t1`.`ModifiedAt`, `t1`.`Quantity`, `t1`.`UnitPrice`, `t1`.`TotalPrice`, `t1`.`OrderedAt`, `t1`.`Id0`, `t1`.`Name`, `t1`.`Price`, `t1`.`IsActive`, `t1`.`FinalPrice`, `t1`.`DiscountPrecentage`, `t1`.`MainImageUrl`, `t1`.`Id1`, `t1`.`Color`, `t1`.`CreatedAt0`, `t1`.`ModifiedAt0`, `t1`.`Size`, `t1`.`DeletedAt`, `t1`.`Length`, `t1`.`Waist`, `t1`.`Id2`, `t1`.`Id3`
FROM (
    SELECT `o`.`Id`, `o`.`CreatedAt`, `o`.`ModifiedAt`, `o`.`OrderNumber`, `o`.`Status`, `o`.`Subtotal`, `o`.`TaxAmount`, `o`.`ShippingCost`, `o`.`DiscountAmount`, `o`.`Total`, `o`.`Notes`, `o`.`DeletedAt`, `o`.`ShippedAt`, `o`.`DeliveredAt`, `o`.`CancelledAt`, FALSE AS `c`, `t`.`Id` AS `Id0`, `t`.`Name`, `t`.`Email`, `t`.`PhoneNumber`
    FROM `Orders` AS `o`
    INNER JOIN (
        SELECT `a`.`Id`, `a`.`Email`, `a`.`PhoneNumber`, `a`.`Name`
        FROM `AspNetUsers` AS `a`
        WHERE `a`.`Discriminator` = 'Customer'
    ) AS `t` ON `o`.`CustomerId` = `t`.`Id`
    WHERE `o`.`Id` = @__createdOrder_Id_0
    LIMIT 1
) AS `t0`
LEFT JOIN (
    SELECT `o0`.`Id`, `o0`.`CreatedAt`, `o0`.`ModifiedAt`, `o0`.`Quantity`, `o0`.`UnitPrice`, `o0`.`TotalPrice`, `o0`.`OrderedAt`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, `p`.`IsActive`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`))
        ELSE `p`.`Price`
    END AS `FinalPrice`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `DiscountPrecentage`, COALESCE((
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND `i`.`DeletedAt` IS NULL
        LIMIT 1), '') AS `MainImageUrl`, `o0`.`ProductVariantId` AS `Id1`, `p0`.`Color`, COALESCE(`p0`.`CreatedAt`, TIMESTAMP '0001-01-01 00:00:00') AS `CreatedAt0`, COALESCE(`p0`.`ModifiedAt`, TIMESTAMP '0001-01-01 00:00:00') AS `ModifiedAt0`, `p0`.`Size`, `p0`.`DeletedAt`, COALESCE(`p0`.`Length`, 0) AS `Length`, COALESCE(`p0`.`Waist`, 0) AS `Waist`, `d`.`Id` AS `Id2`, `p0`.`Id` AS `Id3`, `o0`.`OrderId`
    FROM `OrderItem` AS `o0`
    INNER JOIN `Products` AS `p` ON `o0`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    INNER JOIN `ProductVariants` AS `p0` ON `o0`.`ProductVariantId` = `p0`.`Id`
) AS `t1` ON `t0`.`Id` = `t1`.`OrderId`
ORDER BY `t0`.`Id`, `t0`.`Id0`, `t1`.`Id`, `t1`.`Id0`, `t1`.`Id2`
2025-09-11 19:43:22.255 +03:00 [INF] Executed DbCommand (78ms) [Parameters=[@__productid_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`Description`, `t`.`DiscountId`, `t`.`Gender`, `t`.`IsActive`, `t`.`ModifiedAt`, `t`.`Name`, `t`.`Price`, `t`.`Quantity`, `t`.`RowVersion`, `t`.`SubCategoryId`, `t`.`fitType`, `p0`.`Id`, `p0`.`Color`, `p0`.`CreatedAt`, `p0`.`DeletedAt`, `p0`.`IsActive`, `p0`.`Length`, `p0`.`ModifiedAt`, `p0`.`ProductId`, `p0`.`Quantity`, `p0`.`RowVersion`, `p0`.`Size`, `p0`.`Waist`
FROM (
    SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`RowVersion`, `p`.`SubCategoryId`, `p`.`fitType`
    FROM `Products` AS `p`
    WHERE (`p`.`Id` = @__productid_0) AND `p`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN `ProductVariants` AS `p0` ON `t`.`Id` = `p0`.`ProductId`
ORDER BY `t`.`Id`
2025-09-11 19:43:22.639 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32), @p2='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
UPDATE `Products` SET `Quantity` = @p0
WHERE `Id` = @p1 AND `RowVersion` IS NULL;
SELECT `RowVersion`
FROM `Products`
WHERE ROW_COUNT() = 1 AND `Id` = @p1;
2025-09-11 19:43:26.909 +03:00 [INF] Executing CreatedAtActionResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.OrderDtos.OrderWithPaymentDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:43:26.945 +03:00 [INF] Executed action E_Commerce.Controllers.OrderController.CreateOrder (E-Commerce) in 11010.517ms
2025-09-11 19:43:26.949 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.OrderController.CreateOrder (E-Commerce)'
2025-09-11 19:43:26.965 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Order - 201 1434 application/json; charset=utf-8 11211.225ms
2025-09-11 19:43:28.253 +03:00 [INF] Removing cache by tags: [order]
2025-09-11 19:43:28.947 +03:00 [INF] Removing cache by tag: CollectionWithProduct
2025-09-11 19:43:28.952 +03:00 [INF] Removing cache by tags: [variantlist, variantdata]
2025-09-11 19:43:28.954 +03:00 [INF] Removing cache by tags: [Product, Productwithdata]
2025-09-11 19:43:28.973 +03:00 [INF] Removing cache by tag: subcategorywithdata
2025-09-11 19:43:29.016 +03:00 [INF] Removing cache by tags: [collection, CollectionWithProduct]
2025-09-11 19:43:29.017 +03:00 [INF] Removing cache by tags: [Product, Productwithdata]
2025-09-11 19:43:29.024 +03:00 [INF] Removing cache by tags: [subcategory, subcategorywithdata]
2025-09-11 19:43:29.166 +03:00 [WRN] No cache entries found for tag: CollectionWithProduct
2025-09-11 19:43:29.184 +03:00 [WRN] No cache entries found for tag: subcategorywithdata
2025-09-11 19:43:29.222 +03:00 [INF] Removed 2 cache entries for tags: [order]
2025-09-11 19:43:29.376 +03:00 [WRN] No cache entries found for tags: [variantlist, variantdata]
2025-09-11 19:43:29.383 +03:00 [WRN] No cache entries found for tags: [Product, Productwithdata]
2025-09-11 19:43:29.436 +03:00 [WRN] No cache entries found for tags: [collection, CollectionWithProduct]
2025-09-11 19:43:29.440 +03:00 [WRN] No cache entries found for tags: [Product, Productwithdata]
2025-09-11 19:43:29.444 +03:00 [WRN] No cache entries found for tags: [subcategory, subcategorywithdata]
2025-09-11 19:44:32.997 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:32.998 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:33.010 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:33.011 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:33.700 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:44:33.745 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:44:33.760 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:44:33.778 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:44:33.782 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:33.787 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:33.796 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:33.807 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:33.814 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:44:33.820 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:44:33.826 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:44:33.831 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:44:33.835 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:33.837 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:33.837 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:33.839 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:33.842 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:44:33.848 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:44:33.855 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:44:33.860 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:44:33.865 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:33.865 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:33.868 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:33.869 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:33.875 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:44:33.881 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:44:33.885 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:44:33.891 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:44:33.894 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:33.895 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:33.901 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:33.901 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:33.905 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:33.911 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:44:33.916 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:44:33.920 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:44:33.926 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:44:33.935 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 30.372ms
2025-09-11 19:44:33.936 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:44:33.940 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:44:33.943 +03:00 [INF] Executed DbCommand (78ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:44:33.947 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:33.951 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:33.954 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:33.960 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:33.963 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:33.968 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 21.3135ms
2025-09-11 19:44:33.973 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 22.4163ms
2025-09-11 19:44:33.981 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:44:33.982 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:44:33.984 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:44:33.988 +03:00 [INF] Executed DbCommand (93ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:44:33.997 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:34.015 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.019 +03:00 [INF] Executing CreatePayment for order: 
2025-09-11 19:44:34.020 +03:00 [INF] Executing CreatePayment for order: 
2025-09-11 19:44:34.020 +03:00 [INF] Executing CreatePayment for order: 
2025-09-11 19:44:34.021 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 24.5673ms
2025-09-11 19:44:34.025 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:44:34.033 +03:00 [INF] Starting CreatePaymentMethod for order  by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.033 +03:00 [INF] Starting CreatePaymentMethod for order  by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.033 +03:00 [INF] Starting CreatePaymentMethod for order  by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.035 +03:00 [INF] Executed DbCommand (100ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:44:34.041 +03:00 [INF] Executing CreatePayment for order: 
2025-09-11 19:44:34.042 +03:00 [WRN] CreatePaymentMethod called with null order number by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.044 +03:00 [WRN] CreatePaymentMethod called with null order number by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.046 +03:00 [WRN] CreatePaymentMethod called with null order number by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.050 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.051 +03:00 [INF] Starting CreatePaymentMethod for order  by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.060 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:44:34.060 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:44:34.062 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:44:34.064 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:44:34.068 +03:00 [WRN] CreatePaymentMethod called with null order number by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.076 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 74.2303ms
2025-09-11 19:44:34.079 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 79.7386ms
2025-09-11 19:44:34.081 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 76.092ms
2025-09-11 19:44:34.085 +03:00 [INF] Executing CreatePayment for order: 
2025-09-11 19:44:34.087 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:44:34.092 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.094 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.097 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.099 +03:00 [INF] Starting CreatePaymentMethod for order  by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.102 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 62.6867ms
2025-09-11 19:44:34.105 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 400 212 application/json; charset=utf-8 1107.0419ms
2025-09-11 19:44:34.107 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 400 212 application/json; charset=utf-8 1110.6102ms
2025-09-11 19:44:34.110 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 400 212 application/json; charset=utf-8 1100.1168ms
2025-09-11 19:44:34.113 +03:00 [WRN] CreatePaymentMethod called with null order number by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.115 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.122 +03:00 [INF] Executed DbCommand (187ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:44:34.130 +03:00 [INF] Executed DbCommand (194ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:44:34.137 +03:00 [INF] Executed DbCommand (201ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:44:34.138 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:44:34.141 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 400 212 application/json; charset=utf-8 1130.8679ms
2025-09-11 19:44:34.146 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.151 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.155 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.159 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 74.927ms
2025-09-11 19:44:34.166 +03:00 [INF] Executed DbCommand (230ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:44:34.167 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:44:34.170 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:44:34.173 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:44:34.176 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.181 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.185 +03:00 [INF] Executing CreatePayment for order: 
2025-09-11 19:44:34.189 +03:00 [INF] Executing CreatePayment for order: 
2025-09-11 19:44:34.194 +03:00 [INF] Executing CreatePayment for order: 
2025-09-11 19:44:34.195 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 400 212 application/json; charset=utf-8 413.0304ms
2025-09-11 19:44:34.198 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:44:34.200 +03:00 [INF] Starting CreatePaymentMethod for order  by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.201 +03:00 [INF] Starting CreatePaymentMethod for order  by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.203 +03:00 [INF] Starting CreatePaymentMethod for order  by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.210 +03:00 [INF] Executed DbCommand (267ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:44:34.214 +03:00 [INF] Executing CreatePayment for order: 
2025-09-11 19:44:34.215 +03:00 [WRN] CreatePaymentMethod called with null order number by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.217 +03:00 [WRN] CreatePaymentMethod called with null order number by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.219 +03:00 [WRN] CreatePaymentMethod called with null order number by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.223 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.225 +03:00 [INF] Starting CreatePaymentMethod for order  by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.228 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:44:34.229 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:44:34.231 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:44:34.233 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:44:34.234 +03:00 [WRN] CreatePaymentMethod called with null order number by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.236 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 52.4837ms
2025-09-11 19:44:34.238 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 50.526ms
2025-09-11 19:44:34.242 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 49.2841ms
2025-09-11 19:44:34.256 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.250 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.253 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.248 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:44:34.270 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 400 212 application/json; charset=utf-8 473.3693ms
2025-09-11 19:44:34.270 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 400 212 application/json; charset=utf-8 435.362ms
2025-09-11 19:44:34.270 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 400 212 application/json; charset=utf-8 474.0384ms
2025-09-11 19:44:34.270 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 57.2114ms
2025-09-11 19:44:34.271 +03:00 [INF] Executing CreatePayment for order: 
2025-09-11 19:44:34.279 +03:00 [INF] Executed DbCommand (334ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:44:34.285 +03:00 [INF] Executed DbCommand (340ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:44:34.295 +03:00 [INF] Executed DbCommand (307ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:44:34.297 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.298 +03:00 [INF] Starting CreatePaymentMethod for order  by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.302 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.310 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.321 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.324 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 400 212 application/json; charset=utf-8 517.1852ms
2025-09-11 19:44:34.326 +03:00 [WRN] CreatePaymentMethod called with null order number by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.329 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:44:34.331 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:44:34.334 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:44:34.342 +03:00 [INF] Executed DbCommand (347ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:44:34.344 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:44:34.349 +03:00 [INF] Executing CreatePayment for order: 
2025-09-11 19:44:34.353 +03:00 [INF] Executing CreatePayment for order: 
2025-09-11 19:44:34.358 +03:00 [INF] Executing CreatePayment for order: 
2025-09-11 19:44:34.362 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.365 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 118.8221ms
2025-09-11 19:44:34.366 +03:00 [INF] Starting CreatePaymentMethod for order  by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.367 +03:00 [INF] Starting CreatePaymentMethod for order  by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.370 +03:00 [INF] Starting CreatePaymentMethod for order  by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.372 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:44:34.376 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.378 +03:00 [WRN] CreatePaymentMethod called with null order number by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.381 +03:00 [WRN] CreatePaymentMethod called with null order number by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.383 +03:00 [WRN] CreatePaymentMethod called with null order number by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.388 +03:00 [INF] Executing CreatePayment for order: 
2025-09-11 19:44:34.390 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 400 212 application/json; charset=utf-8 553.2316ms
2025-09-11 19:44:34.392 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:44:34.394 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:44:34.396 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:44:34.398 +03:00 [INF] Starting CreatePaymentMethod for order  by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.429 +03:00 [INF] Executed DbCommand (433ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:44:34.472 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 124.1385ms
2025-09-11 19:44:34.482 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 130.167ms
2025-09-11 19:44:34.484 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 127.5921ms
2025-09-11 19:44:34.486 +03:00 [WRN] CreatePaymentMethod called with null order number by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.492 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.495 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.498 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.501 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.504 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:44:34.507 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:44:34.509 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 400 212 application/json; charset=utf-8 672.3109ms
2025-09-11 19:44:34.511 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 400 212 application/json; charset=utf-8 672.4578ms
2025-09-11 19:44:34.518 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 400 212 application/json; charset=utf-8 653.7199ms
2025-09-11 19:44:34.522 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 134.259ms
2025-09-11 19:44:34.530 +03:00 [INF] Executing CreatePayment for order: 
2025-09-11 19:44:34.537 +03:00 [INF] Executed DbCommand (541ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:44:34.544 +03:00 [INF] Executed DbCommand (508ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:44:34.550 +03:00 [INF] Executed DbCommand (340ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:44:34.552 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.554 +03:00 [INF] Starting CreatePaymentMethod for order  by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.563 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.567 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.571 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.574 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 400 212 application/json; charset=utf-8 708.7564ms
2025-09-11 19:44:34.579 +03:00 [WRN] CreatePaymentMethod called with null order number by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.581 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:44:34.583 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:44:34.585 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:44:34.597 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:44:34.602 +03:00 [INF] Executing CreatePayment for order: 
2025-09-11 19:44:34.605 +03:00 [INF] Executing CreatePayment for order: 
2025-09-11 19:44:34.611 +03:00 [INF] Executing CreatePayment for order: 
2025-09-11 19:44:34.613 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 83.3496ms
2025-09-11 19:44:34.614 +03:00 [INF] Starting CreatePaymentMethod for order  by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.616 +03:00 [INF] Starting CreatePaymentMethod for order  by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.618 +03:00 [INF] Starting CreatePaymentMethod for order  by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.621 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.625 +03:00 [WRN] CreatePaymentMethod called with null order number by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.628 +03:00 [WRN] CreatePaymentMethod called with null order number by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.631 +03:00 [WRN] CreatePaymentMethod called with null order number by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.633 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 400 212 application/json; charset=utf-8 763.7254ms
2025-09-11 19:44:34.635 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:44:34.637 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:44:34.642 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:44:34.649 +03:00 [INF] Executed DbCommand (439ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:44:34.652 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 50.4387ms
2025-09-11 19:44:34.655 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 49.8227ms
2025-09-11 19:44:34.661 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 51.1699ms
2025-09-11 19:44:34.674 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.668 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.670 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.666 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.677 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 400 212 application/json; charset=utf-8 781.615ms
2025-09-11 19:44:34.679 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 400 212 application/json; charset=utf-8 810.7195ms
2025-09-11 19:44:34.681 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 400 212 application/json; charset=utf-8 786.5837ms
2025-09-11 19:44:34.683 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:44:34.691 +03:00 [INF] Executed DbCommand (412ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:44:34.698 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:34.704 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:34.710 +03:00 [INF] Executing CreatePayment for order: 
2025-09-11 19:44:34.714 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.719 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 21.0527ms
2025-09-11 19:44:34.725 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 20.4967ms
2025-09-11 19:44:34.726 +03:00 [INF] Starting CreatePaymentMethod for order  by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.729 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:44:34.737 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:34.745 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:34.746 +03:00 [WRN] CreatePaymentMethod called with null order number by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.751 +03:00 [INF] Executing CreatePayment for order: 
2025-09-11 19:44:34.757 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 20.5023ms
2025-09-11 19:44:34.763 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 18.1111ms
2025-09-11 19:44:34.765 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:44:34.766 +03:00 [INF] Starting CreatePaymentMethod for order  by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.775 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:34.781 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:34.785 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 75.9018ms
2025-09-11 19:44:34.787 +03:00 [WRN] CreatePaymentMethod called with null order number by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:44:34.793 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 18.9003ms
2025-09-11 19:44:34.800 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 18.2577ms
2025-09-11 19:44:34.802 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.804 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:44:34.815 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:34.824 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:34.825 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 400 212 application/json; charset=utf-8 923.8575ms
2025-09-11 19:44:34.830 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 79.6489ms
2025-09-11 19:44:34.836 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 20.7869ms
2025-09-11 19:44:34.842 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 18.175ms
2025-09-11 19:44:34.852 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:34.854 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:44:34.867 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:34.874 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:34.883 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 31.456ms
2025-09-11 19:44:34.886 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 400 212 application/json; charset=utf-8 985.1382ms
2025-09-11 19:44:34.902 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 35.8033ms
2025-09-11 19:44:34.917 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 42.3976ms
2025-09-11 19:44:34.931 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:34.937 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:34.947 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:34.953 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:34.959 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 28.0575ms
2025-09-11 19:44:35.001 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:34.973 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 25.5923ms
2025-09-11 19:44:34.984 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 30.8481ms
2025-09-11 19:44:35.043 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.060 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 17.0342ms
2025-09-11 19:44:35.027 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:34.964 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 26.5637ms
2025-09-11 19:44:35.015 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 13.1672ms
2025-09-11 19:44:35.084 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.088 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 61.3973ms
2025-09-11 19:44:35.161 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.111 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.148 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 64.6107ms
2025-09-11 19:44:35.097 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.168 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 6.2166ms
2025-09-11 19:44:35.196 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 85.0492ms
2025-09-11 19:44:35.202 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.214 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 117.144ms
2025-09-11 19:44:35.219 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.228 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.232 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 30.0349ms
2025-09-11 19:44:35.246 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.255 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 35.8942ms
2025-09-11 19:44:35.262 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 34.1925ms
2025-09-11 19:44:35.269 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.277 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 31.1405ms
2025-09-11 19:44:35.282 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.294 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.299 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 30.9008ms
2025-09-11 19:44:35.305 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.315 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 32.8848ms
2025-09-11 19:44:35.331 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 36.1026ms
2025-09-11 19:44:35.338 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.345 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 39.3553ms
2025-09-11 19:44:35.352 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.359 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.365 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 26.7726ms
2025-09-11 19:44:35.378 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.380 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 28.747ms
2025-09-11 19:44:35.388 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 28.6971ms
2025-09-11 19:44:35.395 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.401 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 23.4394ms
2025-09-11 19:44:35.408 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.417 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.423 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 27.3279ms
2025-09-11 19:44:35.431 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.436 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 27.6146ms
2025-09-11 19:44:35.441 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 23.7046ms
2025-09-11 19:44:35.454 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 23.0199ms
2025-09-11 19:44:35.457 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.463 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.470 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.483 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.486 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 28.6207ms
2025-09-11 19:44:35.495 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 32.3337ms
2025-09-11 19:44:35.501 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 31.0268ms
2025-09-11 19:44:35.508 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 25.4543ms
2025-09-11 19:44:35.515 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.524 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.532 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.540 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.548 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 33.3746ms
2025-09-11 19:44:35.554 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 30.6793ms
2025-09-11 19:44:35.561 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 29.201ms
2025-09-11 19:44:35.566 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 26.1655ms
2025-09-11 19:44:35.578 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.585 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.593 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.598 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.603 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 25.3671ms
2025-09-11 19:44:35.608 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 23.6848ms
2025-09-11 19:44:35.613 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 19.8978ms
2025-09-11 19:44:35.617 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 19.0969ms
2025-09-11 19:44:35.622 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.629 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.634 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.639 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.645 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 22.8356ms
2025-09-11 19:44:35.649 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 20.5421ms
2025-09-11 19:44:35.653 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 18.5201ms
2025-09-11 19:44:35.658 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 18.9297ms
2025-09-11 19:44:35.663 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.668 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.674 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.679 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.685 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 21.8955ms
2025-09-11 19:44:35.691 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 22.6326ms
2025-09-11 19:44:35.697 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 22.9039ms
2025-09-11 19:44:35.702 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 22.6465ms
2025-09-11 19:44:35.710 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.716 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.722 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.731 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.736 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 26.4414ms
2025-09-11 19:44:35.742 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 25.5281ms
2025-09-11 19:44:35.748 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 26.1012ms
2025-09-11 19:44:35.754 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 22.9463ms
2025-09-11 19:44:35.764 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.771 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.780 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.787 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.795 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 30.7244ms
2025-09-11 19:44:35.799 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 28.826ms
2025-09-11 19:44:35.804 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 24.6076ms
2025-09-11 19:44:35.812 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 24.9215ms
2025-09-11 19:44:35.817 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.828 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.835 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.842 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.848 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 30.6632ms
2025-09-11 19:44:35.853 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 24.7464ms
2025-09-11 19:44:35.860 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 25.4327ms
2025-09-11 19:44:35.866 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 23.3601ms
2025-09-11 19:44:35.873 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.881 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.888 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.897 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.903 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 30.0277ms
2025-09-11 19:44:35.910 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 29.0646ms
2025-09-11 19:44:35.915 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 26.8473ms
2025-09-11 19:44:35.921 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 24.0721ms
2025-09-11 19:44:35.928 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.938 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 110
2025-09-11 19:44:35.964 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 36.1971ms
2025-09-11 19:44:35.969 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 30.9847ms
2025-09-11 19:46:58.244 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.245 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.245 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.244 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.334 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:46:58.355 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:46:58.361 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:46:58.368 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:46:58.372 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.374 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.376 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.379 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.383 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:46:58.389 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:46:58.397 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:46:58.402 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:46:58.405 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.406 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.409 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.411 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.416 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:46:58.421 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:46:58.428 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:46:58.433 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:46:58.436 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.437 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.439 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.442 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.446 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:46:58.453 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:46:58.463 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:46:58.471 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:46:58.477 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.483 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.484 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.489 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.500 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:46:58.507 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:46:58.513 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:46:58.519 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-11 19:46:58.524 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.526 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.528 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.535 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.542 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 17.8321ms
2025-09-11 19:46:58.549 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 22.8665ms
2025-09-11 19:46:58.557 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 28.7288ms
2025-09-11 19:46:58.563 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 27.7122ms
2025-09-11 19:46:58.573 +03:00 [INF] Executed DbCommand (97ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:46:58.584 +03:00 [INF] Executed DbCommand (109ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:46:58.595 +03:00 [INF] Executed DbCommand (119ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:46:58.604 +03:00 [INF] Executed DbCommand (128ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:46:58.609 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:46:58.616 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:46:58.621 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:46:58.626 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:46:58.633 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:46:58.636 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:46:58.638 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:46:58.640 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:46:58.659 +03:00 [INF] Executing CreatePayment for order: ORD-20250911164319-5167
2025-09-11 19:46:58.669 +03:00 [INF] Starting CreatePaymentMethod for order ORD-20250911164319-5167 by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:46:58.664 +03:00 [INF] Executing CreatePayment for order: ORD-20250911164319-5167
2025-09-11 19:46:58.675 +03:00 [INF] Starting CreatePaymentMethod for order ORD-20250911164319-5167 by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:46:58.670 +03:00 [INF] Executing CreatePayment for order: ORD-20250911164319-5167
2025-09-11 19:46:58.659 +03:00 [INF] Executing CreatePayment for order: ORD-20250911164319-5167
2025-09-11 19:46:58.693 +03:00 [INF] Executed DbCommand (212ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:46:58.694 +03:00 [INF] Executed DbCommand (214ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:46:58.695 +03:00 [INF] Starting CreatePaymentMethod for order ORD-20250911164319-5167 by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:46:58.696 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.696 +03:00 [INF] Executed DbCommand (217ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:46:58.721 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:46:58.702 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:46:58.706 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:46:58.709 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:58.715 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 18.9419ms
2025-09-11 19:46:58.697 +03:00 [INF] Starting CreatePaymentMethod for order ORD-20250911164319-5167 by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:46:58.726 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:46:58.728 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:46:58.732 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:46:58.738 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 28.4976ms
2025-09-11 19:46:58.749 +03:00 [INF] Executed DbCommand (267ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:46:58.755 +03:00 [INF] Executed DbCommand (233ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:46:58.867 +03:00 [INF] Executing CreatePayment for order: ORD-20250911164319-5167
2025-09-11 19:46:58.875 +03:00 [INF] Executing CreatePayment for order: ORD-20250911164319-5167
2025-09-11 19:46:58.887 +03:00 [INF] Executing CreatePayment for order: ORD-20250911164319-5167
2025-09-11 19:46:58.999 +03:00 [INF] Executed DbCommand (476ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:46:59.056 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:46:59.070 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:46:59.072 +03:00 [INF] Starting CreatePaymentMethod for order ORD-20250911164319-5167 by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:46:59.074 +03:00 [INF] Starting CreatePaymentMethod for order ORD-20250911164319-5167 by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:46:59.076 +03:00 [INF] Starting CreatePaymentMethod for order ORD-20250911164319-5167 by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:46:59.083 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:46:59.086 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:46:59.088 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:46:59.092 +03:00 [INF] Executed DbCommand (569ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:46:59.103 +03:00 [INF] Executed DbCommand (580ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:46:59.108 +03:00 [INF] Executed DbCommand (535ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:46:59.109 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:46:59.117 +03:00 [INF] Executing CreatePayment for order: ORD-20250911164319-5167
2025-09-11 19:46:59.121 +03:00 [INF] Executing CreatePayment for order: ORD-20250911164319-5167
2025-09-11 19:46:59.125 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:46:59.144 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:46:59.135 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:46:59.140 +03:00 [INF] Executing CreatePayment for order: ORD-20250911164319-5167
2025-09-11 19:46:59.140 +03:00 [INF] Starting CreatePaymentMethod for order ORD-20250911164319-5167 by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:46:59.141 +03:00 [INF] Starting CreatePaymentMethod for order ORD-20250911164319-5167 by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:46:59.131 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:46:59.150 +03:00 [INF] Executing CreatePayment for order: ORD-20250911164319-5167
2025-09-11 19:46:59.151 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:46:59.153 +03:00 [INF] Starting CreatePaymentMethod for order ORD-20250911164319-5167 by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:46:59.157 +03:00 [INF] Executed DbCommand (465ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:46:59.163 +03:00 [INF] Executed DbCommand (409ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:46:59.165 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:46:59.167 +03:00 [INF] Starting CreatePaymentMethod for order ORD-20250911164319-5167 by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:46:59.172 +03:00 [INF] Executing CreatePayment for order: ORD-20250911164319-5167
2025-09-11 19:46:59.174 +03:00 [INF] Executed DbCommand (419ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:46:59.179 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:46:59.183 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:46:59.188 +03:00 [INF] Executing CreatePayment for order: ORD-20250911164319-5167
2025-09-11 19:46:59.190 +03:00 [INF] Executed DbCommand (434ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:46:59.192 +03:00 [INF] Starting CreatePaymentMethod for order ORD-20250911164319-5167 by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:46:59.198 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:46:59.201 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:46:59.205 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:46:59.208 +03:00 [INF] Starting CreatePaymentMethod for order ORD-20250911164319-5167 by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:46:59.214 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:46:59.218 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:46:59.218 +03:00 [INF] Executed DbCommand (111ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:46:59.224 +03:00 [INF] Executing CreatePayment for order: ORD-20250911164319-5167
2025-09-11 19:46:59.229 +03:00 [INF] Executing CreatePayment for order: ORD-20250911164319-5167
2025-09-11 19:46:59.295 +03:00 [INF] Starting CreatePaymentMethod for order ORD-20250911164319-5167 by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:46:59.236 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:46:59.285 +03:00 [INF] Executing CreatePayment for order: ORD-20250911164319-5167
2025-09-11 19:46:59.292 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:46:59.293 +03:00 [INF] Starting CreatePaymentMethod for order ORD-20250911164319-5167 by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:46:59.231 +03:00 [INF] Executed DbCommand (124ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:46:59.302 +03:00 [INF] Executed DbCommand (195ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-11 19:46:59.306 +03:00 [INF] Executing CreatePayment for order: ORD-20250911164319-5167
2025-09-11 19:46:59.307 +03:00 [INF] Starting CreatePaymentMethod for order ORD-20250911164319-5167 by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:46:59.310 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:46:59.331 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.406 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:46:59.416 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:46:59.421 +03:00 [INF] Starting CreatePaymentMethod for order ORD-20250911164319-5167 by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:46:59.426 +03:00 [INF] Getting order by number: ORD-20250911164319-5167
2025-09-11 19:46:59.430 +03:00 [INF] Executing CreatePayment for order: ORD-20250911164319-5167
2025-09-11 19:46:59.436 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 105.165ms
2025-09-11 19:46:59.441 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:46:59.444 +03:00 [INF] Route matched with {action = "CreatePayment", controller = "Payment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto]]] CreatePayment(CreatePaymentRequestDto) on controller E_Commerce.Controllers.PaymentController (E-Commerce).
2025-09-11 19:46:59.447 +03:00 [INF] Getting order by number: ORD-20250911164319-5167
2025-09-11 19:46:59.451 +03:00 [INF] Starting CreatePaymentMethod for order ORD-20250911164319-5167 by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:46:59.460 +03:00 [INF] Getting order by number: ORD-20250911164319-5167
2025-09-11 19:46:59.465 +03:00 [INF] Getting order by number: ORD-20250911164319-5167
2025-09-11 19:46:59.470 +03:00 [INF] Executing CreatePayment for order: ORD-20250911164319-5167
2025-09-11 19:46:59.476 +03:00 [INF] Executing CreatePayment for order: ORD-20250911164319-5167
2025-09-11 19:46:59.481 +03:00 [INF] Getting order by number: ORD-20250911164319-5167
2025-09-11 19:46:59.486 +03:00 [INF] Getting order by number: ORD-20250911164319-5167
2025-09-11 19:46:59.488 +03:00 [INF] Getting order by number: ORD-20250911164319-5167
2025-09-11 19:46:59.490 +03:00 [INF] Starting CreatePaymentMethod for order ORD-20250911164319-5167 by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:46:59.490 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.492 +03:00 [INF] Starting CreatePaymentMethod for order ORD-20250911164319-5167 by user e682f183-1c61-400b-aa5a-171750f446b5
2025-09-11 19:46:59.497 +03:00 [INF] Getting order by number: ORD-20250911164319-5167
2025-09-11 19:46:59.501 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.504 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.508 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.514 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 23.4842ms
2025-09-11 19:46:59.527 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 26.4916ms
2025-09-11 19:46:59.537 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 33.2351ms
2025-09-11 19:46:59.542 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 34.0864ms
2025-09-11 19:46:59.554 +03:00 [INF] Executed DbCommand (95ms) [Parameters=[@__orderNumber_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`Id`, `o`.`CancelledAt`, `o`.`CreatedAt`, `o`.`CustomerAddressId`, `o`.`CustomerId`, `o`.`DeletedAt`, `o`.`DeliveredAt`, `o`.`DiscountAmount`, `o`.`ModifiedAt`, `o`.`Notes`, `o`.`OrderNumber`, `o`.`RestockedAt`, `o`.`RowVersion`, `o`.`ShippedAt`, `o`.`ShippingCost`, `o`.`Status`, `o`.`Subtotal`, `o`.`TaxAmount`, `o`.`Total`
FROM `Orders` AS `o`
WHERE `o`.`OrderNumber` = @__orderNumber_0
LIMIT 1
2025-09-11 19:46:59.567 +03:00 [INF] Getting order by number: ORD-20250911164319-5167
2025-09-11 19:46:59.575 +03:00 [INF] Getting order by number: ORD-20250911164319-5167
2025-09-11 19:46:59.586 +03:00 [INF] Executed DbCommand (108ms) [Parameters=[@__orderNumber_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`Id`, `o`.`CancelledAt`, `o`.`CreatedAt`, `o`.`CustomerAddressId`, `o`.`CustomerId`, `o`.`DeletedAt`, `o`.`DeliveredAt`, `o`.`DiscountAmount`, `o`.`ModifiedAt`, `o`.`Notes`, `o`.`OrderNumber`, `o`.`RestockedAt`, `o`.`RowVersion`, `o`.`ShippedAt`, `o`.`ShippingCost`, `o`.`Status`, `o`.`Subtotal`, `o`.`TaxAmount`, `o`.`Total`
FROM `Orders` AS `o`
WHERE `o`.`OrderNumber` = @__orderNumber_0
LIMIT 1
2025-09-11 19:46:59.594 +03:00 [INF] Getting order by number: ORD-20250911164319-5167
2025-09-11 19:46:59.596 +03:00 [INF] Executed DbCommand (109ms) [Parameters=[@__orderNumber_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`Id`, `o`.`CancelledAt`, `o`.`CreatedAt`, `o`.`CustomerAddressId`, `o`.`CustomerId`, `o`.`DeletedAt`, `o`.`DeliveredAt`, `o`.`DiscountAmount`, `o`.`ModifiedAt`, `o`.`Notes`, `o`.`OrderNumber`, `o`.`RestockedAt`, `o`.`RowVersion`, `o`.`ShippedAt`, `o`.`ShippingCost`, `o`.`Status`, `o`.`Subtotal`, `o`.`TaxAmount`, `o`.`Total`
FROM `Orders` AS `o`
WHERE `o`.`OrderNumber` = @__orderNumber_0
LIMIT 1
2025-09-11 19:46:59.598 +03:00 [INF] Getting order by number: ORD-20250911164319-5167
2025-09-11 19:46:59.602 +03:00 [INF] Executed DbCommand (113ms) [Parameters=[@__orderNumber_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`Id`, `o`.`CancelledAt`, `o`.`CreatedAt`, `o`.`CustomerAddressId`, `o`.`CustomerId`, `o`.`DeletedAt`, `o`.`DeliveredAt`, `o`.`DiscountAmount`, `o`.`ModifiedAt`, `o`.`Notes`, `o`.`OrderNumber`, `o`.`RestockedAt`, `o`.`RowVersion`, `o`.`ShippedAt`, `o`.`ShippingCost`, `o`.`Status`, `o`.`Subtotal`, `o`.`TaxAmount`, `o`.`Total`
FROM `Orders` AS `o`
WHERE `o`.`OrderNumber` = @__orderNumber_0
LIMIT 1
2025-09-11 19:46:59.604 +03:00 [INF] Getting order by number: ORD-20250911164319-5167
2025-09-11 19:46:59.610 +03:00 [INF] Executed DbCommand (116ms) [Parameters=[@__orderNumber_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`Id`, `o`.`CancelledAt`, `o`.`CreatedAt`, `o`.`CustomerAddressId`, `o`.`CustomerId`, `o`.`DeletedAt`, `o`.`DeliveredAt`, `o`.`DiscountAmount`, `o`.`ModifiedAt`, `o`.`Notes`, `o`.`OrderNumber`, `o`.`RestockedAt`, `o`.`RowVersion`, `o`.`ShippedAt`, `o`.`ShippingCost`, `o`.`Status`, `o`.`Subtotal`, `o`.`TaxAmount`, `o`.`Total`
FROM `Orders` AS `o`
WHERE `o`.`OrderNumber` = @__orderNumber_0
LIMIT 1
2025-09-11 19:46:59.612 +03:00 [INF] Getting order by number: ORD-20250911164319-5167
2025-09-11 19:46:59.617 +03:00 [INF] Executed DbCommand (119ms) [Parameters=[@__orderNumber_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`Id`, `o`.`CancelledAt`, `o`.`CreatedAt`, `o`.`CustomerAddressId`, `o`.`CustomerId`, `o`.`DeletedAt`, `o`.`DeliveredAt`, `o`.`DiscountAmount`, `o`.`ModifiedAt`, `o`.`Notes`, `o`.`OrderNumber`, `o`.`RestockedAt`, `o`.`RowVersion`, `o`.`ShippedAt`, `o`.`ShippingCost`, `o`.`Status`, `o`.`Subtotal`, `o`.`TaxAmount`, `o`.`Total`
FROM `Orders` AS `o`
WHERE `o`.`OrderNumber` = @__orderNumber_0
LIMIT 1
2025-09-11 19:46:59.619 +03:00 [INF] Executed DbCommand (117ms) [Parameters=[@__orderNumber_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`Id`, `o`.`CancelledAt`, `o`.`CreatedAt`, `o`.`CustomerAddressId`, `o`.`CustomerId`, `o`.`DeletedAt`, `o`.`DeliveredAt`, `o`.`DiscountAmount`, `o`.`ModifiedAt`, `o`.`Notes`, `o`.`OrderNumber`, `o`.`RestockedAt`, `o`.`RowVersion`, `o`.`ShippedAt`, `o`.`ShippingCost`, `o`.`Status`, `o`.`Subtotal`, `o`.`TaxAmount`, `o`.`Total`
FROM `Orders` AS `o`
WHERE `o`.`OrderNumber` = @__orderNumber_0
LIMIT 1
2025-09-11 19:46:59.625 +03:00 [INF] Executed DbCommand (103ms) [Parameters=[@__orderNumber_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`Id`, `o`.`CancelledAt`, `o`.`CreatedAt`, `o`.`CustomerAddressId`, `o`.`CustomerId`, `o`.`DeletedAt`, `o`.`DeliveredAt`, `o`.`DiscountAmount`, `o`.`ModifiedAt`, `o`.`Notes`, `o`.`OrderNumber`, `o`.`RestockedAt`, `o`.`RowVersion`, `o`.`ShippedAt`, `o`.`ShippingCost`, `o`.`Status`, `o`.`Subtotal`, `o`.`TaxAmount`, `o`.`Total`
FROM `Orders` AS `o`
WHERE `o`.`OrderNumber` = @__orderNumber_0
LIMIT 1
2025-09-11 19:46:59.627 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.631 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.635 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.640 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.661 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 20.6134ms
2025-09-11 19:46:59.650 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 18.9993ms
2025-09-11 19:46:59.655 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 20.2896ms
2025-09-11 19:46:59.645 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 17.4216ms
2025-09-11 19:46:59.670 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT Id FROM Orders WHERE Id = @p0 FOR UPDATE
2025-09-11 19:46:59.676 +03:00 [INF] Executed DbCommand (81ms) [Parameters=[@__orderNumber_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`Id`, `o`.`CancelledAt`, `o`.`CreatedAt`, `o`.`CustomerAddressId`, `o`.`CustomerId`, `o`.`DeletedAt`, `o`.`DeliveredAt`, `o`.`DiscountAmount`, `o`.`ModifiedAt`, `o`.`Notes`, `o`.`OrderNumber`, `o`.`RestockedAt`, `o`.`RowVersion`, `o`.`ShippedAt`, `o`.`ShippingCost`, `o`.`Status`, `o`.`Subtotal`, `o`.`TaxAmount`, `o`.`Total`
FROM `Orders` AS `o`
WHERE `o`.`OrderNumber` = @__orderNumber_0
LIMIT 1
2025-09-11 19:46:59.683 +03:00 [INF] Executed DbCommand (85ms) [Parameters=[@__orderNumber_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`Id`, `o`.`CancelledAt`, `o`.`CreatedAt`, `o`.`CustomerAddressId`, `o`.`CustomerId`, `o`.`DeletedAt`, `o`.`DeliveredAt`, `o`.`DiscountAmount`, `o`.`ModifiedAt`, `o`.`Notes`, `o`.`OrderNumber`, `o`.`RestockedAt`, `o`.`RowVersion`, `o`.`ShippedAt`, `o`.`ShippingCost`, `o`.`Status`, `o`.`Subtotal`, `o`.`TaxAmount`, `o`.`Total`
FROM `Orders` AS `o`
WHERE `o`.`OrderNumber` = @__orderNumber_0
LIMIT 1
2025-09-11 19:46:59.689 +03:00 [INF] Executed DbCommand (86ms) [Parameters=[@__orderNumber_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`Id`, `o`.`CancelledAt`, `o`.`CreatedAt`, `o`.`CustomerAddressId`, `o`.`CustomerId`, `o`.`DeletedAt`, `o`.`DeliveredAt`, `o`.`DiscountAmount`, `o`.`ModifiedAt`, `o`.`Notes`, `o`.`OrderNumber`, `o`.`RestockedAt`, `o`.`RowVersion`, `o`.`ShippedAt`, `o`.`ShippingCost`, `o`.`Status`, `o`.`Subtotal`, `o`.`TaxAmount`, `o`.`Total`
FROM `Orders` AS `o`
WHERE `o`.`OrderNumber` = @__orderNumber_0
LIMIT 1
2025-09-11 19:46:59.696 +03:00 [INF] Execute GetAll for entity Payment
2025-09-11 19:46:59.705 +03:00 [INF] Executed DbCommand (93ms) [Parameters=[@__orderNumber_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`Id`, `o`.`CancelledAt`, `o`.`CreatedAt`, `o`.`CustomerAddressId`, `o`.`CustomerId`, `o`.`DeletedAt`, `o`.`DeliveredAt`, `o`.`DiscountAmount`, `o`.`ModifiedAt`, `o`.`Notes`, `o`.`OrderNumber`, `o`.`RestockedAt`, `o`.`RowVersion`, `o`.`ShippedAt`, `o`.`ShippingCost`, `o`.`Status`, `o`.`Subtotal`, `o`.`TaxAmount`, `o`.`Total`
FROM `Orders` AS `o`
WHERE `o`.`OrderNumber` = @__orderNumber_0
LIMIT 1
2025-09-11 19:46:59.709 +03:00 [INF] Getting order by number: ORD-20250911164319-5167
2025-09-11 19:46:59.720 +03:00 [INF] Getting order by number: ORD-20250911164319-5167
2025-09-11 19:46:59.714 +03:00 [INF] Executed DbCommand (95ms) [Parameters=[@__orderNumber_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`Id`, `o`.`CancelledAt`, `o`.`CreatedAt`, `o`.`CustomerAddressId`, `o`.`CustomerId`, `o`.`DeletedAt`, `o`.`DeliveredAt`, `o`.`DiscountAmount`, `o`.`ModifiedAt`, `o`.`Notes`, `o`.`OrderNumber`, `o`.`RestockedAt`, `o`.`RowVersion`, `o`.`ShippedAt`, `o`.`ShippingCost`, `o`.`Status`, `o`.`Subtotal`, `o`.`TaxAmount`, `o`.`Total`
FROM `Orders` AS `o`
WHERE `o`.`OrderNumber` = @__orderNumber_0
LIMIT 1
2025-09-11 19:46:59.722 +03:00 [INF] Executed DbCommand (96ms) [Parameters=[@__orderNumber_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`Id`, `o`.`CancelledAt`, `o`.`CreatedAt`, `o`.`CustomerAddressId`, `o`.`CustomerId`, `o`.`DeletedAt`, `o`.`DeliveredAt`, `o`.`DiscountAmount`, `o`.`ModifiedAt`, `o`.`Notes`, `o`.`OrderNumber`, `o`.`RestockedAt`, `o`.`RowVersion`, `o`.`ShippedAt`, `o`.`ShippingCost`, `o`.`Status`, `o`.`Subtotal`, `o`.`TaxAmount`, `o`.`Total`
FROM `Orders` AS `o`
WHERE `o`.`OrderNumber` = @__orderNumber_0
LIMIT 1
2025-09-11 19:46:59.724 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.727 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.727 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.735 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.739 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 15.4243ms
2025-09-11 19:46:59.745 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 18.025ms
2025-09-11 19:46:59.751 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 23.3409ms
2025-09-11 19:46:59.756 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 20.8404ms
2025-09-11 19:46:59.767 +03:00 [INF] Getting order by number: ORD-20250911164319-5167
2025-09-11 19:46:59.775 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.783 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.790 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.794 +03:00 [INF] Getting order by number: ORD-20250911164319-5167
2025-09-11 19:46:59.798 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 23.1076ms
2025-09-11 19:46:59.804 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 21.4119ms
2025-09-11 19:46:59.811 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 20.5446ms
2025-09-11 19:46:59.814 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.814 +03:00 [INF] Getting order by number: ORD-20250911164319-5167
2025-09-11 19:46:59.820 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.825 +03:00 [INF] Executed DbCommand (104ms) [Parameters=[@__orderNumber_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`Id`, `o`.`CancelledAt`, `o`.`CreatedAt`, `o`.`CustomerAddressId`, `o`.`CustomerId`, `o`.`DeletedAt`, `o`.`DeliveredAt`, `o`.`DiscountAmount`, `o`.`ModifiedAt`, `o`.`Notes`, `o`.`OrderNumber`, `o`.`RestockedAt`, `o`.`RowVersion`, `o`.`ShippedAt`, `o`.`ShippingCost`, `o`.`Status`, `o`.`Subtotal`, `o`.`TaxAmount`, `o`.`Total`
FROM `Orders` AS `o`
WHERE `o`.`OrderNumber` = @__orderNumber_0
LIMIT 1
2025-09-11 19:46:59.825 +03:00 [INF] Executed DbCommand (102ms) [Parameters=[@__orderNumber_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`Id`, `o`.`CancelledAt`, `o`.`CreatedAt`, `o`.`CustomerAddressId`, `o`.`CustomerId`, `o`.`DeletedAt`, `o`.`DeliveredAt`, `o`.`DiscountAmount`, `o`.`ModifiedAt`, `o`.`Notes`, `o`.`OrderNumber`, `o`.`RestockedAt`, `o`.`RowVersion`, `o`.`ShippedAt`, `o`.`ShippingCost`, `o`.`Status`, `o`.`Subtotal`, `o`.`TaxAmount`, `o`.`Total`
FROM `Orders` AS `o`
WHERE `o`.`OrderNumber` = @__orderNumber_0
LIMIT 1
2025-09-11 19:46:59.828 +03:00 [INF] Executed DbCommand (102ms) [Parameters=[@__order_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Amount`, `p`.`CreatedAt`, `p`.`CustomerId`, `p`.`DeletedAt`, `p`.`ModifiedAt`, `p`.`OrderId`, `p`.`PaymentDate`, `p`.`PaymentMethodId`, `p`.`PaymentProviderId`, `p`.`ProviderOrderId`, `p`.`RowVersion`, `p`.`Status`, `p`.`TransactionId`
FROM `Payments` AS `p`
WHERE (`p`.`OrderId` = @__order_Id_0) AND (`p`.`Status` = 1)
LIMIT 1
2025-09-11 19:46:59.835 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.841 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 27.3643ms
2025-09-11 19:46:59.845 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.850 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 30.1521ms
2025-09-11 19:46:59.864 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.867 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.875 +03:00 [INF] Getting payment method ID for enum "Visa"
2025-09-11 19:46:59.877 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 42.1584ms
2025-09-11 19:46:59.884 +03:00 [INF] Executed DbCommand (92ms) [Parameters=[@__orderNumber_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`Id`, `o`.`CancelledAt`, `o`.`CreatedAt`, `o`.`CustomerAddressId`, `o`.`CustomerId`, `o`.`DeletedAt`, `o`.`DeliveredAt`, `o`.`DiscountAmount`, `o`.`ModifiedAt`, `o`.`Notes`, `o`.`OrderNumber`, `o`.`RestockedAt`, `o`.`RowVersion`, `o`.`ShippedAt`, `o`.`ShippingCost`, `o`.`Status`, `o`.`Subtotal`, `o`.`TaxAmount`, `o`.`Total`
FROM `Orders` AS `o`
WHERE `o`.`OrderNumber` = @__orderNumber_0
LIMIT 1
2025-09-11 19:46:59.890 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 45.2892ms
2025-09-11 19:46:59.897 +03:00 [INF] Executed DbCommand (84ms) [Parameters=[@__orderNumber_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`Id`, `o`.`CancelledAt`, `o`.`CreatedAt`, `o`.`CustomerAddressId`, `o`.`CustomerId`, `o`.`DeletedAt`, `o`.`DeliveredAt`, `o`.`DiscountAmount`, `o`.`ModifiedAt`, `o`.`Notes`, `o`.`OrderNumber`, `o`.`RestockedAt`, `o`.`RowVersion`, `o`.`ShippedAt`, `o`.`ShippingCost`, `o`.`Status`, `o`.`Subtotal`, `o`.`TaxAmount`, `o`.`Total`
FROM `Orders` AS `o`
WHERE `o`.`OrderNumber` = @__orderNumber_0
LIMIT 1
2025-09-11 19:46:59.903 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 39.092ms
2025-09-11 19:46:59.908 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 41.1136ms
2025-09-11 19:46:59.911 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:46:59.921 +03:00 [INF] Getting order by number: ORD-20250911164319-5167
2025-09-11 19:46:59.925 +03:00 [INF] Executed DbCommand (82ms) [Parameters=[@__orderNumber_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`Id`, `o`.`CancelledAt`, `o`.`CreatedAt`, `o`.`CustomerAddressId`, `o`.`CustomerId`, `o`.`DeletedAt`, `o`.`DeliveredAt`, `o`.`DiscountAmount`, `o`.`ModifiedAt`, `o`.`Notes`, `o`.`OrderNumber`, `o`.`RestockedAt`, `o`.`RowVersion`, `o`.`ShippedAt`, `o`.`ShippingCost`, `o`.`Status`, `o`.`Subtotal`, `o`.`TaxAmount`, `o`.`Total`
FROM `Orders` AS `o`
WHERE `o`.`OrderNumber` = @__orderNumber_0
LIMIT 1
2025-09-11 19:46:59.933 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.937 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.943 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.951 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.954 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.959 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.966 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 33.7947ms
2025-09-11 19:46:59.972 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 34.8981ms
2025-09-11 19:46:59.973 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:46:59.977 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 34.3431ms
2025-09-11 19:46:59.983 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 32.1735ms
2025-09-11 19:46:59.988 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 33.7625ms
2025-09-11 19:46:59.993 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 34.2285ms
2025-09-11 19:47:00.001 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.008 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.017 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 43.5114ms
2025-09-11 19:47:00.024 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.034 +03:00 [INF] Executed DbCommand (80ms) [Parameters=[@__orderNumber_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`Id`, `o`.`CancelledAt`, `o`.`CreatedAt`, `o`.`CustomerAddressId`, `o`.`CustomerId`, `o`.`DeletedAt`, `o`.`DeliveredAt`, `o`.`DiscountAmount`, `o`.`ModifiedAt`, `o`.`Notes`, `o`.`OrderNumber`, `o`.`RestockedAt`, `o`.`RowVersion`, `o`.`ShippedAt`, `o`.`ShippingCost`, `o`.`Status`, `o`.`Subtotal`, `o`.`TaxAmount`, `o`.`Total`
FROM `Orders` AS `o`
WHERE `o`.`OrderNumber` = @__orderNumber_0
LIMIT 1
2025-09-11 19:47:00.042 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.050 +03:00 [INF] Executed DbCommand (80ms) [Parameters=[@__methodEnum_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`
FROM `PaymentMethods` AS `p`
WHERE ((`p`.`Method` = @__methodEnum_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:00.056 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 54.3118ms
2025-09-11 19:47:00.061 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 53.1159ms
2025-09-11 19:47:00.069 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.076 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 51.7168ms
2025-09-11 19:47:00.081 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.085 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 43.2887ms
2025-09-11 19:47:00.095 +03:00 [INF] Found payment method ID 1 for enum "Visa"
2025-09-11 19:47:00.099 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.106 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.111 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 41.9578ms
2025-09-11 19:47:00.119 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.125 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 44.033ms
2025-09-11 19:47:00.133 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.137 +03:00 [INF] Executing GetByIdAsync for entity PaymentMethod with ID: 1
2025-09-11 19:47:00.141 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 42.2014ms
2025-09-11 19:47:00.147 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 41.3949ms
2025-09-11 19:47:00.155 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.161 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 42.4712ms
2025-09-11 19:47:00.169 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.174 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 40.9414ms
2025-09-11 19:47:00.183 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.183 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.191 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.197 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 41.27ms
2025-09-11 19:47:00.203 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.209 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 40.4063ms
2025-09-11 19:47:00.217 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.224 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 40.2609ms
2025-09-11 19:47:00.229 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 45.2872ms
2025-09-11 19:47:00.235 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 44.3624ms
2025-09-11 19:47:00.241 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.248 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 44.4379ms
2025-09-11 19:47:00.255 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IntegrationId`, `p`.`IsActive`, `p`.`Method`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`PaymentProviderId`
FROM `PaymentMethods` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-09-11 19:47:00.262 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 44.6515ms
2025-09-11 19:47:00.269 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.284 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.290 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.295 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 54.2846ms
2025-09-11 19:47:00.303 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.317 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.322 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 52.2751ms
2025-09-11 19:47:00.328 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 44.2779ms
2025-09-11 19:47:00.334 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 43.9878ms
2025-09-11 19:47:00.342 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.347 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 44.7395ms
2025-09-11 19:47:00.353 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 36.3004ms
2025-09-11 19:47:00.354 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:00.360 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.367 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.375 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.382 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 40.3031ms
2025-09-11 19:47:00.389 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.395 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.400 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 40.2322ms
2025-09-11 19:47:00.402 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.405 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 38.4147ms
2025-09-11 19:47:00.411 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 35.9397ms
2025-09-11 19:47:00.418 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.425 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 36.0649ms
2025-09-11 19:47:00.430 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 35.0757ms
2025-09-11 19:47:00.439 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.447 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 44.8447ms
2025-09-11 19:47:00.455 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.474 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 56.4015ms
2025-09-11 19:47:00.504 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 64.6557ms
2025-09-11 19:47:00.509 +03:00 [INF] Executed DbCommand (107ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`PublicKey`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = 1
LIMIT 1
2025-09-11 19:47:00.517 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 61.2939ms
2025-09-11 19:47:00.523 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.534 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.547 +03:00 [INF] Executing GetTokenAsync
2025-09-11 19:47:00.565 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.609 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 44.6277ms
2025-09-11 19:47:00.602 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 67.9336ms
2025-09-11 19:47:00.577 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 53.9542ms
2025-09-11 19:47:00.616 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.615 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:00.623 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.629 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.653 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 23.8944ms
2025-09-11 19:47:00.639 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:00.645 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 21.6575ms
2025-09-11 19:47:00.634 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 17.7936ms
2025-09-11 19:47:00.672 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.687 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.696 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.710 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 38.4983ms
2025-09-11 19:47:00.717 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 30.2131ms
2025-09-11 19:47:00.723 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 27.6259ms
2025-09-11 19:47:00.746 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.737 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.730 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Payment - application/json; charset=utf-8 114
2025-09-11 19:47:00.751 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 5.1262ms
2025-09-11 19:47:00.758 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 20.1829ms
2025-09-11 19:47:00.764 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 429 null application/json 33.9433ms
2025-09-11 19:47:01.543 +03:00 [INF] Received HTTP response headers after 866.5643ms - 201
2025-09-11 19:47:01.549 +03:00 [INF] End processing HTTP request after 936.6951ms - 201
2025-09-11 19:47:01.561 +03:00 [INF] Successfully retrieved PayMob token
2025-09-11 19:47:01.645 +03:00 [INF] Executed DbCommand (78ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-09-11 19:47:01.657 +03:00 [INF] Getting address by ID: 31
2025-09-11 19:47:01.751 +03:00 [INF] Executed DbCommand (81ms) [Parameters=[@__addressId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AdditionalNotes`, `c`.`AddressType`, `c`.`City`, `c`.`Country`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`IsDefault`, `c`.`ModifiedAt`, `c`.`PhoneNumber`, `c`.`PostalCode`, `c`.`State`, `c`.`StreetAddress`, `t`.`Id`, `t`.`AccessFailedCount`, `t`.`ConcurrencyStamp`, `t`.`Discriminator`, `t`.`Email`, `t`.`EmailConfirmed`, `t`.`LockoutEnabled`, `t`.`LockoutEnd`, `t`.`NormalizedEmail`, `t`.`NormalizedUserName`, `t`.`PasswordHash`, `t`.`PhoneNumber`, `t`.`PhoneNumberConfirmed`, `t`.`SecurityStamp`, `t`.`TwoFactorEnabled`, `t`.`UserName`, `t`.`Age`, `t`.`CreateAt`, `t`.`DeletedAt`, `t`.`Gender`, `t`.`ImageId`, `t`.`ImageId1`, `t`.`LastVisit`, `t`.`Name`
FROM `CustomerAddresses` AS `c`
INNER JOIN (
    SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
    FROM `AspNetUsers` AS `a`
    WHERE `a`.`Discriminator` = 'Customer'
) AS `t` ON `c`.`CustomerId` = `t`.`Id`
WHERE (`c`.`Id` = @__addressId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:01.769 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:01.774 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:01.992 +03:00 [INF] Received HTTP response headers after 214.3176ms - 201
2025-09-11 19:47:02.004 +03:00 [INF] End processing HTTP request after 235.3157ms - 201
2025-09-11 19:47:02.037 +03:00 [INF] Successfully created PayMob order: 384475374 for local order: ORD-20250911164319-5167
2025-09-11 19:47:02.044 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:02.126 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__dto_PaymentMethod_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IntegrationId`
FROM `PaymentMethods` AS `p`
INNER JOIN `PaymentProviders` AS `p0` ON `p`.`PaymentProviderId` = `p0`.`Id`
WHERE ((`p`.`Method` = @__dto_PaymentMethod_0) AND `p`.`IsActive`) AND (`p0`.`Provider` = 1)
LIMIT 1
2025-09-11 19:47:02.134 +03:00 [INF] Using integration ID: 5221967 for payment method: "Visa"
2025-09-11 19:47:02.144 +03:00 [INF] Starting GeneratePaymentKeyAsync for Order ID: 384475374, Amount: 1012226
2025-09-11 19:47:02.158 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:02.170 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:02.391 +03:00 [INF] Received HTTP response headers after 217.8567ms - 201
2025-09-11 19:47:02.396 +03:00 [INF] End processing HTTP request after 238.3322ms - 201
2025-09-11 19:47:02.402 +03:00 [INF] Request sent to Paymob payment_keys endpoint
2025-09-11 19:47:02.405 +03:00 [INF] Received response from Paymob payment_keys endpoint
2025-09-11 19:47:02.407 +03:00 [INF] Payment key generated successfully for Order ID: 384475374
2025-09-11 19:47:02.409 +03:00 [INF] Successfully generated payment key for order: ORD-20250911164319-5167
2025-09-11 19:47:02.416 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:02.495 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__paymentProvider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IframeId`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = @__paymentProvider_0
LIMIT 1
2025-09-11 19:47:02.504 +03:00 [INF] Executing CreateAsync for entity Payment
2025-09-11 19:47:02.550 +03:00 [INF] Payment added successfully (pending save)
2025-09-11 19:47:02.554 +03:00 [INF] Execute AddUserOpreationAsync
2025-09-11 19:47:02.557 +03:00 [INF] Executing CreateAsync for entity UserOperationsLog
2025-09-11 19:47:02.561 +03:00 [INF] UserOperationsLog added successfully (pending save)
2025-09-11 19:47:02.773 +03:00 [INF] Executed DbCommand (79ms) [Parameters=[@p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime), @p2='?' (Size = 255), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int64), @p10='?' (DbType = Int32), @p11='?' (Size = 100), @p12='?' (DbType = DateTime), @p13='?' (DbType = DateTime), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime), @p17='?' (DbType = Int32), @p18='?' (DbType = DateTime), @p19='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `Payments` (`Amount`, `CreatedAt`, `CustomerId`, `DeletedAt`, `ModifiedAt`, `OrderId`, `PaymentDate`, `PaymentMethodId`, `PaymentProviderId`, `ProviderOrderId`, `Status`, `TransactionId`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
SELECT `Id`, `RowVersion`
FROM `Payments`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `userOperationsLogs` (`CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`, `UserId`)
VALUES (@p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19);
SELECT `Id`
FROM `userOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-09-11 19:47:02.935 +03:00 [INF] Executed DbCommand (3,333ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT Id FROM Orders WHERE Id = @p0 FOR UPDATE
2025-09-11 19:47:02.936 +03:00 [INF] Payment created successfully with ID 20
2025-09-11 19:47:02.942 +03:00 [INF] Execute GetAll for entity Payment
2025-09-11 19:47:03.022 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__order_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Amount`, `p`.`CreatedAt`, `p`.`CustomerId`, `p`.`DeletedAt`, `p`.`ModifiedAt`, `p`.`OrderId`, `p`.`PaymentDate`, `p`.`PaymentMethodId`, `p`.`PaymentProviderId`, `p`.`ProviderOrderId`, `p`.`RowVersion`, `p`.`Status`, `p`.`TransactionId`
FROM `Payments` AS `p`
WHERE (`p`.`OrderId` = @__order_Id_0) AND (`p`.`Status` = 1)
LIMIT 1
2025-09-11 19:47:03.032 +03:00 [INF] Getting payment method ID for enum "Visa"
2025-09-11 19:47:03.034 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:03.109 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__methodEnum_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`
FROM `PaymentMethods` AS `p`
WHERE ((`p`.`Method` = @__methodEnum_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:03.118 +03:00 [INF] Found payment method ID 1 for enum "Visa"
2025-09-11 19:47:03.122 +03:00 [INF] Executing GetByIdAsync for entity PaymentMethod with ID: 1
2025-09-11 19:47:03.197 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IntegrationId`, `p`.`IsActive`, `p`.`Method`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`PaymentProviderId`
FROM `PaymentMethods` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-09-11 19:47:03.204 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:03.280 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`PublicKey`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = 1
LIMIT 1
2025-09-11 19:47:03.291 +03:00 [INF] Executing GetTokenAsync
2025-09-11 19:47:03.294 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:03.298 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:03.515 +03:00 [INF] Received HTTP response headers after 213.6228ms - 201
2025-09-11 19:47:03.525 +03:00 [INF] End processing HTTP request after 231.7848ms - 201
2025-09-11 19:47:03.535 +03:00 [INF] Successfully retrieved PayMob token
2025-09-11 19:47:03.622 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-09-11 19:47:03.629 +03:00 [INF] Getting address by ID: 31
2025-09-11 19:47:03.713 +03:00 [INF] Executed DbCommand (80ms) [Parameters=[@__addressId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AdditionalNotes`, `c`.`AddressType`, `c`.`City`, `c`.`Country`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`IsDefault`, `c`.`ModifiedAt`, `c`.`PhoneNumber`, `c`.`PostalCode`, `c`.`State`, `c`.`StreetAddress`, `t`.`Id`, `t`.`AccessFailedCount`, `t`.`ConcurrencyStamp`, `t`.`Discriminator`, `t`.`Email`, `t`.`EmailConfirmed`, `t`.`LockoutEnabled`, `t`.`LockoutEnd`, `t`.`NormalizedEmail`, `t`.`NormalizedUserName`, `t`.`PasswordHash`, `t`.`PhoneNumber`, `t`.`PhoneNumberConfirmed`, `t`.`SecurityStamp`, `t`.`TwoFactorEnabled`, `t`.`UserName`, `t`.`Age`, `t`.`CreateAt`, `t`.`DeletedAt`, `t`.`Gender`, `t`.`ImageId`, `t`.`ImageId1`, `t`.`LastVisit`, `t`.`Name`
FROM `CustomerAddresses` AS `c`
INNER JOIN (
    SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
    FROM `AspNetUsers` AS `a`
    WHERE `a`.`Discriminator` = 'Customer'
) AS `t` ON `c`.`CustomerId` = `t`.`Id`
WHERE (`c`.`Id` = @__addressId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:03.721 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:03.724 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:03.824 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:47:03.832 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 5175.8158ms
2025-09-11 19:47:03.837 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:47:03.840 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 200 1365 application/json; charset=utf-8 5594.92ms
2025-09-11 19:47:03.933 +03:00 [INF] Received HTTP response headers after 206.5485ms - 201
2025-09-11 19:47:03.940 +03:00 [INF] End processing HTTP request after 219.0269ms - 201
2025-09-11 19:47:03.946 +03:00 [INF] Successfully created PayMob order: 384475404 for local order: ORD-20250911164319-5167
2025-09-11 19:47:03.951 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:04.028 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__dto_PaymentMethod_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IntegrationId`
FROM `PaymentMethods` AS `p`
INNER JOIN `PaymentProviders` AS `p0` ON `p`.`PaymentProviderId` = `p0`.`Id`
WHERE ((`p`.`Method` = @__dto_PaymentMethod_0) AND `p`.`IsActive`) AND (`p0`.`Provider` = 1)
LIMIT 1
2025-09-11 19:47:04.038 +03:00 [INF] Using integration ID: 5221967 for payment method: "Visa"
2025-09-11 19:47:04.042 +03:00 [INF] Starting GeneratePaymentKeyAsync for Order ID: 384475404, Amount: 1012226
2025-09-11 19:47:04.046 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:04.048 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:04.268 +03:00 [INF] Received HTTP response headers after 214.8529ms - 201
2025-09-11 19:47:04.272 +03:00 [INF] End processing HTTP request after 226.6616ms - 201
2025-09-11 19:47:04.278 +03:00 [INF] Request sent to Paymob payment_keys endpoint
2025-09-11 19:47:04.282 +03:00 [INF] Received response from Paymob payment_keys endpoint
2025-09-11 19:47:04.286 +03:00 [INF] Payment key generated successfully for Order ID: 384475404
2025-09-11 19:47:04.289 +03:00 [INF] Successfully generated payment key for order: ORD-20250911164319-5167
2025-09-11 19:47:04.292 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:04.369 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__paymentProvider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IframeId`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = @__paymentProvider_0
LIMIT 1
2025-09-11 19:47:04.379 +03:00 [INF] Executing CreateAsync for entity Payment
2025-09-11 19:47:04.383 +03:00 [INF] Payment added successfully (pending save)
2025-09-11 19:47:04.385 +03:00 [INF] Execute AddUserOpreationAsync
2025-09-11 19:47:04.388 +03:00 [INF] Executing CreateAsync for entity UserOperationsLog
2025-09-11 19:47:04.390 +03:00 [INF] UserOperationsLog added successfully (pending save)
2025-09-11 19:47:04.544 +03:00 [INF] Executed DbCommand (79ms) [Parameters=[@p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime), @p2='?' (Size = 255), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int64), @p10='?' (DbType = Int32), @p11='?' (Size = 100), @p12='?' (DbType = DateTime), @p13='?' (DbType = DateTime), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime), @p17='?' (DbType = Int32), @p18='?' (DbType = DateTime), @p19='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `Payments` (`Amount`, `CreatedAt`, `CustomerId`, `DeletedAt`, `ModifiedAt`, `OrderId`, `PaymentDate`, `PaymentMethodId`, `PaymentProviderId`, `ProviderOrderId`, `Status`, `TransactionId`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
SELECT `Id`, `RowVersion`
FROM `Payments`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `userOperationsLogs` (`CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`, `UserId`)
VALUES (@p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19);
SELECT `Id`
FROM `userOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-09-11 19:47:04.783 +03:00 [INF] Payment created successfully with ID 21
2025-09-11 19:47:04.785 +03:00 [INF] Executed DbCommand (5,175ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT Id FROM Orders WHERE Id = @p0 FOR UPDATE
2025-09-11 19:47:04.793 +03:00 [INF] Execute GetAll for entity Payment
2025-09-11 19:47:04.871 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__order_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Amount`, `p`.`CreatedAt`, `p`.`CustomerId`, `p`.`DeletedAt`, `p`.`ModifiedAt`, `p`.`OrderId`, `p`.`PaymentDate`, `p`.`PaymentMethodId`, `p`.`PaymentProviderId`, `p`.`ProviderOrderId`, `p`.`RowVersion`, `p`.`Status`, `p`.`TransactionId`
FROM `Payments` AS `p`
WHERE (`p`.`OrderId` = @__order_Id_0) AND (`p`.`Status` = 1)
LIMIT 1
2025-09-11 19:47:04.880 +03:00 [INF] Getting payment method ID for enum "Visa"
2025-09-11 19:47:04.882 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:04.970 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__methodEnum_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`
FROM `PaymentMethods` AS `p`
WHERE ((`p`.`Method` = @__methodEnum_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:04.975 +03:00 [INF] Found payment method ID 1 for enum "Visa"
2025-09-11 19:47:04.980 +03:00 [INF] Executing GetByIdAsync for entity PaymentMethod with ID: 1
2025-09-11 19:47:05.056 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IntegrationId`, `p`.`IsActive`, `p`.`Method`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`PaymentProviderId`
FROM `PaymentMethods` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-09-11 19:47:05.063 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:05.141 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`PublicKey`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = 1
LIMIT 1
2025-09-11 19:47:05.147 +03:00 [INF] Executing GetTokenAsync
2025-09-11 19:47:05.149 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:05.152 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:05.381 +03:00 [INF] Received HTTP response headers after 226.9559ms - 201
2025-09-11 19:47:05.455 +03:00 [INF] End processing HTTP request after 306.5252ms - 201
2025-09-11 19:47:05.459 +03:00 [INF] Successfully retrieved PayMob token
2025-09-11 19:47:05.540 +03:00 [INF] Executed DbCommand (78ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-09-11 19:47:05.548 +03:00 [INF] Getting address by ID: 31
2025-09-11 19:47:05.632 +03:00 [INF] Executed DbCommand (81ms) [Parameters=[@__addressId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AdditionalNotes`, `c`.`AddressType`, `c`.`City`, `c`.`Country`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`IsDefault`, `c`.`ModifiedAt`, `c`.`PhoneNumber`, `c`.`PostalCode`, `c`.`State`, `c`.`StreetAddress`, `t`.`Id`, `t`.`AccessFailedCount`, `t`.`ConcurrencyStamp`, `t`.`Discriminator`, `t`.`Email`, `t`.`EmailConfirmed`, `t`.`LockoutEnabled`, `t`.`LockoutEnd`, `t`.`NormalizedEmail`, `t`.`NormalizedUserName`, `t`.`PasswordHash`, `t`.`PhoneNumber`, `t`.`PhoneNumberConfirmed`, `t`.`SecurityStamp`, `t`.`TwoFactorEnabled`, `t`.`UserName`, `t`.`Age`, `t`.`CreateAt`, `t`.`DeletedAt`, `t`.`Gender`, `t`.`ImageId`, `t`.`ImageId1`, `t`.`LastVisit`, `t`.`Name`
FROM `CustomerAddresses` AS `c`
INNER JOIN (
    SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
    FROM `AspNetUsers` AS `a`
    WHERE `a`.`Discriminator` = 'Customer'
) AS `t` ON `c`.`CustomerId` = `t`.`Id`
WHERE (`c`.`Id` = @__addressId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:05.643 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:05.646 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:05.661 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:47:05.667 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 6999.5038ms
2025-09-11 19:47:05.673 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:47:05.675 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 200 1365 application/json; charset=utf-8 7431.3985ms
2025-09-11 19:47:05.854 +03:00 [INF] Received HTTP response headers after 205.0711ms - 201
2025-09-11 19:47:05.859 +03:00 [INF] End processing HTTP request after 216.0353ms - 201
2025-09-11 19:47:05.864 +03:00 [INF] Successfully created PayMob order: 384475422 for local order: ORD-20250911164319-5167
2025-09-11 19:47:05.868 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:05.945 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__dto_PaymentMethod_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IntegrationId`
FROM `PaymentMethods` AS `p`
INNER JOIN `PaymentProviders` AS `p0` ON `p`.`PaymentProviderId` = `p0`.`Id`
WHERE ((`p`.`Method` = @__dto_PaymentMethod_0) AND `p`.`IsActive`) AND (`p0`.`Provider` = 1)
LIMIT 1
2025-09-11 19:47:05.955 +03:00 [INF] Using integration ID: 5221967 for payment method: "Visa"
2025-09-11 19:47:05.958 +03:00 [INF] Starting GeneratePaymentKeyAsync for Order ID: 384475422, Amount: 1012226
2025-09-11 19:47:05.961 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:05.966 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:06.189 +03:00 [INF] Received HTTP response headers after 217.7338ms - 201
2025-09-11 19:47:06.194 +03:00 [INF] End processing HTTP request after 233.6919ms - 201
2025-09-11 19:47:06.201 +03:00 [INF] Request sent to Paymob payment_keys endpoint
2025-09-11 19:47:06.203 +03:00 [INF] Received response from Paymob payment_keys endpoint
2025-09-11 19:47:06.205 +03:00 [INF] Payment key generated successfully for Order ID: 384475422
2025-09-11 19:47:06.207 +03:00 [INF] Successfully generated payment key for order: ORD-20250911164319-5167
2025-09-11 19:47:06.209 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:06.286 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__paymentProvider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IframeId`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = @__paymentProvider_0
LIMIT 1
2025-09-11 19:47:06.300 +03:00 [INF] Executing CreateAsync for entity Payment
2025-09-11 19:47:06.304 +03:00 [INF] Payment added successfully (pending save)
2025-09-11 19:47:06.306 +03:00 [INF] Execute AddUserOpreationAsync
2025-09-11 19:47:06.310 +03:00 [INF] Executing CreateAsync for entity UserOperationsLog
2025-09-11 19:47:06.313 +03:00 [INF] UserOperationsLog added successfully (pending save)
2025-09-11 19:47:06.468 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[@p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime), @p2='?' (Size = 255), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int64), @p10='?' (DbType = Int32), @p11='?' (Size = 100), @p12='?' (DbType = DateTime), @p13='?' (DbType = DateTime), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime), @p17='?' (DbType = Int32), @p18='?' (DbType = DateTime), @p19='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `Payments` (`Amount`, `CreatedAt`, `CustomerId`, `DeletedAt`, `ModifiedAt`, `OrderId`, `PaymentDate`, `PaymentMethodId`, `PaymentProviderId`, `ProviderOrderId`, `Status`, `TransactionId`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
SELECT `Id`, `RowVersion`
FROM `Payments`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `userOperationsLogs` (`CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`, `UserId`)
VALUES (@p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19);
SELECT `Id`
FROM `userOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-09-11 19:47:06.622 +03:00 [INF] Payment created successfully with ID 22
2025-09-11 19:47:06.622 +03:00 [INF] Executed DbCommand (7,006ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT Id FROM Orders WHERE Id = @p0 FOR UPDATE
2025-09-11 19:47:06.660 +03:00 [INF] Execute GetAll for entity Payment
2025-09-11 19:47:06.741 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__order_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Amount`, `p`.`CreatedAt`, `p`.`CustomerId`, `p`.`DeletedAt`, `p`.`ModifiedAt`, `p`.`OrderId`, `p`.`PaymentDate`, `p`.`PaymentMethodId`, `p`.`PaymentProviderId`, `p`.`ProviderOrderId`, `p`.`RowVersion`, `p`.`Status`, `p`.`TransactionId`
FROM `Payments` AS `p`
WHERE (`p`.`OrderId` = @__order_Id_0) AND (`p`.`Status` = 1)
LIMIT 1
2025-09-11 19:47:06.755 +03:00 [INF] Getting payment method ID for enum "Visa"
2025-09-11 19:47:06.758 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:06.834 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__methodEnum_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`
FROM `PaymentMethods` AS `p`
WHERE ((`p`.`Method` = @__methodEnum_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:06.850 +03:00 [INF] Found payment method ID 1 for enum "Visa"
2025-09-11 19:47:06.857 +03:00 [INF] Executing GetByIdAsync for entity PaymentMethod with ID: 1
2025-09-11 19:47:06.944 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IntegrationId`, `p`.`IsActive`, `p`.`Method`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`PaymentProviderId`
FROM `PaymentMethods` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-09-11 19:47:06.955 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:07.031 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`PublicKey`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = 1
LIMIT 1
2025-09-11 19:47:07.040 +03:00 [INF] Executing GetTokenAsync
2025-09-11 19:47:07.042 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:07.045 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:07.268 +03:00 [INF] Received HTTP response headers after 218.9709ms - 201
2025-09-11 19:47:07.281 +03:00 [INF] End processing HTTP request after 239.0768ms - 201
2025-09-11 19:47:07.293 +03:00 [INF] Successfully retrieved PayMob token
2025-09-11 19:47:07.382 +03:00 [INF] Executed DbCommand (83ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-09-11 19:47:07.393 +03:00 [INF] Getting address by ID: 31
2025-09-11 19:47:07.479 +03:00 [INF] Executed DbCommand (81ms) [Parameters=[@__addressId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AdditionalNotes`, `c`.`AddressType`, `c`.`City`, `c`.`Country`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`IsDefault`, `c`.`ModifiedAt`, `c`.`PhoneNumber`, `c`.`PostalCode`, `c`.`State`, `c`.`StreetAddress`, `t`.`Id`, `t`.`AccessFailedCount`, `t`.`ConcurrencyStamp`, `t`.`Discriminator`, `t`.`Email`, `t`.`EmailConfirmed`, `t`.`LockoutEnabled`, `t`.`LockoutEnd`, `t`.`NormalizedEmail`, `t`.`NormalizedUserName`, `t`.`PasswordHash`, `t`.`PhoneNumber`, `t`.`PhoneNumberConfirmed`, `t`.`SecurityStamp`, `t`.`TwoFactorEnabled`, `t`.`UserName`, `t`.`Age`, `t`.`CreateAt`, `t`.`DeletedAt`, `t`.`Gender`, `t`.`ImageId`, `t`.`ImageId1`, `t`.`LastVisit`, `t`.`Name`
FROM `CustomerAddresses` AS `c`
INNER JOIN (
    SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
    FROM `AspNetUsers` AS `a`
    WHERE `a`.`Discriminator` = 'Customer'
) AS `t` ON `c`.`CustomerId` = `t`.`Id`
WHERE (`c`.`Id` = @__addressId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:07.490 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:07.493 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:07.531 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:47:07.537 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 8874.4463ms
2025-09-11 19:47:07.541 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:47:07.544 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 200 1365 application/json; charset=utf-8 9298.7798ms
2025-09-11 19:47:07.704 +03:00 [INF] Received HTTP response headers after 207.3147ms - 201
2025-09-11 19:47:07.725 +03:00 [INF] End processing HTTP request after 234.784ms - 201
2025-09-11 19:47:07.732 +03:00 [INF] Successfully created PayMob order: 384475439 for local order: ORD-20250911164319-5167
2025-09-11 19:47:07.735 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:07.813 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__dto_PaymentMethod_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IntegrationId`
FROM `PaymentMethods` AS `p`
INNER JOIN `PaymentProviders` AS `p0` ON `p`.`PaymentProviderId` = `p0`.`Id`
WHERE ((`p`.`Method` = @__dto_PaymentMethod_0) AND `p`.`IsActive`) AND (`p0`.`Provider` = 1)
LIMIT 1
2025-09-11 19:47:07.821 +03:00 [INF] Using integration ID: 5221967 for payment method: "Visa"
2025-09-11 19:47:07.823 +03:00 [INF] Starting GeneratePaymentKeyAsync for Order ID: 384475439, Amount: 1012226
2025-09-11 19:47:07.826 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:07.830 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:08.049 +03:00 [INF] Received HTTP response headers after 216.9872ms - 201
2025-09-11 19:47:08.059 +03:00 [INF] End processing HTTP request after 233.13ms - 201
2025-09-11 19:47:08.070 +03:00 [INF] Request sent to Paymob payment_keys endpoint
2025-09-11 19:47:08.075 +03:00 [INF] Received response from Paymob payment_keys endpoint
2025-09-11 19:47:08.079 +03:00 [INF] Payment key generated successfully for Order ID: 384475439
2025-09-11 19:47:08.083 +03:00 [INF] Successfully generated payment key for order: ORD-20250911164319-5167
2025-09-11 19:47:08.086 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:08.163 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__paymentProvider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IframeId`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = @__paymentProvider_0
LIMIT 1
2025-09-11 19:47:08.171 +03:00 [INF] Executing CreateAsync for entity Payment
2025-09-11 19:47:08.174 +03:00 [INF] Payment added successfully (pending save)
2025-09-11 19:47:08.176 +03:00 [INF] Execute AddUserOpreationAsync
2025-09-11 19:47:08.179 +03:00 [INF] Executing CreateAsync for entity UserOperationsLog
2025-09-11 19:47:08.182 +03:00 [INF] UserOperationsLog added successfully (pending save)
2025-09-11 19:47:08.336 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime), @p2='?' (Size = 255), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int64), @p10='?' (DbType = Int32), @p11='?' (Size = 100), @p12='?' (DbType = DateTime), @p13='?' (DbType = DateTime), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime), @p17='?' (DbType = Int32), @p18='?' (DbType = DateTime), @p19='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `Payments` (`Amount`, `CreatedAt`, `CustomerId`, `DeletedAt`, `ModifiedAt`, `OrderId`, `PaymentDate`, `PaymentMethodId`, `PaymentProviderId`, `ProviderOrderId`, `Status`, `TransactionId`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
SELECT `Id`, `RowVersion`
FROM `Payments`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `userOperationsLogs` (`CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`, `UserId`)
VALUES (@p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19);
SELECT `Id`
FROM `userOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-09-11 19:47:08.495 +03:00 [INF] Executed DbCommand (8,872ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT Id FROM Orders WHERE Id = @p0 FOR UPDATE
2025-09-11 19:47:08.495 +03:00 [INF] Payment created successfully with ID 23
2025-09-11 19:47:08.519 +03:00 [INF] Execute GetAll for entity Payment
2025-09-11 19:47:08.609 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__order_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Amount`, `p`.`CreatedAt`, `p`.`CustomerId`, `p`.`DeletedAt`, `p`.`ModifiedAt`, `p`.`OrderId`, `p`.`PaymentDate`, `p`.`PaymentMethodId`, `p`.`PaymentProviderId`, `p`.`ProviderOrderId`, `p`.`RowVersion`, `p`.`Status`, `p`.`TransactionId`
FROM `Payments` AS `p`
WHERE (`p`.`OrderId` = @__order_Id_0) AND (`p`.`Status` = 1)
LIMIT 1
2025-09-11 19:47:08.625 +03:00 [INF] Getting payment method ID for enum "Visa"
2025-09-11 19:47:08.630 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:08.709 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__methodEnum_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`
FROM `PaymentMethods` AS `p`
WHERE ((`p`.`Method` = @__methodEnum_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:08.736 +03:00 [INF] Found payment method ID 1 for enum "Visa"
2025-09-11 19:47:08.745 +03:00 [INF] Executing GetByIdAsync for entity PaymentMethod with ID: 1
2025-09-11 19:47:08.822 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IntegrationId`, `p`.`IsActive`, `p`.`Method`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`PaymentProviderId`
FROM `PaymentMethods` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-09-11 19:47:08.839 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:08.919 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`PublicKey`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = 1
LIMIT 1
2025-09-11 19:47:08.935 +03:00 [INF] Executing GetTokenAsync
2025-09-11 19:47:08.940 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:08.946 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:09.170 +03:00 [INF] Received HTTP response headers after 218.6492ms - 201
2025-09-11 19:47:09.178 +03:00 [INF] End processing HTTP request after 237.4052ms - 201
2025-09-11 19:47:09.187 +03:00 [INF] Successfully retrieved PayMob token
2025-09-11 19:47:09.276 +03:00 [INF] Executed DbCommand (84ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-09-11 19:47:09.286 +03:00 [INF] Getting address by ID: 31
2025-09-11 19:47:09.368 +03:00 [INF] Executed DbCommand (80ms) [Parameters=[@__addressId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AdditionalNotes`, `c`.`AddressType`, `c`.`City`, `c`.`Country`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`IsDefault`, `c`.`ModifiedAt`, `c`.`PhoneNumber`, `c`.`PostalCode`, `c`.`State`, `c`.`StreetAddress`, `t`.`Id`, `t`.`AccessFailedCount`, `t`.`ConcurrencyStamp`, `t`.`Discriminator`, `t`.`Email`, `t`.`EmailConfirmed`, `t`.`LockoutEnabled`, `t`.`LockoutEnd`, `t`.`NormalizedEmail`, `t`.`NormalizedUserName`, `t`.`PasswordHash`, `t`.`PhoneNumber`, `t`.`PhoneNumberConfirmed`, `t`.`SecurityStamp`, `t`.`TwoFactorEnabled`, `t`.`UserName`, `t`.`Age`, `t`.`CreateAt`, `t`.`DeletedAt`, `t`.`Gender`, `t`.`ImageId`, `t`.`ImageId1`, `t`.`LastVisit`, `t`.`Name`
FROM `CustomerAddresses` AS `c`
INNER JOIN (
    SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
    FROM `AspNetUsers` AS `a`
    WHERE `a`.`Discriminator` = 'Customer'
) AS `t` ON `c`.`CustomerId` = `t`.`Id`
WHERE (`c`.`Id` = @__addressId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:09.376 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:09.380 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:09.424 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:47:09.429 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 10782.6709ms
2025-09-11 19:47:09.433 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:47:09.435 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 200 1365 application/json; charset=utf-8 11191.4141ms
2025-09-11 19:47:09.589 +03:00 [INF] Received HTTP response headers after 205.7162ms - 201
2025-09-11 19:47:09.600 +03:00 [INF] End processing HTTP request after 223.2978ms - 201
2025-09-11 19:47:09.607 +03:00 [INF] Successfully created PayMob order: 384475460 for local order: ORD-20250911164319-5167
2025-09-11 19:47:09.613 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:09.691 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__dto_PaymentMethod_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IntegrationId`
FROM `PaymentMethods` AS `p`
INNER JOIN `PaymentProviders` AS `p0` ON `p`.`PaymentProviderId` = `p0`.`Id`
WHERE ((`p`.`Method` = @__dto_PaymentMethod_0) AND `p`.`IsActive`) AND (`p0`.`Provider` = 1)
LIMIT 1
2025-09-11 19:47:09.703 +03:00 [INF] Using integration ID: 5221967 for payment method: "Visa"
2025-09-11 19:47:09.709 +03:00 [INF] Starting GeneratePaymentKeyAsync for Order ID: 384475460, Amount: 1012226
2025-09-11 19:47:09.713 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:09.717 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:09.939 +03:00 [INF] Received HTTP response headers after 218.1276ms - 201
2025-09-11 19:47:09.952 +03:00 [INF] End processing HTTP request after 239.2109ms - 201
2025-09-11 19:47:09.964 +03:00 [INF] Request sent to Paymob payment_keys endpoint
2025-09-11 19:47:09.970 +03:00 [INF] Received response from Paymob payment_keys endpoint
2025-09-11 19:47:09.974 +03:00 [INF] Payment key generated successfully for Order ID: 384475460
2025-09-11 19:47:09.978 +03:00 [INF] Successfully generated payment key for order: ORD-20250911164319-5167
2025-09-11 19:47:09.984 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:10.061 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__paymentProvider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IframeId`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = @__paymentProvider_0
LIMIT 1
2025-09-11 19:47:10.069 +03:00 [INF] Executing CreateAsync for entity Payment
2025-09-11 19:47:10.071 +03:00 [INF] Payment added successfully (pending save)
2025-09-11 19:47:10.073 +03:00 [INF] Execute AddUserOpreationAsync
2025-09-11 19:47:10.076 +03:00 [INF] Executing CreateAsync for entity UserOperationsLog
2025-09-11 19:47:10.078 +03:00 [INF] UserOperationsLog added successfully (pending save)
2025-09-11 19:47:10.234 +03:00 [INF] Executed DbCommand (78ms) [Parameters=[@p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime), @p2='?' (Size = 255), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int64), @p10='?' (DbType = Int32), @p11='?' (Size = 100), @p12='?' (DbType = DateTime), @p13='?' (DbType = DateTime), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime), @p17='?' (DbType = Int32), @p18='?' (DbType = DateTime), @p19='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `Payments` (`Amount`, `CreatedAt`, `CustomerId`, `DeletedAt`, `ModifiedAt`, `OrderId`, `PaymentDate`, `PaymentMethodId`, `PaymentProviderId`, `ProviderOrderId`, `Status`, `TransactionId`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
SELECT `Id`, `RowVersion`
FROM `Payments`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `userOperationsLogs` (`CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`, `UserId`)
VALUES (@p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19);
SELECT `Id`
FROM `userOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-09-11 19:47:10.396 +03:00 [INF] Payment created successfully with ID 24
2025-09-11 19:47:10.396 +03:00 [INF] Executed DbCommand (10,766ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT Id FROM Orders WHERE Id = @p0 FOR UPDATE
2025-09-11 19:47:10.420 +03:00 [INF] Execute GetAll for entity Payment
2025-09-11 19:47:10.499 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__order_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Amount`, `p`.`CreatedAt`, `p`.`CustomerId`, `p`.`DeletedAt`, `p`.`ModifiedAt`, `p`.`OrderId`, `p`.`PaymentDate`, `p`.`PaymentMethodId`, `p`.`PaymentProviderId`, `p`.`ProviderOrderId`, `p`.`RowVersion`, `p`.`Status`, `p`.`TransactionId`
FROM `Payments` AS `p`
WHERE (`p`.`OrderId` = @__order_Id_0) AND (`p`.`Status` = 1)
LIMIT 1
2025-09-11 19:47:10.510 +03:00 [INF] Getting payment method ID for enum "Visa"
2025-09-11 19:47:10.513 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:10.607 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__methodEnum_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`
FROM `PaymentMethods` AS `p`
WHERE ((`p`.`Method` = @__methodEnum_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:10.614 +03:00 [INF] Found payment method ID 1 for enum "Visa"
2025-09-11 19:47:10.617 +03:00 [INF] Executing GetByIdAsync for entity PaymentMethod with ID: 1
2025-09-11 19:47:10.692 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IntegrationId`, `p`.`IsActive`, `p`.`Method`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`PaymentProviderId`
FROM `PaymentMethods` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-09-11 19:47:10.698 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:10.772 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`PublicKey`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = 1
LIMIT 1
2025-09-11 19:47:10.782 +03:00 [INF] Executing GetTokenAsync
2025-09-11 19:47:10.784 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:10.787 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:11.013 +03:00 [INF] Received HTTP response headers after 222.8221ms - 201
2025-09-11 19:47:11.024 +03:00 [INF] End processing HTTP request after 239.6136ms - 201
2025-09-11 19:47:11.040 +03:00 [INF] Successfully retrieved PayMob token
2025-09-11 19:47:11.123 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-09-11 19:47:11.136 +03:00 [INF] Getting address by ID: 31
2025-09-11 19:47:11.219 +03:00 [INF] Executed DbCommand (79ms) [Parameters=[@__addressId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AdditionalNotes`, `c`.`AddressType`, `c`.`City`, `c`.`Country`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`IsDefault`, `c`.`ModifiedAt`, `c`.`PhoneNumber`, `c`.`PostalCode`, `c`.`State`, `c`.`StreetAddress`, `t`.`Id`, `t`.`AccessFailedCount`, `t`.`ConcurrencyStamp`, `t`.`Discriminator`, `t`.`Email`, `t`.`EmailConfirmed`, `t`.`LockoutEnabled`, `t`.`LockoutEnd`, `t`.`NormalizedEmail`, `t`.`NormalizedUserName`, `t`.`PasswordHash`, `t`.`PhoneNumber`, `t`.`PhoneNumberConfirmed`, `t`.`SecurityStamp`, `t`.`TwoFactorEnabled`, `t`.`UserName`, `t`.`Age`, `t`.`CreateAt`, `t`.`DeletedAt`, `t`.`Gender`, `t`.`ImageId`, `t`.`ImageId1`, `t`.`LastVisit`, `t`.`Name`
FROM `CustomerAddresses` AS `c`
INNER JOIN (
    SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
    FROM `AspNetUsers` AS `a`
    WHERE `a`.`Discriminator` = 'Customer'
) AS `t` ON `c`.`CustomerId` = `t`.`Id`
WHERE (`c`.`Id` = @__addressId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:11.232 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:11.237 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:11.284 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:47:11.292 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 12425.6598ms
2025-09-11 19:47:11.297 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:47:11.303 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 200 1365 application/json; charset=utf-8 12931.0473ms
2025-09-11 19:47:11.448 +03:00 [INF] Received HTTP response headers after 207.6646ms - 201
2025-09-11 19:47:11.460 +03:00 [INF] End processing HTTP request after 228.3949ms - 201
2025-09-11 19:47:11.475 +03:00 [INF] Successfully created PayMob order: 384475480 for local order: ORD-20250911164319-5167
2025-09-11 19:47:11.487 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:11.571 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__dto_PaymentMethod_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IntegrationId`
FROM `PaymentMethods` AS `p`
INNER JOIN `PaymentProviders` AS `p0` ON `p`.`PaymentProviderId` = `p0`.`Id`
WHERE ((`p`.`Method` = @__dto_PaymentMethod_0) AND `p`.`IsActive`) AND (`p0`.`Provider` = 1)
LIMIT 1
2025-09-11 19:47:11.584 +03:00 [INF] Using integration ID: 5221967 for payment method: "Visa"
2025-09-11 19:47:11.592 +03:00 [INF] Starting GeneratePaymentKeyAsync for Order ID: 384475480, Amount: 1012226
2025-09-11 19:47:11.599 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:11.606 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:11.839 +03:00 [INF] Received HTTP response headers after 228.314ms - 201
2025-09-11 19:47:11.864 +03:00 [INF] End processing HTTP request after 264.4192ms - 201
2025-09-11 19:47:11.874 +03:00 [INF] Request sent to Paymob payment_keys endpoint
2025-09-11 19:47:11.881 +03:00 [INF] Received response from Paymob payment_keys endpoint
2025-09-11 19:47:11.885 +03:00 [INF] Payment key generated successfully for Order ID: 384475480
2025-09-11 19:47:11.887 +03:00 [INF] Successfully generated payment key for order: ORD-20250911164319-5167
2025-09-11 19:47:11.890 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:11.965 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__paymentProvider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IframeId`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = @__paymentProvider_0
LIMIT 1
2025-09-11 19:47:11.973 +03:00 [INF] Executing CreateAsync for entity Payment
2025-09-11 19:47:11.975 +03:00 [INF] Payment added successfully (pending save)
2025-09-11 19:47:11.976 +03:00 [INF] Execute AddUserOpreationAsync
2025-09-11 19:47:11.981 +03:00 [INF] Executing CreateAsync for entity UserOperationsLog
2025-09-11 19:47:11.984 +03:00 [INF] UserOperationsLog added successfully (pending save)
2025-09-11 19:47:12.135 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime), @p2='?' (Size = 255), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int64), @p10='?' (DbType = Int32), @p11='?' (Size = 100), @p12='?' (DbType = DateTime), @p13='?' (DbType = DateTime), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime), @p17='?' (DbType = Int32), @p18='?' (DbType = DateTime), @p19='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `Payments` (`Amount`, `CreatedAt`, `CustomerId`, `DeletedAt`, `ModifiedAt`, `OrderId`, `PaymentDate`, `PaymentMethodId`, `PaymentProviderId`, `ProviderOrderId`, `Status`, `TransactionId`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
SELECT `Id`, `RowVersion`
FROM `Payments`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `userOperationsLogs` (`CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`, `UserId`)
VALUES (@p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19);
SELECT `Id`
FROM `userOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-09-11 19:47:12.286 +03:00 [INF] Payment created successfully with ID 25
2025-09-11 19:47:12.286 +03:00 [INF] Executed DbCommand (12,651ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT Id FROM Orders WHERE Id = @p0 FOR UPDATE
2025-09-11 19:47:12.296 +03:00 [INF] Execute GetAll for entity Payment
2025-09-11 19:47:12.372 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__order_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Amount`, `p`.`CreatedAt`, `p`.`CustomerId`, `p`.`DeletedAt`, `p`.`ModifiedAt`, `p`.`OrderId`, `p`.`PaymentDate`, `p`.`PaymentMethodId`, `p`.`PaymentProviderId`, `p`.`ProviderOrderId`, `p`.`RowVersion`, `p`.`Status`, `p`.`TransactionId`
FROM `Payments` AS `p`
WHERE (`p`.`OrderId` = @__order_Id_0) AND (`p`.`Status` = 1)
LIMIT 1
2025-09-11 19:47:12.382 +03:00 [INF] Getting payment method ID for enum "Visa"
2025-09-11 19:47:12.385 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:12.461 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__methodEnum_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`
FROM `PaymentMethods` AS `p`
WHERE ((`p`.`Method` = @__methodEnum_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:12.473 +03:00 [INF] Found payment method ID 1 for enum "Visa"
2025-09-11 19:47:12.476 +03:00 [INF] Executing GetByIdAsync for entity PaymentMethod with ID: 1
2025-09-11 19:47:12.552 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IntegrationId`, `p`.`IsActive`, `p`.`Method`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`PaymentProviderId`
FROM `PaymentMethods` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-09-11 19:47:12.562 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:12.650 +03:00 [INF] Executed DbCommand (84ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`PublicKey`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = 1
LIMIT 1
2025-09-11 19:47:12.659 +03:00 [INF] Executing GetTokenAsync
2025-09-11 19:47:12.661 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:12.664 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:12.883 +03:00 [INF] Received HTTP response headers after 216.7002ms - 201
2025-09-11 19:47:12.891 +03:00 [INF] End processing HTTP request after 229.5774ms - 201
2025-09-11 19:47:12.897 +03:00 [INF] Successfully retrieved PayMob token
2025-09-11 19:47:12.977 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-09-11 19:47:12.992 +03:00 [INF] Getting address by ID: 31
2025-09-11 19:47:13.076 +03:00 [INF] Executed DbCommand (80ms) [Parameters=[@__addressId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AdditionalNotes`, `c`.`AddressType`, `c`.`City`, `c`.`Country`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`IsDefault`, `c`.`ModifiedAt`, `c`.`PhoneNumber`, `c`.`PostalCode`, `c`.`State`, `c`.`StreetAddress`, `t`.`Id`, `t`.`AccessFailedCount`, `t`.`ConcurrencyStamp`, `t`.`Discriminator`, `t`.`Email`, `t`.`EmailConfirmed`, `t`.`LockoutEnabled`, `t`.`LockoutEnd`, `t`.`NormalizedEmail`, `t`.`NormalizedUserName`, `t`.`PasswordHash`, `t`.`PhoneNumber`, `t`.`PhoneNumberConfirmed`, `t`.`SecurityStamp`, `t`.`TwoFactorEnabled`, `t`.`UserName`, `t`.`Age`, `t`.`CreateAt`, `t`.`DeletedAt`, `t`.`Gender`, `t`.`ImageId`, `t`.`ImageId1`, `t`.`LastVisit`, `t`.`Name`
FROM `CustomerAddresses` AS `c`
INNER JOIN (
    SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
    FROM `AspNetUsers` AS `a`
    WHERE `a`.`Discriminator` = 'Customer'
) AS `t` ON `c`.`CustomerId` = `t`.`Id`
WHERE (`c`.`Id` = @__addressId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:13.093 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:13.103 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:13.176 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:47:13.206 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 14319.8274ms
2025-09-11 19:47:13.210 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:47:13.216 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 200 1365 application/json; charset=utf-8 14842.2382ms
2025-09-11 19:47:13.331 +03:00 [INF] Received HTTP response headers after 219.7111ms - 201
2025-09-11 19:47:13.339 +03:00 [INF] End processing HTTP request after 245.4351ms - 201
2025-09-11 19:47:13.348 +03:00 [INF] Successfully created PayMob order: 384475502 for local order: ORD-20250911164319-5167
2025-09-11 19:47:13.352 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:13.447 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__dto_PaymentMethod_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IntegrationId`
FROM `PaymentMethods` AS `p`
INNER JOIN `PaymentProviders` AS `p0` ON `p`.`PaymentProviderId` = `p0`.`Id`
WHERE ((`p`.`Method` = @__dto_PaymentMethod_0) AND `p`.`IsActive`) AND (`p0`.`Provider` = 1)
LIMIT 1
2025-09-11 19:47:13.468 +03:00 [INF] Using integration ID: 5221967 for payment method: "Visa"
2025-09-11 19:47:13.470 +03:00 [INF] Starting GeneratePaymentKeyAsync for Order ID: 384475502, Amount: 1012226
2025-09-11 19:47:13.473 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:13.476 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:13.705 +03:00 [INF] Received HTTP response headers after 225.4063ms - 201
2025-09-11 19:47:13.708 +03:00 [INF] End processing HTTP request after 234.5353ms - 201
2025-09-11 19:47:13.711 +03:00 [INF] Request sent to Paymob payment_keys endpoint
2025-09-11 19:47:13.713 +03:00 [INF] Received response from Paymob payment_keys endpoint
2025-09-11 19:47:13.715 +03:00 [INF] Payment key generated successfully for Order ID: 384475502
2025-09-11 19:47:13.718 +03:00 [INF] Successfully generated payment key for order: ORD-20250911164319-5167
2025-09-11 19:47:13.720 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:13.795 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__paymentProvider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IframeId`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = @__paymentProvider_0
LIMIT 1
2025-09-11 19:47:13.812 +03:00 [INF] Executing CreateAsync for entity Payment
2025-09-11 19:47:13.815 +03:00 [INF] Payment added successfully (pending save)
2025-09-11 19:47:13.817 +03:00 [INF] Execute AddUserOpreationAsync
2025-09-11 19:47:13.819 +03:00 [INF] Executing CreateAsync for entity UserOperationsLog
2025-09-11 19:47:13.821 +03:00 [INF] UserOperationsLog added successfully (pending save)
2025-09-11 19:47:13.972 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime), @p2='?' (Size = 255), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int64), @p10='?' (DbType = Int32), @p11='?' (Size = 100), @p12='?' (DbType = DateTime), @p13='?' (DbType = DateTime), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime), @p17='?' (DbType = Int32), @p18='?' (DbType = DateTime), @p19='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `Payments` (`Amount`, `CreatedAt`, `CustomerId`, `DeletedAt`, `ModifiedAt`, `OrderId`, `PaymentDate`, `PaymentMethodId`, `PaymentProviderId`, `ProviderOrderId`, `Status`, `TransactionId`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
SELECT `Id`, `RowVersion`
FROM `Payments`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `userOperationsLogs` (`CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`, `UserId`)
VALUES (@p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19);
SELECT `Id`
FROM `userOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-09-11 19:47:14.129 +03:00 [INF] Payment created successfully with ID 26
2025-09-11 19:47:14.129 +03:00 [INF] Executed DbCommand (14,490ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT Id FROM Orders WHERE Id = @p0 FOR UPDATE
2025-09-11 19:47:14.158 +03:00 [INF] Execute GetAll for entity Payment
2025-09-11 19:47:14.239 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__order_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Amount`, `p`.`CreatedAt`, `p`.`CustomerId`, `p`.`DeletedAt`, `p`.`ModifiedAt`, `p`.`OrderId`, `p`.`PaymentDate`, `p`.`PaymentMethodId`, `p`.`PaymentProviderId`, `p`.`ProviderOrderId`, `p`.`RowVersion`, `p`.`Status`, `p`.`TransactionId`
FROM `Payments` AS `p`
WHERE (`p`.`OrderId` = @__order_Id_0) AND (`p`.`Status` = 1)
LIMIT 1
2025-09-11 19:47:14.249 +03:00 [INF] Getting payment method ID for enum "Visa"
2025-09-11 19:47:14.254 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:14.331 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__methodEnum_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`
FROM `PaymentMethods` AS `p`
WHERE ((`p`.`Method` = @__methodEnum_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:14.342 +03:00 [INF] Found payment method ID 1 for enum "Visa"
2025-09-11 19:47:14.348 +03:00 [INF] Executing GetByIdAsync for entity PaymentMethod with ID: 1
2025-09-11 19:47:14.426 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IntegrationId`, `p`.`IsActive`, `p`.`Method`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`PaymentProviderId`
FROM `PaymentMethods` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-09-11 19:47:14.440 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:14.518 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`PublicKey`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = 1
LIMIT 1
2025-09-11 19:47:14.534 +03:00 [INF] Executing GetTokenAsync
2025-09-11 19:47:14.539 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:14.548 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:14.769 +03:00 [INF] Received HTTP response headers after 215.1934ms - 201
2025-09-11 19:47:14.773 +03:00 [INF] End processing HTTP request after 233.5824ms - 201
2025-09-11 19:47:14.787 +03:00 [INF] Successfully retrieved PayMob token
2025-09-11 19:47:14.869 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-09-11 19:47:14.881 +03:00 [INF] Getting address by ID: 31
2025-09-11 19:47:14.966 +03:00 [INF] Executed DbCommand (80ms) [Parameters=[@__addressId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AdditionalNotes`, `c`.`AddressType`, `c`.`City`, `c`.`Country`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`IsDefault`, `c`.`ModifiedAt`, `c`.`PhoneNumber`, `c`.`PostalCode`, `c`.`State`, `c`.`StreetAddress`, `t`.`Id`, `t`.`AccessFailedCount`, `t`.`ConcurrencyStamp`, `t`.`Discriminator`, `t`.`Email`, `t`.`EmailConfirmed`, `t`.`LockoutEnabled`, `t`.`LockoutEnd`, `t`.`NormalizedEmail`, `t`.`NormalizedUserName`, `t`.`PasswordHash`, `t`.`PhoneNumber`, `t`.`PhoneNumberConfirmed`, `t`.`SecurityStamp`, `t`.`TwoFactorEnabled`, `t`.`UserName`, `t`.`Age`, `t`.`CreateAt`, `t`.`DeletedAt`, `t`.`Gender`, `t`.`ImageId`, `t`.`ImageId1`, `t`.`LastVisit`, `t`.`Name`
FROM `CustomerAddresses` AS `c`
INNER JOIN (
    SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
    FROM `AspNetUsers` AS `a`
    WHERE `a`.`Discriminator` = 'Customer'
) AS `t` ON `c`.`CustomerId` = `t`.`Id`
WHERE (`c`.`Id` = @__addressId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:14.974 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:14.986 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:15.026 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:47:15.031 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 16157.431ms
2025-09-11 19:47:15.035 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:47:15.037 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 200 1365 application/json; charset=utf-8 16661.0922ms
2025-09-11 19:47:15.198 +03:00 [INF] Received HTTP response headers after 209.3407ms - 201
2025-09-11 19:47:15.206 +03:00 [INF] End processing HTTP request after 231.8403ms - 201
2025-09-11 19:47:15.211 +03:00 [INF] Successfully created PayMob order: 384475530 for local order: ORD-20250911164319-5167
2025-09-11 19:47:15.215 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:15.291 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__dto_PaymentMethod_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IntegrationId`
FROM `PaymentMethods` AS `p`
INNER JOIN `PaymentProviders` AS `p0` ON `p`.`PaymentProviderId` = `p0`.`Id`
WHERE ((`p`.`Method` = @__dto_PaymentMethod_0) AND `p`.`IsActive`) AND (`p0`.`Provider` = 1)
LIMIT 1
2025-09-11 19:47:15.302 +03:00 [INF] Using integration ID: 5221967 for payment method: "Visa"
2025-09-11 19:47:15.305 +03:00 [INF] Starting GeneratePaymentKeyAsync for Order ID: 384475530, Amount: 1012226
2025-09-11 19:47:15.308 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:15.312 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:15.530 +03:00 [INF] Received HTTP response headers after 213.8335ms - 201
2025-09-11 19:47:15.541 +03:00 [INF] End processing HTTP request after 233.5936ms - 201
2025-09-11 19:47:15.553 +03:00 [INF] Request sent to Paymob payment_keys endpoint
2025-09-11 19:47:15.571 +03:00 [INF] Received response from Paymob payment_keys endpoint
2025-09-11 19:47:15.581 +03:00 [INF] Payment key generated successfully for Order ID: 384475530
2025-09-11 19:47:15.585 +03:00 [INF] Successfully generated payment key for order: ORD-20250911164319-5167
2025-09-11 19:47:15.588 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:15.668 +03:00 [INF] Executed DbCommand (72ms) [Parameters=[@__paymentProvider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IframeId`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = @__paymentProvider_0
LIMIT 1
2025-09-11 19:47:15.675 +03:00 [INF] Executing CreateAsync for entity Payment
2025-09-11 19:47:15.677 +03:00 [INF] Payment added successfully (pending save)
2025-09-11 19:47:15.678 +03:00 [INF] Execute AddUserOpreationAsync
2025-09-11 19:47:15.680 +03:00 [INF] Executing CreateAsync for entity UserOperationsLog
2025-09-11 19:47:15.683 +03:00 [INF] UserOperationsLog added successfully (pending save)
2025-09-11 19:47:15.834 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime), @p2='?' (Size = 255), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int64), @p10='?' (DbType = Int32), @p11='?' (Size = 100), @p12='?' (DbType = DateTime), @p13='?' (DbType = DateTime), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime), @p17='?' (DbType = Int32), @p18='?' (DbType = DateTime), @p19='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `Payments` (`Amount`, `CreatedAt`, `CustomerId`, `DeletedAt`, `ModifiedAt`, `OrderId`, `PaymentDate`, `PaymentMethodId`, `PaymentProviderId`, `ProviderOrderId`, `Status`, `TransactionId`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
SELECT `Id`, `RowVersion`
FROM `Payments`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `userOperationsLogs` (`CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`, `UserId`)
VALUES (@p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19);
SELECT `Id`
FROM `userOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-09-11 19:47:15.989 +03:00 [INF] Executed DbCommand (16,285ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT Id FROM Orders WHERE Id = @p0 FOR UPDATE
2025-09-11 19:47:15.989 +03:00 [INF] Payment created successfully with ID 27
2025-09-11 19:47:16.001 +03:00 [INF] Execute GetAll for entity Payment
2025-09-11 19:47:16.080 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__order_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Amount`, `p`.`CreatedAt`, `p`.`CustomerId`, `p`.`DeletedAt`, `p`.`ModifiedAt`, `p`.`OrderId`, `p`.`PaymentDate`, `p`.`PaymentMethodId`, `p`.`PaymentProviderId`, `p`.`ProviderOrderId`, `p`.`RowVersion`, `p`.`Status`, `p`.`TransactionId`
FROM `Payments` AS `p`
WHERE (`p`.`OrderId` = @__order_Id_0) AND (`p`.`Status` = 1)
LIMIT 1
2025-09-11 19:47:16.089 +03:00 [INF] Getting payment method ID for enum "Visa"
2025-09-11 19:47:16.091 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:16.167 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__methodEnum_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`
FROM `PaymentMethods` AS `p`
WHERE ((`p`.`Method` = @__methodEnum_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:16.176 +03:00 [INF] Found payment method ID 1 for enum "Visa"
2025-09-11 19:47:16.182 +03:00 [INF] Executing GetByIdAsync for entity PaymentMethod with ID: 1
2025-09-11 19:47:16.260 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IntegrationId`, `p`.`IsActive`, `p`.`Method`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`PaymentProviderId`
FROM `PaymentMethods` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-09-11 19:47:16.273 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:16.349 +03:00 [INF] Executed DbCommand (72ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`PublicKey`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = 1
LIMIT 1
2025-09-11 19:47:16.355 +03:00 [INF] Executing GetTokenAsync
2025-09-11 19:47:16.357 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:16.360 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:16.578 +03:00 [INF] Received HTTP response headers after 214.6849ms - 201
2025-09-11 19:47:16.584 +03:00 [INF] End processing HTTP request after 226.8013ms - 201
2025-09-11 19:47:16.587 +03:00 [INF] Successfully retrieved PayMob token
2025-09-11 19:47:16.669 +03:00 [INF] Executed DbCommand (80ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-09-11 19:47:16.677 +03:00 [INF] Getting address by ID: 31
2025-09-11 19:47:16.761 +03:00 [INF] Executed DbCommand (82ms) [Parameters=[@__addressId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AdditionalNotes`, `c`.`AddressType`, `c`.`City`, `c`.`Country`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`IsDefault`, `c`.`ModifiedAt`, `c`.`PhoneNumber`, `c`.`PostalCode`, `c`.`State`, `c`.`StreetAddress`, `t`.`Id`, `t`.`AccessFailedCount`, `t`.`ConcurrencyStamp`, `t`.`Discriminator`, `t`.`Email`, `t`.`EmailConfirmed`, `t`.`LockoutEnabled`, `t`.`LockoutEnd`, `t`.`NormalizedEmail`, `t`.`NormalizedUserName`, `t`.`PasswordHash`, `t`.`PhoneNumber`, `t`.`PhoneNumberConfirmed`, `t`.`SecurityStamp`, `t`.`TwoFactorEnabled`, `t`.`UserName`, `t`.`Age`, `t`.`CreateAt`, `t`.`DeletedAt`, `t`.`Gender`, `t`.`ImageId`, `t`.`ImageId1`, `t`.`LastVisit`, `t`.`Name`
FROM `CustomerAddresses` AS `c`
INNER JOIN (
    SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
    FROM `AspNetUsers` AS `a`
    WHERE `a`.`Discriminator` = 'Customer'
) AS `t` ON `c`.`CustomerId` = `t`.`Id`
WHERE (`c`.`Id` = @__addressId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:16.772 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:16.775 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:16.907 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:47:16.921 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 17805.2508ms
2025-09-11 19:47:16.930 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:47:16.937 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 200 1365 application/json; charset=utf-8 18558.09ms
2025-09-11 19:47:16.995 +03:00 [INF] Received HTTP response headers after 217.7777ms - 201
2025-09-11 19:47:17.001 +03:00 [INF] End processing HTTP request after 228.5336ms - 201
2025-09-11 19:47:17.004 +03:00 [INF] Successfully created PayMob order: 384475543 for local order: ORD-20250911164319-5167
2025-09-11 19:47:17.007 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:17.089 +03:00 [INF] Executed DbCommand (80ms) [Parameters=[@__dto_PaymentMethod_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IntegrationId`
FROM `PaymentMethods` AS `p`
INNER JOIN `PaymentProviders` AS `p0` ON `p`.`PaymentProviderId` = `p0`.`Id`
WHERE ((`p`.`Method` = @__dto_PaymentMethod_0) AND `p`.`IsActive`) AND (`p0`.`Provider` = 1)
LIMIT 1
2025-09-11 19:47:17.097 +03:00 [INF] Using integration ID: 5221967 for payment method: "Visa"
2025-09-11 19:47:17.101 +03:00 [INF] Starting GeneratePaymentKeyAsync for Order ID: 384475543, Amount: 1012226
2025-09-11 19:47:17.103 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:17.106 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:17.328 +03:00 [INF] Received HTTP response headers after 219.1096ms - 201
2025-09-11 19:47:17.342 +03:00 [INF] End processing HTTP request after 239.456ms - 201
2025-09-11 19:47:17.350 +03:00 [INF] Request sent to Paymob payment_keys endpoint
2025-09-11 19:47:17.354 +03:00 [INF] Received response from Paymob payment_keys endpoint
2025-09-11 19:47:17.357 +03:00 [INF] Payment key generated successfully for Order ID: 384475543
2025-09-11 19:47:17.361 +03:00 [INF] Successfully generated payment key for order: ORD-20250911164319-5167
2025-09-11 19:47:17.365 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:17.441 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__paymentProvider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IframeId`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = @__paymentProvider_0
LIMIT 1
2025-09-11 19:47:17.448 +03:00 [INF] Executing CreateAsync for entity Payment
2025-09-11 19:47:17.451 +03:00 [INF] Payment added successfully (pending save)
2025-09-11 19:47:17.452 +03:00 [INF] Execute AddUserOpreationAsync
2025-09-11 19:47:17.454 +03:00 [INF] Executing CreateAsync for entity UserOperationsLog
2025-09-11 19:47:17.456 +03:00 [INF] UserOperationsLog added successfully (pending save)
2025-09-11 19:47:17.613 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime), @p2='?' (Size = 255), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int64), @p10='?' (DbType = Int32), @p11='?' (Size = 100), @p12='?' (DbType = DateTime), @p13='?' (DbType = DateTime), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime), @p17='?' (DbType = Int32), @p18='?' (DbType = DateTime), @p19='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `Payments` (`Amount`, `CreatedAt`, `CustomerId`, `DeletedAt`, `ModifiedAt`, `OrderId`, `PaymentDate`, `PaymentMethodId`, `PaymentProviderId`, `ProviderOrderId`, `Status`, `TransactionId`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
SELECT `Id`, `RowVersion`
FROM `Payments`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `userOperationsLogs` (`CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`, `UserId`)
VALUES (@p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19);
SELECT `Id`
FROM `userOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-09-11 19:47:17.772 +03:00 [INF] Payment created successfully with ID 28
2025-09-11 19:47:17.774 +03:00 [INF] Executed DbCommand (18,065ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT Id FROM Orders WHERE Id = @p0 FOR UPDATE
2025-09-11 19:47:17.781 +03:00 [INF] Execute GetAll for entity Payment
2025-09-11 19:47:17.857 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__order_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Amount`, `p`.`CreatedAt`, `p`.`CustomerId`, `p`.`DeletedAt`, `p`.`ModifiedAt`, `p`.`OrderId`, `p`.`PaymentDate`, `p`.`PaymentMethodId`, `p`.`PaymentProviderId`, `p`.`ProviderOrderId`, `p`.`RowVersion`, `p`.`Status`, `p`.`TransactionId`
FROM `Payments` AS `p`
WHERE (`p`.`OrderId` = @__order_Id_0) AND (`p`.`Status` = 1)
LIMIT 1
2025-09-11 19:47:17.865 +03:00 [INF] Getting payment method ID for enum "Visa"
2025-09-11 19:47:17.868 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:17.944 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__methodEnum_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`
FROM `PaymentMethods` AS `p`
WHERE ((`p`.`Method` = @__methodEnum_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:17.951 +03:00 [INF] Found payment method ID 1 for enum "Visa"
2025-09-11 19:47:17.953 +03:00 [INF] Executing GetByIdAsync for entity PaymentMethod with ID: 1
2025-09-11 19:47:18.029 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IntegrationId`, `p`.`IsActive`, `p`.`Method`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`PaymentProviderId`
FROM `PaymentMethods` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-09-11 19:47:18.037 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:18.113 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`PublicKey`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = 1
LIMIT 1
2025-09-11 19:47:18.126 +03:00 [INF] Executing GetTokenAsync
2025-09-11 19:47:18.128 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:18.130 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:18.374 +03:00 [INF] Received HTTP response headers after 240.7028ms - 201
2025-09-11 19:47:18.382 +03:00 [INF] End processing HTTP request after 254.0564ms - 201
2025-09-11 19:47:18.390 +03:00 [INF] Successfully retrieved PayMob token
2025-09-11 19:47:18.484 +03:00 [INF] Executed DbCommand (89ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-09-11 19:47:18.508 +03:00 [INF] Getting address by ID: 31
2025-09-11 19:47:18.597 +03:00 [INF] Executed DbCommand (82ms) [Parameters=[@__addressId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AdditionalNotes`, `c`.`AddressType`, `c`.`City`, `c`.`Country`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`IsDefault`, `c`.`ModifiedAt`, `c`.`PhoneNumber`, `c`.`PostalCode`, `c`.`State`, `c`.`StreetAddress`, `t`.`Id`, `t`.`AccessFailedCount`, `t`.`ConcurrencyStamp`, `t`.`Discriminator`, `t`.`Email`, `t`.`EmailConfirmed`, `t`.`LockoutEnabled`, `t`.`LockoutEnd`, `t`.`NormalizedEmail`, `t`.`NormalizedUserName`, `t`.`PasswordHash`, `t`.`PhoneNumber`, `t`.`PhoneNumberConfirmed`, `t`.`SecurityStamp`, `t`.`TwoFactorEnabled`, `t`.`UserName`, `t`.`Age`, `t`.`CreateAt`, `t`.`DeletedAt`, `t`.`Gender`, `t`.`ImageId`, `t`.`ImageId1`, `t`.`LastVisit`, `t`.`Name`
FROM `CustomerAddresses` AS `c`
INNER JOIN (
    SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
    FROM `AspNetUsers` AS `a`
    WHERE `a`.`Discriminator` = 'Customer'
) AS `t` ON `c`.`CustomerId` = `t`.`Id`
WHERE (`c`.`Id` = @__addressId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:18.634 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:18.641 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:18.671 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:47:18.679 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 19540.5332ms
2025-09-11 19:47:18.687 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:47:18.691 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 200 1365 application/json; charset=utf-8 20282.6514ms
2025-09-11 19:47:18.853 +03:00 [INF] Received HTTP response headers after 207.1523ms - 201
2025-09-11 19:47:18.873 +03:00 [INF] End processing HTTP request after 238.9484ms - 201
2025-09-11 19:47:18.880 +03:00 [INF] Successfully created PayMob order: 384475560 for local order: ORD-20250911164319-5167
2025-09-11 19:47:18.886 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:18.966 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__dto_PaymentMethod_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IntegrationId`
FROM `PaymentMethods` AS `p`
INNER JOIN `PaymentProviders` AS `p0` ON `p`.`PaymentProviderId` = `p0`.`Id`
WHERE ((`p`.`Method` = @__dto_PaymentMethod_0) AND `p`.`IsActive`) AND (`p0`.`Provider` = 1)
LIMIT 1
2025-09-11 19:47:18.981 +03:00 [INF] Using integration ID: 5221967 for payment method: "Visa"
2025-09-11 19:47:18.988 +03:00 [INF] Starting GeneratePaymentKeyAsync for Order ID: 384475560, Amount: 1012226
2025-09-11 19:47:18.992 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:18.997 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:19.239 +03:00 [INF] Received HTTP response headers after 237.1811ms - 201
2025-09-11 19:47:19.250 +03:00 [INF] End processing HTTP request after 257.9303ms - 201
2025-09-11 19:47:19.254 +03:00 [INF] Request sent to Paymob payment_keys endpoint
2025-09-11 19:47:19.256 +03:00 [INF] Received response from Paymob payment_keys endpoint
2025-09-11 19:47:19.258 +03:00 [INF] Payment key generated successfully for Order ID: 384475560
2025-09-11 19:47:19.262 +03:00 [INF] Successfully generated payment key for order: ORD-20250911164319-5167
2025-09-11 19:47:19.265 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:19.341 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__paymentProvider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IframeId`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = @__paymentProvider_0
LIMIT 1
2025-09-11 19:47:19.350 +03:00 [INF] Executing CreateAsync for entity Payment
2025-09-11 19:47:19.352 +03:00 [INF] Payment added successfully (pending save)
2025-09-11 19:47:19.359 +03:00 [INF] Execute AddUserOpreationAsync
2025-09-11 19:47:19.362 +03:00 [INF] Executing CreateAsync for entity UserOperationsLog
2025-09-11 19:47:19.366 +03:00 [INF] UserOperationsLog added successfully (pending save)
2025-09-11 19:47:19.522 +03:00 [INF] Executed DbCommand (78ms) [Parameters=[@p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime), @p2='?' (Size = 255), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int64), @p10='?' (DbType = Int32), @p11='?' (Size = 100), @p12='?' (DbType = DateTime), @p13='?' (DbType = DateTime), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime), @p17='?' (DbType = Int32), @p18='?' (DbType = DateTime), @p19='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `Payments` (`Amount`, `CreatedAt`, `CustomerId`, `DeletedAt`, `ModifiedAt`, `OrderId`, `PaymentDate`, `PaymentMethodId`, `PaymentProviderId`, `ProviderOrderId`, `Status`, `TransactionId`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
SELECT `Id`, `RowVersion`
FROM `Payments`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `userOperationsLogs` (`CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`, `UserId`)
VALUES (@p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19);
SELECT `Id`
FROM `userOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-09-11 19:47:19.681 +03:00 [INF] Executed DbCommand (19,968ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT Id FROM Orders WHERE Id = @p0 FOR UPDATE
2025-09-11 19:47:19.681 +03:00 [INF] Payment created successfully with ID 29
2025-09-11 19:47:19.693 +03:00 [INF] Execute GetAll for entity Payment
2025-09-11 19:47:19.777 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__order_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Amount`, `p`.`CreatedAt`, `p`.`CustomerId`, `p`.`DeletedAt`, `p`.`ModifiedAt`, `p`.`OrderId`, `p`.`PaymentDate`, `p`.`PaymentMethodId`, `p`.`PaymentProviderId`, `p`.`ProviderOrderId`, `p`.`RowVersion`, `p`.`Status`, `p`.`TransactionId`
FROM `Payments` AS `p`
WHERE (`p`.`OrderId` = @__order_Id_0) AND (`p`.`Status` = 1)
LIMIT 1
2025-09-11 19:47:19.802 +03:00 [INF] Getting payment method ID for enum "Visa"
2025-09-11 19:47:19.810 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:19.890 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__methodEnum_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`
FROM `PaymentMethods` AS `p`
WHERE ((`p`.`Method` = @__methodEnum_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:19.911 +03:00 [INF] Found payment method ID 1 for enum "Visa"
2025-09-11 19:47:19.919 +03:00 [INF] Executing GetByIdAsync for entity PaymentMethod with ID: 1
2025-09-11 19:47:19.999 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IntegrationId`, `p`.`IsActive`, `p`.`Method`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`PaymentProviderId`
FROM `PaymentMethods` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-09-11 19:47:20.008 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:20.085 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`PublicKey`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = 1
LIMIT 1
2025-09-11 19:47:20.095 +03:00 [INF] Executing GetTokenAsync
2025-09-11 19:47:20.099 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:20.103 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:20.324 +03:00 [INF] Received HTTP response headers after 217.6774ms - 201
2025-09-11 19:47:20.329 +03:00 [INF] End processing HTTP request after 229.9296ms - 201
2025-09-11 19:47:20.332 +03:00 [INF] Successfully retrieved PayMob token
2025-09-11 19:47:20.416 +03:00 [INF] Executed DbCommand (82ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-09-11 19:47:20.426 +03:00 [INF] Getting address by ID: 31
2025-09-11 19:47:20.509 +03:00 [INF] Executed DbCommand (80ms) [Parameters=[@__addressId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AdditionalNotes`, `c`.`AddressType`, `c`.`City`, `c`.`Country`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`IsDefault`, `c`.`ModifiedAt`, `c`.`PhoneNumber`, `c`.`PostalCode`, `c`.`State`, `c`.`StreetAddress`, `t`.`Id`, `t`.`AccessFailedCount`, `t`.`ConcurrencyStamp`, `t`.`Discriminator`, `t`.`Email`, `t`.`EmailConfirmed`, `t`.`LockoutEnabled`, `t`.`LockoutEnd`, `t`.`NormalizedEmail`, `t`.`NormalizedUserName`, `t`.`PasswordHash`, `t`.`PhoneNumber`, `t`.`PhoneNumberConfirmed`, `t`.`SecurityStamp`, `t`.`TwoFactorEnabled`, `t`.`UserName`, `t`.`Age`, `t`.`CreateAt`, `t`.`DeletedAt`, `t`.`Gender`, `t`.`ImageId`, `t`.`ImageId1`, `t`.`LastVisit`, `t`.`Name`
FROM `CustomerAddresses` AS `c`
INNER JOIN (
    SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
    FROM `AspNetUsers` AS `a`
    WHERE `a`.`Discriminator` = 'Customer'
) AS `t` ON `c`.`CustomerId` = `t`.`Id`
WHERE (`c`.`Id` = @__addressId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:20.517 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:20.519 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:20.589 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:47:20.592 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 21473.0759ms
2025-09-11 19:47:20.597 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:47:20.600 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 200 1365 application/json; charset=utf-8 22194.7896ms
2025-09-11 19:47:20.727 +03:00 [INF] Received HTTP response headers after 205.656ms - 201
2025-09-11 19:47:20.732 +03:00 [INF] End processing HTTP request after 215.0587ms - 201
2025-09-11 19:47:20.735 +03:00 [INF] Successfully created PayMob order: 384475580 for local order: ORD-20250911164319-5167
2025-09-11 19:47:20.738 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:20.815 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__dto_PaymentMethod_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IntegrationId`
FROM `PaymentMethods` AS `p`
INNER JOIN `PaymentProviders` AS `p0` ON `p`.`PaymentProviderId` = `p0`.`Id`
WHERE ((`p`.`Method` = @__dto_PaymentMethod_0) AND `p`.`IsActive`) AND (`p0`.`Provider` = 1)
LIMIT 1
2025-09-11 19:47:20.825 +03:00 [INF] Using integration ID: 5221967 for payment method: "Visa"
2025-09-11 19:47:20.827 +03:00 [INF] Starting GeneratePaymentKeyAsync for Order ID: 384475580, Amount: 1012226
2025-09-11 19:47:20.830 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:20.833 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:21.048 +03:00 [INF] Received HTTP response headers after 213.1619ms - 201
2025-09-11 19:47:21.055 +03:00 [INF] End processing HTTP request after 224.6473ms - 201
2025-09-11 19:47:21.059 +03:00 [INF] Request sent to Paymob payment_keys endpoint
2025-09-11 19:47:21.061 +03:00 [INF] Received response from Paymob payment_keys endpoint
2025-09-11 19:47:21.063 +03:00 [INF] Payment key generated successfully for Order ID: 384475580
2025-09-11 19:47:21.065 +03:00 [INF] Successfully generated payment key for order: ORD-20250911164319-5167
2025-09-11 19:47:21.067 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:21.142 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__paymentProvider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IframeId`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = @__paymentProvider_0
LIMIT 1
2025-09-11 19:47:21.150 +03:00 [INF] Executing CreateAsync for entity Payment
2025-09-11 19:47:21.152 +03:00 [INF] Payment added successfully (pending save)
2025-09-11 19:47:21.154 +03:00 [INF] Execute AddUserOpreationAsync
2025-09-11 19:47:21.156 +03:00 [INF] Executing CreateAsync for entity UserOperationsLog
2025-09-11 19:47:21.157 +03:00 [INF] UserOperationsLog added successfully (pending save)
2025-09-11 19:47:21.310 +03:00 [INF] Executed DbCommand (78ms) [Parameters=[@p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime), @p2='?' (Size = 255), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int64), @p10='?' (DbType = Int32), @p11='?' (Size = 100), @p12='?' (DbType = DateTime), @p13='?' (DbType = DateTime), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime), @p17='?' (DbType = Int32), @p18='?' (DbType = DateTime), @p19='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `Payments` (`Amount`, `CreatedAt`, `CustomerId`, `DeletedAt`, `ModifiedAt`, `OrderId`, `PaymentDate`, `PaymentMethodId`, `PaymentProviderId`, `ProviderOrderId`, `Status`, `TransactionId`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
SELECT `Id`, `RowVersion`
FROM `Payments`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `userOperationsLogs` (`CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`, `UserId`)
VALUES (@p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19);
SELECT `Id`
FROM `userOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-09-11 19:47:21.465 +03:00 [INF] Payment created successfully with ID 30
2025-09-11 19:47:21.465 +03:00 [INF] Executed DbCommand (21,746ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT Id FROM Orders WHERE Id = @p0 FOR UPDATE
2025-09-11 19:47:21.476 +03:00 [INF] Execute GetAll for entity Payment
2025-09-11 19:47:21.552 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__order_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Amount`, `p`.`CreatedAt`, `p`.`CustomerId`, `p`.`DeletedAt`, `p`.`ModifiedAt`, `p`.`OrderId`, `p`.`PaymentDate`, `p`.`PaymentMethodId`, `p`.`PaymentProviderId`, `p`.`ProviderOrderId`, `p`.`RowVersion`, `p`.`Status`, `p`.`TransactionId`
FROM `Payments` AS `p`
WHERE (`p`.`OrderId` = @__order_Id_0) AND (`p`.`Status` = 1)
LIMIT 1
2025-09-11 19:47:21.575 +03:00 [INF] Getting payment method ID for enum "Visa"
2025-09-11 19:47:21.581 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:21.661 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__methodEnum_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`
FROM `PaymentMethods` AS `p`
WHERE ((`p`.`Method` = @__methodEnum_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:21.682 +03:00 [INF] Found payment method ID 1 for enum "Visa"
2025-09-11 19:47:21.695 +03:00 [INF] Executing GetByIdAsync for entity PaymentMethod with ID: 1
2025-09-11 19:47:21.775 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IntegrationId`, `p`.`IsActive`, `p`.`Method`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`PaymentProviderId`
FROM `PaymentMethods` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-09-11 19:47:21.788 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:21.870 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`PublicKey`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = 1
LIMIT 1
2025-09-11 19:47:21.892 +03:00 [INF] Executing GetTokenAsync
2025-09-11 19:47:21.894 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:21.898 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:22.139 +03:00 [INF] Received HTTP response headers after 235.3931ms - 201
2025-09-11 19:47:22.144 +03:00 [INF] End processing HTTP request after 249.9725ms - 201
2025-09-11 19:47:22.148 +03:00 [INF] Successfully retrieved PayMob token
2025-09-11 19:47:22.225 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-09-11 19:47:22.234 +03:00 [INF] Getting address by ID: 31
2025-09-11 19:47:22.317 +03:00 [INF] Executed DbCommand (80ms) [Parameters=[@__addressId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AdditionalNotes`, `c`.`AddressType`, `c`.`City`, `c`.`Country`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`IsDefault`, `c`.`ModifiedAt`, `c`.`PhoneNumber`, `c`.`PostalCode`, `c`.`State`, `c`.`StreetAddress`, `t`.`Id`, `t`.`AccessFailedCount`, `t`.`ConcurrencyStamp`, `t`.`Discriminator`, `t`.`Email`, `t`.`EmailConfirmed`, `t`.`LockoutEnabled`, `t`.`LockoutEnd`, `t`.`NormalizedEmail`, `t`.`NormalizedUserName`, `t`.`PasswordHash`, `t`.`PhoneNumber`, `t`.`PhoneNumberConfirmed`, `t`.`SecurityStamp`, `t`.`TwoFactorEnabled`, `t`.`UserName`, `t`.`Age`, `t`.`CreateAt`, `t`.`DeletedAt`, `t`.`Gender`, `t`.`ImageId`, `t`.`ImageId1`, `t`.`LastVisit`, `t`.`Name`
FROM `CustomerAddresses` AS `c`
INNER JOIN (
    SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
    FROM `AspNetUsers` AS `a`
    WHERE `a`.`Discriminator` = 'Customer'
) AS `t` ON `c`.`CustomerId` = `t`.`Id`
WHERE (`c`.`Id` = @__addressId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:22.327 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:22.332 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:22.347 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:47:22.354 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 23204.3487ms
2025-09-11 19:47:22.357 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:47:22.361 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 200 1365 application/json; charset=utf-8 23949.7333ms
2025-09-11 19:47:22.547 +03:00 [INF] Received HTTP response headers after 212.113ms - 201
2025-09-11 19:47:22.564 +03:00 [INF] End processing HTTP request after 236.2967ms - 201
2025-09-11 19:47:22.579 +03:00 [INF] Successfully created PayMob order: 384475606 for local order: ORD-20250911164319-5167
2025-09-11 19:47:22.598 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:22.677 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__dto_PaymentMethod_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IntegrationId`
FROM `PaymentMethods` AS `p`
INNER JOIN `PaymentProviders` AS `p0` ON `p`.`PaymentProviderId` = `p0`.`Id`
WHERE ((`p`.`Method` = @__dto_PaymentMethod_0) AND `p`.`IsActive`) AND (`p0`.`Provider` = 1)
LIMIT 1
2025-09-11 19:47:22.691 +03:00 [INF] Using integration ID: 5221967 for payment method: "Visa"
2025-09-11 19:47:22.696 +03:00 [INF] Starting GeneratePaymentKeyAsync for Order ID: 384475606, Amount: 1012226
2025-09-11 19:47:22.701 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:22.706 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:22.941 +03:00 [INF] Received HTTP response headers after 230.3672ms - 201
2025-09-11 19:47:22.953 +03:00 [INF] End processing HTTP request after 252.099ms - 201
2025-09-11 19:47:22.960 +03:00 [INF] Request sent to Paymob payment_keys endpoint
2025-09-11 19:47:22.964 +03:00 [INF] Received response from Paymob payment_keys endpoint
2025-09-11 19:47:22.968 +03:00 [INF] Payment key generated successfully for Order ID: 384475606
2025-09-11 19:47:22.972 +03:00 [INF] Successfully generated payment key for order: ORD-20250911164319-5167
2025-09-11 19:47:22.975 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:23.051 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__paymentProvider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IframeId`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = @__paymentProvider_0
LIMIT 1
2025-09-11 19:47:23.063 +03:00 [INF] Executing CreateAsync for entity Payment
2025-09-11 19:47:23.068 +03:00 [INF] Payment added successfully (pending save)
2025-09-11 19:47:23.072 +03:00 [INF] Execute AddUserOpreationAsync
2025-09-11 19:47:23.075 +03:00 [INF] Executing CreateAsync for entity UserOperationsLog
2025-09-11 19:47:23.078 +03:00 [INF] UserOperationsLog added successfully (pending save)
2025-09-11 19:47:23.240 +03:00 [INF] Executed DbCommand (82ms) [Parameters=[@p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime), @p2='?' (Size = 255), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int64), @p10='?' (DbType = Int32), @p11='?' (Size = 100), @p12='?' (DbType = DateTime), @p13='?' (DbType = DateTime), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime), @p17='?' (DbType = Int32), @p18='?' (DbType = DateTime), @p19='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `Payments` (`Amount`, `CreatedAt`, `CustomerId`, `DeletedAt`, `ModifiedAt`, `OrderId`, `PaymentDate`, `PaymentMethodId`, `PaymentProviderId`, `ProviderOrderId`, `Status`, `TransactionId`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
SELECT `Id`, `RowVersion`
FROM `Payments`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `userOperationsLogs` (`CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`, `UserId`)
VALUES (@p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19);
SELECT `Id`
FROM `userOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-09-11 19:47:23.400 +03:00 [INF] Payment created successfully with ID 31
2025-09-11 19:47:23.401 +03:00 [INF] Executed DbCommand (23,674ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT Id FROM Orders WHERE Id = @p0 FOR UPDATE
2025-09-11 19:47:23.407 +03:00 [INF] Execute GetAll for entity Payment
2025-09-11 19:47:23.492 +03:00 [INF] Executed DbCommand (84ms) [Parameters=[@__order_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Amount`, `p`.`CreatedAt`, `p`.`CustomerId`, `p`.`DeletedAt`, `p`.`ModifiedAt`, `p`.`OrderId`, `p`.`PaymentDate`, `p`.`PaymentMethodId`, `p`.`PaymentProviderId`, `p`.`ProviderOrderId`, `p`.`RowVersion`, `p`.`Status`, `p`.`TransactionId`
FROM `Payments` AS `p`
WHERE (`p`.`OrderId` = @__order_Id_0) AND (`p`.`Status` = 1)
LIMIT 1
2025-09-11 19:47:23.501 +03:00 [INF] Getting payment method ID for enum "Visa"
2025-09-11 19:47:23.504 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:23.582 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__methodEnum_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`
FROM `PaymentMethods` AS `p`
WHERE ((`p`.`Method` = @__methodEnum_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:23.592 +03:00 [INF] Found payment method ID 1 for enum "Visa"
2025-09-11 19:47:23.595 +03:00 [INF] Executing GetByIdAsync for entity PaymentMethod with ID: 1
2025-09-11 19:47:23.675 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IntegrationId`, `p`.`IsActive`, `p`.`Method`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`PaymentProviderId`
FROM `PaymentMethods` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-09-11 19:47:23.695 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:23.778 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`PublicKey`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = 1
LIMIT 1
2025-09-11 19:47:23.802 +03:00 [INF] Executing GetTokenAsync
2025-09-11 19:47:23.806 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:23.813 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:24.038 +03:00 [INF] Received HTTP response headers after 217.3032ms - 201
2025-09-11 19:47:24.056 +03:00 [INF] End processing HTTP request after 249.2385ms - 201
2025-09-11 19:47:24.068 +03:00 [INF] Successfully retrieved PayMob token
2025-09-11 19:47:24.159 +03:00 [INF] Executed DbCommand (85ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-09-11 19:47:24.174 +03:00 [INF] Getting address by ID: 31
2025-09-11 19:47:24.261 +03:00 [INF] Executed DbCommand (81ms) [Parameters=[@__addressId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AdditionalNotes`, `c`.`AddressType`, `c`.`City`, `c`.`Country`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`IsDefault`, `c`.`ModifiedAt`, `c`.`PhoneNumber`, `c`.`PostalCode`, `c`.`State`, `c`.`StreetAddress`, `t`.`Id`, `t`.`AccessFailedCount`, `t`.`ConcurrencyStamp`, `t`.`Discriminator`, `t`.`Email`, `t`.`EmailConfirmed`, `t`.`LockoutEnabled`, `t`.`LockoutEnd`, `t`.`NormalizedEmail`, `t`.`NormalizedUserName`, `t`.`PasswordHash`, `t`.`PhoneNumber`, `t`.`PhoneNumberConfirmed`, `t`.`SecurityStamp`, `t`.`TwoFactorEnabled`, `t`.`UserName`, `t`.`Age`, `t`.`CreateAt`, `t`.`DeletedAt`, `t`.`Gender`, `t`.`ImageId`, `t`.`ImageId1`, `t`.`LastVisit`, `t`.`Name`
FROM `CustomerAddresses` AS `c`
INNER JOIN (
    SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
    FROM `AspNetUsers` AS `a`
    WHERE `a`.`Discriminator` = 'Customer'
) AS `t` ON `c`.`CustomerId` = `t`.`Id`
WHERE (`c`.`Id` = @__addressId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:24.270 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:24.273 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:24.284 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:47:24.293 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 25106.1764ms
2025-09-11 19:47:24.299 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:47:24.302 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 200 1365 application/json; charset=utf-8 25895.5601ms
2025-09-11 19:47:24.485 +03:00 [INF] Received HTTP response headers after 207.1864ms - 201
2025-09-11 19:47:24.500 +03:00 [INF] End processing HTTP request after 229.122ms - 201
2025-09-11 19:47:24.514 +03:00 [INF] Successfully created PayMob order: 384475615 for local order: ORD-20250911164319-5167
2025-09-11 19:47:24.521 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:24.599 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__dto_PaymentMethod_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IntegrationId`
FROM `PaymentMethods` AS `p`
INNER JOIN `PaymentProviders` AS `p0` ON `p`.`PaymentProviderId` = `p0`.`Id`
WHERE ((`p`.`Method` = @__dto_PaymentMethod_0) AND `p`.`IsActive`) AND (`p0`.`Provider` = 1)
LIMIT 1
2025-09-11 19:47:24.614 +03:00 [INF] Using integration ID: 5221967 for payment method: "Visa"
2025-09-11 19:47:24.620 +03:00 [INF] Starting GeneratePaymentKeyAsync for Order ID: 384475615, Amount: 1012226
2025-09-11 19:47:24.627 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:24.631 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:24.856 +03:00 [INF] Received HTTP response headers after 220.7489ms - 201
2025-09-11 19:47:24.859 +03:00 [INF] End processing HTTP request after 232.389ms - 201
2025-09-11 19:47:24.862 +03:00 [INF] Request sent to Paymob payment_keys endpoint
2025-09-11 19:47:24.864 +03:00 [INF] Received response from Paymob payment_keys endpoint
2025-09-11 19:47:24.866 +03:00 [INF] Payment key generated successfully for Order ID: 384475615
2025-09-11 19:47:24.868 +03:00 [INF] Successfully generated payment key for order: ORD-20250911164319-5167
2025-09-11 19:47:24.871 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:24.948 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__paymentProvider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IframeId`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = @__paymentProvider_0
LIMIT 1
2025-09-11 19:47:24.955 +03:00 [INF] Executing CreateAsync for entity Payment
2025-09-11 19:47:24.956 +03:00 [INF] Payment added successfully (pending save)
2025-09-11 19:47:24.958 +03:00 [INF] Execute AddUserOpreationAsync
2025-09-11 19:47:24.960 +03:00 [INF] Executing CreateAsync for entity UserOperationsLog
2025-09-11 19:47:24.962 +03:00 [INF] UserOperationsLog added successfully (pending save)
2025-09-11 19:47:25.118 +03:00 [INF] Executed DbCommand (79ms) [Parameters=[@p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime), @p2='?' (Size = 255), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int64), @p10='?' (DbType = Int32), @p11='?' (Size = 100), @p12='?' (DbType = DateTime), @p13='?' (DbType = DateTime), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime), @p17='?' (DbType = Int32), @p18='?' (DbType = DateTime), @p19='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `Payments` (`Amount`, `CreatedAt`, `CustomerId`, `DeletedAt`, `ModifiedAt`, `OrderId`, `PaymentDate`, `PaymentMethodId`, `PaymentProviderId`, `ProviderOrderId`, `Status`, `TransactionId`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
SELECT `Id`, `RowVersion`
FROM `Payments`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `userOperationsLogs` (`CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`, `UserId`)
VALUES (@p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19);
SELECT `Id`
FROM `userOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-09-11 19:47:25.284 +03:00 [INF] Executed DbCommand (25,549ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT Id FROM Orders WHERE Id = @p0 FOR UPDATE
2025-09-11 19:47:25.285 +03:00 [INF] Payment created successfully with ID 32
2025-09-11 19:47:25.294 +03:00 [INF] Execute GetAll for entity Payment
2025-09-11 19:47:25.377 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[@__order_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Amount`, `p`.`CreatedAt`, `p`.`CustomerId`, `p`.`DeletedAt`, `p`.`ModifiedAt`, `p`.`OrderId`, `p`.`PaymentDate`, `p`.`PaymentMethodId`, `p`.`PaymentProviderId`, `p`.`ProviderOrderId`, `p`.`RowVersion`, `p`.`Status`, `p`.`TransactionId`
FROM `Payments` AS `p`
WHERE (`p`.`OrderId` = @__order_Id_0) AND (`p`.`Status` = 1)
LIMIT 1
2025-09-11 19:47:25.400 +03:00 [INF] Getting payment method ID for enum "Visa"
2025-09-11 19:47:25.409 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:25.490 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__methodEnum_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`
FROM `PaymentMethods` AS `p`
WHERE ((`p`.`Method` = @__methodEnum_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:25.505 +03:00 [INF] Found payment method ID 1 for enum "Visa"
2025-09-11 19:47:25.510 +03:00 [INF] Executing GetByIdAsync for entity PaymentMethod with ID: 1
2025-09-11 19:47:25.588 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IntegrationId`, `p`.`IsActive`, `p`.`Method`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`PaymentProviderId`
FROM `PaymentMethods` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-09-11 19:47:25.601 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:25.682 +03:00 [INF] Executed DbCommand (72ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`PublicKey`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = 1
LIMIT 1
2025-09-11 19:47:25.692 +03:00 [INF] Executing GetTokenAsync
2025-09-11 19:47:25.695 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:25.699 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:25.925 +03:00 [INF] Received HTTP response headers after 222.6512ms - 201
2025-09-11 19:47:25.937 +03:00 [INF] End processing HTTP request after 242.2764ms - 201
2025-09-11 19:47:25.947 +03:00 [INF] Successfully retrieved PayMob token
2025-09-11 19:47:26.028 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-09-11 19:47:26.036 +03:00 [INF] Getting address by ID: 31
2025-09-11 19:47:26.121 +03:00 [INF] Executed DbCommand (83ms) [Parameters=[@__addressId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AdditionalNotes`, `c`.`AddressType`, `c`.`City`, `c`.`Country`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`IsDefault`, `c`.`ModifiedAt`, `c`.`PhoneNumber`, `c`.`PostalCode`, `c`.`State`, `c`.`StreetAddress`, `t`.`Id`, `t`.`AccessFailedCount`, `t`.`ConcurrencyStamp`, `t`.`Discriminator`, `t`.`Email`, `t`.`EmailConfirmed`, `t`.`LockoutEnabled`, `t`.`LockoutEnd`, `t`.`NormalizedEmail`, `t`.`NormalizedUserName`, `t`.`PasswordHash`, `t`.`PhoneNumber`, `t`.`PhoneNumberConfirmed`, `t`.`SecurityStamp`, `t`.`TwoFactorEnabled`, `t`.`UserName`, `t`.`Age`, `t`.`CreateAt`, `t`.`DeletedAt`, `t`.`Gender`, `t`.`ImageId`, `t`.`ImageId1`, `t`.`LastVisit`, `t`.`Name`
FROM `CustomerAddresses` AS `c`
INNER JOIN (
    SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
    FROM `AspNetUsers` AS `a`
    WHERE `a`.`Discriminator` = 'Customer'
) AS `t` ON `c`.`CustomerId` = `t`.`Id`
WHERE (`c`.`Id` = @__addressId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:26.144 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:26.149 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:26.192 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:47:26.196 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 27025.6927ms
2025-09-11 19:47:26.200 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:47:26.203 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 200 1365 application/json; charset=utf-8 27766.5904ms
2025-09-11 19:47:26.357 +03:00 [INF] Received HTTP response headers after 205.9076ms - 201
2025-09-11 19:47:26.362 +03:00 [INF] End processing HTTP request after 218.407ms - 201
2025-09-11 19:47:26.367 +03:00 [INF] Successfully created PayMob order: 384475630 for local order: ORD-20250911164319-5167
2025-09-11 19:47:26.370 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:26.449 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__dto_PaymentMethod_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IntegrationId`
FROM `PaymentMethods` AS `p`
INNER JOIN `PaymentProviders` AS `p0` ON `p`.`PaymentProviderId` = `p0`.`Id`
WHERE ((`p`.`Method` = @__dto_PaymentMethod_0) AND `p`.`IsActive`) AND (`p0`.`Provider` = 1)
LIMIT 1
2025-09-11 19:47:26.458 +03:00 [INF] Using integration ID: 5221967 for payment method: "Visa"
2025-09-11 19:47:26.461 +03:00 [INF] Starting GeneratePaymentKeyAsync for Order ID: 384475630, Amount: 1012226
2025-09-11 19:47:26.463 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:26.468 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:26.684 +03:00 [INF] Received HTTP response headers after 213.245ms - 201
2025-09-11 19:47:26.689 +03:00 [INF] End processing HTTP request after 225.914ms - 201
2025-09-11 19:47:26.693 +03:00 [INF] Request sent to Paymob payment_keys endpoint
2025-09-11 19:47:26.696 +03:00 [INF] Received response from Paymob payment_keys endpoint
2025-09-11 19:47:26.698 +03:00 [INF] Payment key generated successfully for Order ID: 384475630
2025-09-11 19:47:26.701 +03:00 [INF] Successfully generated payment key for order: ORD-20250911164319-5167
2025-09-11 19:47:26.703 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:26.778 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__paymentProvider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IframeId`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = @__paymentProvider_0
LIMIT 1
2025-09-11 19:47:26.786 +03:00 [INF] Executing CreateAsync for entity Payment
2025-09-11 19:47:26.788 +03:00 [INF] Payment added successfully (pending save)
2025-09-11 19:47:26.789 +03:00 [INF] Execute AddUserOpreationAsync
2025-09-11 19:47:26.791 +03:00 [INF] Executing CreateAsync for entity UserOperationsLog
2025-09-11 19:47:26.794 +03:00 [INF] UserOperationsLog added successfully (pending save)
2025-09-11 19:47:26.947 +03:00 [INF] Executed DbCommand (78ms) [Parameters=[@p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime), @p2='?' (Size = 255), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int64), @p10='?' (DbType = Int32), @p11='?' (Size = 100), @p12='?' (DbType = DateTime), @p13='?' (DbType = DateTime), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime), @p17='?' (DbType = Int32), @p18='?' (DbType = DateTime), @p19='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `Payments` (`Amount`, `CreatedAt`, `CustomerId`, `DeletedAt`, `ModifiedAt`, `OrderId`, `PaymentDate`, `PaymentMethodId`, `PaymentProviderId`, `ProviderOrderId`, `Status`, `TransactionId`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
SELECT `Id`, `RowVersion`
FROM `Payments`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `userOperationsLogs` (`CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`, `UserId`)
VALUES (@p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19);
SELECT `Id`
FROM `userOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-09-11 19:47:27.120 +03:00 [INF] Payment created successfully with ID 33
2025-09-11 19:47:27.121 +03:00 [INF] Executed DbCommand (27,265ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT Id FROM Orders WHERE Id = @p0 FOR UPDATE
2025-09-11 19:47:27.157 +03:00 [INF] Execute GetAll for entity Payment
2025-09-11 19:47:27.237 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__order_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Amount`, `p`.`CreatedAt`, `p`.`CustomerId`, `p`.`DeletedAt`, `p`.`ModifiedAt`, `p`.`OrderId`, `p`.`PaymentDate`, `p`.`PaymentMethodId`, `p`.`PaymentProviderId`, `p`.`ProviderOrderId`, `p`.`RowVersion`, `p`.`Status`, `p`.`TransactionId`
FROM `Payments` AS `p`
WHERE (`p`.`OrderId` = @__order_Id_0) AND (`p`.`Status` = 1)
LIMIT 1
2025-09-11 19:47:27.247 +03:00 [INF] Getting payment method ID for enum "Visa"
2025-09-11 19:47:27.252 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:27.331 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__methodEnum_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`
FROM `PaymentMethods` AS `p`
WHERE ((`p`.`Method` = @__methodEnum_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:27.359 +03:00 [INF] Found payment method ID 1 for enum "Visa"
2025-09-11 19:47:27.368 +03:00 [INF] Executing GetByIdAsync for entity PaymentMethod with ID: 1
2025-09-11 19:47:27.448 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IntegrationId`, `p`.`IsActive`, `p`.`Method`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`PaymentProviderId`
FROM `PaymentMethods` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-09-11 19:47:27.462 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:27.547 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`PublicKey`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = 1
LIMIT 1
2025-09-11 19:47:27.556 +03:00 [INF] Executing GetTokenAsync
2025-09-11 19:47:27.559 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:27.570 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:27.792 +03:00 [INF] Received HTTP response headers after 215.866ms - 201
2025-09-11 19:47:27.798 +03:00 [INF] End processing HTTP request after 238.7027ms - 201
2025-09-11 19:47:27.802 +03:00 [INF] Successfully retrieved PayMob token
2025-09-11 19:47:27.880 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-09-11 19:47:27.904 +03:00 [INF] Getting address by ID: 31
2025-09-11 19:47:27.998 +03:00 [INF] Executed DbCommand (80ms) [Parameters=[@__addressId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AdditionalNotes`, `c`.`AddressType`, `c`.`City`, `c`.`Country`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`IsDefault`, `c`.`ModifiedAt`, `c`.`PhoneNumber`, `c`.`PostalCode`, `c`.`State`, `c`.`StreetAddress`, `t`.`Id`, `t`.`AccessFailedCount`, `t`.`ConcurrencyStamp`, `t`.`Discriminator`, `t`.`Email`, `t`.`EmailConfirmed`, `t`.`LockoutEnabled`, `t`.`LockoutEnd`, `t`.`NormalizedEmail`, `t`.`NormalizedUserName`, `t`.`PasswordHash`, `t`.`PhoneNumber`, `t`.`PhoneNumberConfirmed`, `t`.`SecurityStamp`, `t`.`TwoFactorEnabled`, `t`.`UserName`, `t`.`Age`, `t`.`CreateAt`, `t`.`DeletedAt`, `t`.`Gender`, `t`.`ImageId`, `t`.`ImageId1`, `t`.`LastVisit`, `t`.`Name`
FROM `CustomerAddresses` AS `c`
INNER JOIN (
    SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
    FROM `AspNetUsers` AS `a`
    WHERE `a`.`Discriminator` = 'Customer'
) AS `t` ON `c`.`CustomerId` = `t`.`Id`
WHERE (`c`.`Id` = @__addressId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:28.007 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:47:28.009 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:28.013 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 28785.8969ms
2025-09-11 19:47:28.017 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:28.023 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:47:28.030 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 200 1365 application/json; charset=utf-8 29590.5712ms
2025-09-11 19:47:28.230 +03:00 [INF] Received HTTP response headers after 203.6765ms - 201
2025-09-11 19:47:28.244 +03:00 [INF] End processing HTTP request after 234.8471ms - 201
2025-09-11 19:47:28.257 +03:00 [INF] Successfully created PayMob order: 384475646 for local order: ORD-20250911164319-5167
2025-09-11 19:47:28.267 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:28.346 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__dto_PaymentMethod_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IntegrationId`
FROM `PaymentMethods` AS `p`
INNER JOIN `PaymentProviders` AS `p0` ON `p`.`PaymentProviderId` = `p0`.`Id`
WHERE ((`p`.`Method` = @__dto_PaymentMethod_0) AND `p`.`IsActive`) AND (`p0`.`Provider` = 1)
LIMIT 1
2025-09-11 19:47:28.358 +03:00 [INF] Using integration ID: 5221967 for payment method: "Visa"
2025-09-11 19:47:28.365 +03:00 [INF] Starting GeneratePaymentKeyAsync for Order ID: 384475646, Amount: 1012226
2025-09-11 19:47:28.372 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:28.379 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:28.601 +03:00 [INF] Received HTTP response headers after 214.3496ms - 201
2025-09-11 19:47:28.617 +03:00 [INF] End processing HTTP request after 244.9486ms - 201
2025-09-11 19:47:28.628 +03:00 [INF] Request sent to Paymob payment_keys endpoint
2025-09-11 19:47:28.634 +03:00 [INF] Received response from Paymob payment_keys endpoint
2025-09-11 19:47:28.639 +03:00 [INF] Payment key generated successfully for Order ID: 384475646
2025-09-11 19:47:28.648 +03:00 [INF] Successfully generated payment key for order: ORD-20250911164319-5167
2025-09-11 19:47:28.654 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:28.730 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__paymentProvider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IframeId`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = @__paymentProvider_0
LIMIT 1
2025-09-11 19:47:28.739 +03:00 [INF] Executing CreateAsync for entity Payment
2025-09-11 19:47:28.743 +03:00 [INF] Payment added successfully (pending save)
2025-09-11 19:47:28.745 +03:00 [INF] Execute AddUserOpreationAsync
2025-09-11 19:47:28.747 +03:00 [INF] Executing CreateAsync for entity UserOperationsLog
2025-09-11 19:47:28.749 +03:00 [INF] UserOperationsLog added successfully (pending save)
2025-09-11 19:47:28.906 +03:00 [INF] Executed DbCommand (80ms) [Parameters=[@p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime), @p2='?' (Size = 255), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int64), @p10='?' (DbType = Int32), @p11='?' (Size = 100), @p12='?' (DbType = DateTime), @p13='?' (DbType = DateTime), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime), @p17='?' (DbType = Int32), @p18='?' (DbType = DateTime), @p19='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `Payments` (`Amount`, `CreatedAt`, `CustomerId`, `DeletedAt`, `ModifiedAt`, `OrderId`, `PaymentDate`, `PaymentMethodId`, `PaymentProviderId`, `ProviderOrderId`, `Status`, `TransactionId`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
SELECT `Id`, `RowVersion`
FROM `Payments`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `userOperationsLogs` (`CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`, `UserId`)
VALUES (@p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19);
SELECT `Id`
FROM `userOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-09-11 19:47:29.064 +03:00 [INF] Executed DbCommand (29,200ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT Id FROM Orders WHERE Id = @p0 FOR UPDATE
2025-09-11 19:47:29.065 +03:00 [INF] Payment created successfully with ID 34
2025-09-11 19:47:29.071 +03:00 [INF] Execute GetAll for entity Payment
2025-09-11 19:47:29.147 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__order_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Amount`, `p`.`CreatedAt`, `p`.`CustomerId`, `p`.`DeletedAt`, `p`.`ModifiedAt`, `p`.`OrderId`, `p`.`PaymentDate`, `p`.`PaymentMethodId`, `p`.`PaymentProviderId`, `p`.`ProviderOrderId`, `p`.`RowVersion`, `p`.`Status`, `p`.`TransactionId`
FROM `Payments` AS `p`
WHERE (`p`.`OrderId` = @__order_Id_0) AND (`p`.`Status` = 1)
LIMIT 1
2025-09-11 19:47:29.152 +03:00 [INF] Getting payment method ID for enum "Visa"
2025-09-11 19:47:29.154 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:29.228 +03:00 [INF] Executed DbCommand (72ms) [Parameters=[@__methodEnum_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`
FROM `PaymentMethods` AS `p`
WHERE ((`p`.`Method` = @__methodEnum_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:29.235 +03:00 [INF] Found payment method ID 1 for enum "Visa"
2025-09-11 19:47:29.238 +03:00 [INF] Executing GetByIdAsync for entity PaymentMethod with ID: 1
2025-09-11 19:47:29.313 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IntegrationId`, `p`.`IsActive`, `p`.`Method`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`PaymentProviderId`
FROM `PaymentMethods` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-09-11 19:47:29.320 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:29.394 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`PublicKey`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = 1
LIMIT 1
2025-09-11 19:47:29.405 +03:00 [INF] Executing GetTokenAsync
2025-09-11 19:47:29.407 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:29.410 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:29.645 +03:00 [INF] Received HTTP response headers after 232.3149ms - 201
2025-09-11 19:47:29.664 +03:00 [INF] End processing HTTP request after 256.062ms - 201
2025-09-11 19:47:29.677 +03:00 [INF] Successfully retrieved PayMob token
2025-09-11 19:47:29.773 +03:00 [INF] Executed DbCommand (90ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-09-11 19:47:29.788 +03:00 [INF] Getting address by ID: 31
2025-09-11 19:47:29.873 +03:00 [INF] Executed DbCommand (79ms) [Parameters=[@__addressId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AdditionalNotes`, `c`.`AddressType`, `c`.`City`, `c`.`Country`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`IsDefault`, `c`.`ModifiedAt`, `c`.`PhoneNumber`, `c`.`PostalCode`, `c`.`State`, `c`.`StreetAddress`, `t`.`Id`, `t`.`AccessFailedCount`, `t`.`ConcurrencyStamp`, `t`.`Discriminator`, `t`.`Email`, `t`.`EmailConfirmed`, `t`.`LockoutEnabled`, `t`.`LockoutEnd`, `t`.`NormalizedEmail`, `t`.`NormalizedUserName`, `t`.`PasswordHash`, `t`.`PhoneNumber`, `t`.`PhoneNumberConfirmed`, `t`.`SecurityStamp`, `t`.`TwoFactorEnabled`, `t`.`UserName`, `t`.`Age`, `t`.`CreateAt`, `t`.`DeletedAt`, `t`.`Gender`, `t`.`ImageId`, `t`.`ImageId1`, `t`.`LastVisit`, `t`.`Name`
FROM `CustomerAddresses` AS `c`
INNER JOIN (
    SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
    FROM `AspNetUsers` AS `a`
    WHERE `a`.`Discriminator` = 'Customer'
) AS `t` ON `c`.`CustomerId` = `t`.`Id`
WHERE (`c`.`Id` = @__addressId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:29.902 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:29.915 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:29.960 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:47:29.971 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 30686.3901ms
2025-09-11 19:47:29.981 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:47:29.988 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 200 1365 application/json; charset=utf-8 31546.4853ms
2025-09-11 19:47:30.135 +03:00 [INF] Received HTTP response headers after 211.9999ms - 201
2025-09-11 19:47:30.145 +03:00 [INF] End processing HTTP request after 243.5851ms - 201
2025-09-11 19:47:30.155 +03:00 [INF] Successfully created PayMob order: 384475661 for local order: ORD-20250911164319-5167
2025-09-11 19:47:30.166 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:30.247 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__dto_PaymentMethod_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IntegrationId`
FROM `PaymentMethods` AS `p`
INNER JOIN `PaymentProviders` AS `p0` ON `p`.`PaymentProviderId` = `p0`.`Id`
WHERE ((`p`.`Method` = @__dto_PaymentMethod_0) AND `p`.`IsActive`) AND (`p0`.`Provider` = 1)
LIMIT 1
2025-09-11 19:47:30.256 +03:00 [INF] Using integration ID: 5221967 for payment method: "Visa"
2025-09-11 19:47:30.260 +03:00 [INF] Starting GeneratePaymentKeyAsync for Order ID: 384475661, Amount: 1012226
2025-09-11 19:47:30.272 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:30.283 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:30.501 +03:00 [INF] Received HTTP response headers after 213.8104ms - 201
2025-09-11 19:47:30.504 +03:00 [INF] End processing HTTP request after 232.343ms - 201
2025-09-11 19:47:30.507 +03:00 [INF] Request sent to Paymob payment_keys endpoint
2025-09-11 19:47:30.509 +03:00 [INF] Received response from Paymob payment_keys endpoint
2025-09-11 19:47:30.510 +03:00 [INF] Payment key generated successfully for Order ID: 384475661
2025-09-11 19:47:30.514 +03:00 [INF] Successfully generated payment key for order: ORD-20250911164319-5167
2025-09-11 19:47:30.515 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:30.575 +03:00 [ERR] Failed executing DbCommand (30,648ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT Id FROM Orders WHERE Id = @p0 FOR UPDATE
2025-09-11 19:47:30.588 +03:00 [ERR] Error occurred while creating payment for user e682f183-1c61-400b-aa5a-171750f446b5
MySqlConnector.MySqlException (0x80004005): The Command Timeout expired before the operation completed.
 ---> MySqlConnector.MySqlException (0x80004005): Query execution was interrupted
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 124
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteNonQueryAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 309
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQueryAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQueryAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQueryAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.ExecuteSqlRawAsync(DatabaseFacade databaseFacade, String sql, IEnumerable`1 parameters, CancellationToken cancellationToken)
   at E_Commerce.Services.PaymentServices.PaymentServices.CreatePaymentMethod(String ordernumber, CreatePaymentOfCustomer paymentdto, String userid) in D:\project_fashion\E-Commerce-API-main\Services\PaymentServices\PaymentServices.cs:line 185
2025-09-11 19:47:30.591 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__paymentProvider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IframeId`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = @__paymentProvider_0
LIMIT 1
2025-09-11 19:47:30.681 +03:00 [INF] Executing CreateAsync for entity Payment
2025-09-11 19:47:30.684 +03:00 [INF] Payment added successfully (pending save)
2025-09-11 19:47:30.686 +03:00 [INF] Execute AddUserOpreationAsync
2025-09-11 19:47:30.687 +03:00 [INF] Executing CreateAsync for entity UserOperationsLog
2025-09-11 19:47:30.689 +03:00 [INF] UserOperationsLog added successfully (pending save)
2025-09-11 19:47:30.777 +03:00 [ERR] Failed executing DbCommand (30,840ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT Id FROM Orders WHERE Id = @p0 FOR UPDATE
2025-09-11 19:47:30.785 +03:00 [ERR] Error occurred while creating payment for user e682f183-1c61-400b-aa5a-171750f446b5
MySqlConnector.MySqlException (0x80004005): The Command Timeout expired before the operation completed.
 ---> MySqlConnector.MySqlException (0x80004005): Query execution was interrupted
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 124
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteNonQueryAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 309
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQueryAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQueryAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQueryAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.ExecuteSqlRawAsync(DatabaseFacade databaseFacade, String sql, IEnumerable`1 parameters, CancellationToken cancellationToken)
   at E_Commerce.Services.PaymentServices.PaymentServices.CreatePaymentMethod(String ordernumber, CreatePaymentOfCustomer paymentdto, String userid) in D:\project_fashion\E-Commerce-API-main\Services\PaymentServices\PaymentServices.cs:line 185
2025-09-11 19:47:30.845 +03:00 [INF] Executed DbCommand (81ms) [Parameters=[@p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime), @p2='?' (Size = 255), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int64), @p10='?' (DbType = Int32), @p11='?' (Size = 100), @p12='?' (DbType = DateTime), @p13='?' (DbType = DateTime), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime), @p17='?' (DbType = Int32), @p18='?' (DbType = DateTime), @p19='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `Payments` (`Amount`, `CreatedAt`, `CustomerId`, `DeletedAt`, `ModifiedAt`, `OrderId`, `PaymentDate`, `PaymentMethodId`, `PaymentProviderId`, `ProviderOrderId`, `Status`, `TransactionId`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
SELECT `Id`, `RowVersion`
FROM `Payments`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `userOperationsLogs` (`CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`, `UserId`)
VALUES (@p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19);
SELECT `Id`
FROM `userOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-09-11 19:47:31.016 +03:00 [INF] Payment created successfully with ID 35
2025-09-11 19:47:31.658 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:47:31.664 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 32234.5904ms
2025-09-11 19:47:31.669 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:47:31.673 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 500 206 application/json; charset=utf-8 33190.1052ms
2025-09-11 19:47:31.739 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:47:31.744 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 32269.4536ms
2025-09-11 19:47:31.750 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:47:31.755 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 500 206 application/json; charset=utf-8 33270.8247ms
2025-09-11 19:47:31.757 +03:00 [INF] Executed DbCommand (31,798ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT Id FROM Orders WHERE Id = @p0 FOR UPDATE
2025-09-11 19:47:31.767 +03:00 [INF] Execute GetAll for entity Payment
2025-09-11 19:47:31.826 +03:00 [ERR] Failed executing DbCommand (31,745ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT Id FROM Orders WHERE Id = @p0 FOR UPDATE
2025-09-11 19:47:31.831 +03:00 [ERR] Error occurred while creating payment for user e682f183-1c61-400b-aa5a-171750f446b5
MySqlConnector.MySqlException (0x80004005): The Command Timeout expired before the operation completed.
 ---> MySqlConnector.MySqlException (0x80004005): Query execution was interrupted
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 124
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteNonQueryAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 309
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQueryAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQueryAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQueryAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.ExecuteSqlRawAsync(DatabaseFacade databaseFacade, String sql, IEnumerable`1 parameters, CancellationToken cancellationToken)
   at E_Commerce.Services.PaymentServices.PaymentServices.CreatePaymentMethod(String ordernumber, CreatePaymentOfCustomer paymentdto, String userid) in D:\project_fashion\E-Commerce-API-main\Services\PaymentServices\PaymentServices.cs:line 185
2025-09-11 19:47:31.842 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__order_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Amount`, `p`.`CreatedAt`, `p`.`CustomerId`, `p`.`DeletedAt`, `p`.`ModifiedAt`, `p`.`OrderId`, `p`.`PaymentDate`, `p`.`PaymentMethodId`, `p`.`PaymentProviderId`, `p`.`ProviderOrderId`, `p`.`RowVersion`, `p`.`Status`, `p`.`TransactionId`
FROM `Payments` AS `p`
WHERE (`p`.`OrderId` = @__order_Id_0) AND (`p`.`Status` = 1)
LIMIT 1
2025-09-11 19:47:31.850 +03:00 [INF] Getting payment method ID for enum "Visa"
2025-09-11 19:47:31.855 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:31.905 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:47:31.908 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 32602.3801ms
2025-09-11 19:47:31.912 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:47:31.914 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 200 1365 application/json; charset=utf-8 33437.0893ms
2025-09-11 19:47:31.932 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__methodEnum_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`
FROM `PaymentMethods` AS `p`
WHERE ((`p`.`Method` = @__methodEnum_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:31.937 +03:00 [INF] Found payment method ID 1 for enum "Visa"
2025-09-11 19:47:31.940 +03:00 [INF] Executing GetByIdAsync for entity PaymentMethod with ID: 1
2025-09-11 19:47:32.015 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IntegrationId`, `p`.`IsActive`, `p`.`Method`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`PaymentProviderId`
FROM `PaymentMethods` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-09-11 19:47:32.024 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:32.102 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`PublicKey`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = 1
LIMIT 1
2025-09-11 19:47:32.117 +03:00 [INF] Executing GetTokenAsync
2025-09-11 19:47:32.124 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:32.135 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/auth/tokens
2025-09-11 19:47:32.356 +03:00 [INF] Received HTTP response headers after 216.6573ms - 201
2025-09-11 19:47:32.374 +03:00 [INF] End processing HTTP request after 249.9561ms - 201
2025-09-11 19:47:32.391 +03:00 [INF] Successfully retrieved PayMob token
2025-09-11 19:47:32.478 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-09-11 19:47:32.492 +03:00 [INF] Getting address by ID: 31
2025-09-11 19:47:32.577 +03:00 [INF] Executed DbCommand (81ms) [Parameters=[@__addressId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AdditionalNotes`, `c`.`AddressType`, `c`.`City`, `c`.`Country`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`IsDefault`, `c`.`ModifiedAt`, `c`.`PhoneNumber`, `c`.`PostalCode`, `c`.`State`, `c`.`StreetAddress`, `t`.`Id`, `t`.`AccessFailedCount`, `t`.`ConcurrencyStamp`, `t`.`Discriminator`, `t`.`Email`, `t`.`EmailConfirmed`, `t`.`LockoutEnabled`, `t`.`LockoutEnd`, `t`.`NormalizedEmail`, `t`.`NormalizedUserName`, `t`.`PasswordHash`, `t`.`PhoneNumber`, `t`.`PhoneNumberConfirmed`, `t`.`SecurityStamp`, `t`.`TwoFactorEnabled`, `t`.`UserName`, `t`.`Age`, `t`.`CreateAt`, `t`.`DeletedAt`, `t`.`Gender`, `t`.`ImageId`, `t`.`ImageId1`, `t`.`LastVisit`, `t`.`Name`
FROM `CustomerAddresses` AS `c`
INNER JOIN (
    SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
    FROM `AspNetUsers` AS `a`
    WHERE `a`.`Discriminator` = 'Customer'
) AS `t` ON `c`.`CustomerId` = `t`.`Id`
WHERE (`c`.`Id` = @__addressId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-09-11 19:47:32.592 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:32.602 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/ecommerce/orders
2025-09-11 19:47:32.805 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:47:32.816 +03:00 [INF] Received HTTP response headers after 208.2413ms - 201
2025-09-11 19:47:32.823 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 33600.3937ms
2025-09-11 19:47:32.829 +03:00 [INF] End processing HTTP request after 237.6431ms - 201
2025-09-11 19:47:32.837 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:47:32.842 +03:00 [INF] Successfully created PayMob order: 384475687 for local order: ORD-20250911164319-5167
2025-09-11 19:47:32.851 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 500 206 application/json; charset=utf-8 34413.6021ms
2025-09-11 19:47:32.855 +03:00 [INF] Execute GetAll for entity PaymentMethod
2025-09-11 19:47:32.939 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__dto_PaymentMethod_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IntegrationId`
FROM `PaymentMethods` AS `p`
INNER JOIN `PaymentProviders` AS `p0` ON `p`.`PaymentProviderId` = `p0`.`Id`
WHERE ((`p`.`Method` = @__dto_PaymentMethod_0) AND `p`.`IsActive`) AND (`p0`.`Provider` = 1)
LIMIT 1
2025-09-11 19:47:32.949 +03:00 [INF] Using integration ID: 5221967 for payment method: "Visa"
2025-09-11 19:47:32.954 +03:00 [INF] Starting GeneratePaymentKeyAsync for Order ID: 384475687, Amount: 1012226
2025-09-11 19:47:32.958 +03:00 [INF] Start processing HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:32.961 +03:00 [INF] Sending HTTP request POST https://accept.paymob.com/api/acceptance/payment_keys
2025-09-11 19:47:33.178 +03:00 [INF] Received HTTP response headers after 213.0223ms - 201
2025-09-11 19:47:33.188 +03:00 [INF] End processing HTTP request after 230.8881ms - 201
2025-09-11 19:47:33.192 +03:00 [INF] Request sent to Paymob payment_keys endpoint
2025-09-11 19:47:33.194 +03:00 [INF] Received response from Paymob payment_keys endpoint
2025-09-11 19:47:33.203 +03:00 [INF] Payment key generated successfully for Order ID: 384475687
2025-09-11 19:47:33.205 +03:00 [INF] Successfully generated payment key for order: ORD-20250911164319-5167
2025-09-11 19:47:33.209 +03:00 [INF] Execute GetAll for entity PaymentProvider
2025-09-11 19:47:33.287 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__paymentProvider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IframeId`
FROM `PaymentProviders` AS `p`
WHERE `p`.`Provider` = @__paymentProvider_0
LIMIT 1
2025-09-11 19:47:33.294 +03:00 [INF] Executing CreateAsync for entity Payment
2025-09-11 19:47:33.296 +03:00 [INF] Payment added successfully (pending save)
2025-09-11 19:47:33.299 +03:00 [INF] Execute AddUserOpreationAsync
2025-09-11 19:47:33.302 +03:00 [INF] Executing CreateAsync for entity UserOperationsLog
2025-09-11 19:47:33.304 +03:00 [INF] UserOperationsLog added successfully (pending save)
2025-09-11 19:47:33.456 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[@p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime), @p2='?' (Size = 255), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int64), @p10='?' (DbType = Int32), @p11='?' (Size = 100), @p12='?' (DbType = DateTime), @p13='?' (DbType = DateTime), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime), @p17='?' (DbType = Int32), @p18='?' (DbType = DateTime), @p19='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `Payments` (`Amount`, `CreatedAt`, `CustomerId`, `DeletedAt`, `ModifiedAt`, `OrderId`, `PaymentDate`, `PaymentMethodId`, `PaymentProviderId`, `ProviderOrderId`, `Status`, `TransactionId`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
SELECT `Id`, `RowVersion`
FROM `Payments`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `userOperationsLogs` (`CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`, `UserId`)
VALUES (@p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19);
SELECT `Id`
FROM `userOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-09-11 19:47:33.611 +03:00 [INF] Payment created successfully with ID 36
2025-09-11 19:47:34.503 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.PaymentDtos.PaymentResponseDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-11 19:47:34.508 +03:00 [INF] Executed action E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce) in 35039.8111ms
2025-09-11 19:47:34.510 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.PaymentController.CreatePayment (E-Commerce)'
2025-09-11 19:47:34.514 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Payment - 200 1365 application/json; charset=utf-8 36024.9694ms
2025-09-11 19:54:50.196 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-11 19:54:51.113 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
