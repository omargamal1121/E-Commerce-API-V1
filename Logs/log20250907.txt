2025-09-07 14:58:52.551 +03:00 [INF] DB tables already exist. Exit install
2025-09-07 14:58:54.761 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-07 14:58:56.002 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-07 14:58:56.685 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-07 14:58:56.858 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-09-07 14:58:56.879 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-07 14:58:56.890 +03:00 [INF] Starting data seeding...
2025-09-07 14:58:56.916 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-07 14:58:57.480 +03:00 [INF] Executed DbCommand (107ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-09-07 14:58:57.542 +03:00 [INF] Role 'Admin' already exists.
2025-09-07 14:58:57.698 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-09-07 14:58:57.709 +03:00 [INF] Role 'User' already exists.
2025-09-07 14:58:57.896 +03:00 [INF] Executed DbCommand (79ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-09-07 14:58:57.980 +03:00 [INF] Admin user already exists. Skipping provider/method creation.
2025-09-07 14:58:57.985 +03:00 [INF] Data seeding completed successfully.
2025-09-07 14:58:59.215 +03:00 [INF] Now listening on: http://localhost:5069
2025-09-07 14:58:59.308 +03:00 [INF] Starting Hangfire Server using job storage: 'Server: mysql-3581f657-omargamal1132004-b0c1.b.aivencloud.com@Fashion_Site'
2025-09-07 14:58:59.311 +03:00 [INF] Using the following options for SQL Server job storage:
2025-09-07 14:58:59.313 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-09-07 14:58:59.314 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-09-07 14:58:59.326 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-07 14:58:59.328 +03:00 [INF] Hosting environment: Development
2025-09-07 14:58:59.330 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-09-07 14:58:59.522 +03:00 [INF] Server mrrobot:10232:4790b1ea successfully announced in 188.4632 ms
2025-09-07 14:58:59.531 +03:00 [INF] Server mrrobot:10232:4790b1ea is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-09-07 14:58:59.628 +03:00 [INF] Server mrrobot:10232:4790b1ea all the dispatchers started
2025-09-07 14:59:00.135 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-09-07 14:59:00.452 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 318.6244ms
2025-09-07 14:59:00.511 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-09-07 14:59:01.033 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-09-07 14:59:01.045 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 534.2193ms
2025-09-07 14:59:01.058 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 24.2764ms
2025-09-07 14:59:01.150 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-09-07 14:59:01.417 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 267.1808ms
2025-09-07 15:03:20.144 +03:00 [INF] DB tables already exist. Exit install
2025-09-07 15:03:21.331 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-07 15:03:22.309 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-07 15:03:22.997 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-07 15:03:23.171 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-09-07 15:03:23.195 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-07 15:03:23.206 +03:00 [INF] Starting data seeding...
2025-09-07 15:03:23.233 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-07 15:03:23.695 +03:00 [INF] Executed DbCommand (111ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-09-07 15:03:23.783 +03:00 [INF] Role 'Admin' already exists.
2025-09-07 15:03:23.944 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-09-07 15:03:23.952 +03:00 [INF] Role 'User' already exists.
2025-09-07 15:03:24.124 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-09-07 15:03:24.214 +03:00 [INF] Admin user already exists. Skipping provider/method creation.
2025-09-07 15:03:24.220 +03:00 [INF] Data seeding completed successfully.
2025-09-07 15:03:25.567 +03:00 [INF] Now listening on: http://localhost:5069
2025-09-07 15:03:25.661 +03:00 [INF] Starting Hangfire Server using job storage: 'Server: mysql-3581f657-omargamal1132004-b0c1.b.aivencloud.com@Fashion_Site'
2025-09-07 15:03:25.663 +03:00 [INF] Using the following options for SQL Server job storage:
2025-09-07 15:03:25.666 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-09-07 15:03:25.668 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-09-07 15:03:25.679 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-07 15:03:25.681 +03:00 [INF] Hosting environment: Development
2025-09-07 15:03:25.682 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-09-07 15:03:25.892 +03:00 [INF] Server mrrobot:13068:6170f9dd successfully announced in 204.2376 ms
2025-09-07 15:03:25.913 +03:00 [INF] Server mrrobot:13068:6170f9dd is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-09-07 15:03:26.151 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-09-07 15:03:26.394 +03:00 [INF] Server mrrobot:13068:6170f9dd all the dispatchers started
2025-09-07 15:03:26.409 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 258.1449ms
2025-09-07 15:03:26.480 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-09-07 15:03:26.566 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-09-07 15:03:26.576 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 95.4897ms
2025-09-07 15:03:26.618 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 51.8859ms
2025-09-07 15:03:26.997 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-09-07 15:03:27.280 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 282.994ms
2025-09-07 15:04:55.228 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products/1 - null null
2025-09-07 15:04:55.247 +03:00 [WRN] Failed to determine the https port for redirect.
2025-09-07 15:04:55.458 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-07 15:04:55.470 +03:00 [INF] No cached response available for this request.
2025-09-07 15:04:55.494 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetProduct (E-Commerce)'
2025-09-07 15:04:55.532 +03:00 [INF] Route matched with {action = "GetProduct", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.ProductDtos.ProductDetailDto]]] GetProduct(Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-09-07 15:04:55.937 +03:00 [INF] Executing GetProduct for ID: 1
2025-09-07 15:04:55.943 +03:00 [INF] Retrieving product by id: 1, isActive: True, deletedOnly: False
2025-09-07 15:04:55.949 +03:00 [INF] Getting cache for key: Product:1_active:True_deleted:False
2025-09-07 15:04:56.171 +03:00 [WRN] Cache miss for key: Product:1_active:True_deleted:False
2025-09-07 15:04:56.177 +03:00 [INF] Execute GetAll for entity Product
2025-09-07 15:04:56.309 +03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-09-07 15:04:56.498 +03:00 [INF] Executed DbCommand (94ms) [Parameters=[@__id_0='?' (DbType = Int32), @__isActive_1='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`Name`, `t`.`Description`, `t`.`Quantity`, `t`.`Gender`, `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`fitType`, `t`.`IsActive`, `t`.`c`, `t`.`Price`, `t`.`SubCategoryId`, `t`.`c0`, `t`.`Id0`, `t`.`DiscountPercent`, `t`.`IsActive0`, `t`.`StartDate`, `t`.`EndDate`, `t`.`Name0`, `t`.`Description0`, `t0`.`Id`, `t0`.`Url`, `t1`.`Id`, `t1`.`Color`, `t1`.`Size`, `t1`.`Waist`, `t1`.`Length`, `t1`.`Quantity`, `t1`.`ProductId`
FROM (
    SELECT `p`.`Id`, `p`.`Name`, `p`.`Description`, `p`.`Quantity`, `p`.`Gender`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`ModifiedAt`, `p`.`fitType`, `p`.`IsActive`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`))
        ELSE `p`.`Price`
    END AS `c`, `p`.`Price`, `p`.`SubCategoryId`, (`d`.`Id` IS NOT NULL AND (`d`.`DeletedAt` IS NULL)) AND (`d`.`EndDate` > UTC_TIMESTAMP()) AS `c0`, `d`.`Id` AS `Id0`, `d`.`DiscountPercent`, `d`.`IsActive` AS `IsActive0`, `d`.`StartDate`, `d`.`EndDate`, `d`.`Name` AS `Name0`, `d`.`Description` AS `Description0`
    FROM `Products` AS `p`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    WHERE ((`p`.`Id` = @__id_0) AND `p`.`DeletedAt` IS NULL) AND (`p`.`IsActive` = @__isActive_1)
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `i`.`Id`, `i`.`Url`, `i`.`ProductId`
    FROM `Images` AS `i`
    WHERE `i`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`ProductId`
LEFT JOIN (
    SELECT `p0`.`Id`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity`, `p0`.`ProductId`
    FROM `ProductVariants` AS `p0`
    WHERE `p0`.`DeletedAt` IS NULL AND (`p0`.`Quantity` <> 0)
) AS `t1` ON `t`.`Id` = `t1`.`ProductId`
ORDER BY `t`.`Id`, `t`.`Id0`, `t0`.`Id`
2025-09-07 15:04:56.516 +03:00 [INF] Product found: zV4Ok4bWzFGA6KsVb3uZ (ID: 1)
2025-09-07 15:04:56.523 +03:00 [INF] Setting cache for key: Product:1_active:True_deleted:False
2025-09-07 15:04:56.590 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.ProductDtos.ProductDetailDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-07 15:04:56.638 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetProduct (E-Commerce) in 1096.4469ms
2025-09-07 15:04:56.644 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetProduct (E-Commerce)'
2025-09-07 15:04:56.651 +03:00 [INF] The response could not be cached for this request.
2025-09-07 15:04:56.657 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products/1 - 200 1036 application/json; charset=utf-8 1429.4899ms
2025-09-07 15:04:56.802 +03:00 [INF] Cache set successfully for key: Product:1_active:True_deleted:False with tags: [Productwithdata]
2025-09-07 15:05:19.723 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Products/1/Variants - application/json-patch+json 104
2025-09-07 15:05:19.736 +03:00 [INF] CORS policy execution successful.
2025-09-07 15:05:19.794 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-07 15:05:19.803 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-07 15:05:19.818 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-07 15:05:19.821 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Products/1/Variants - 401 0 null 97.9574ms
2025-09-07 15:05:54.332 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Account/login - application/json-patch+json 70
2025-09-07 15:05:54.344 +03:00 [INF] CORS policy execution successful.
2025-09-07 15:05:54.350 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-07 15:05:54.390 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.AccountController.LoginAsync (E-Commerce)'
2025-09-07 15:05:54.422 +03:00 [INF] Route matched with {action = "LoginAsync", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.TokenDtos.TokensDto]]] LoginAsync(E_Commerce.DtoModels.AccountDtos.LoginDTo) on controller E_Commerce.Controllers.AccountController (E-Commerce).
2025-09-07 15:05:54.541 +03:00 [INF] In LoginAsync Method 
2025-09-07 15:05:54.701 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-09-07 15:05:54.833 +03:00 [INF] 🔐 Generating Access Token for User ID: ac03a6c3-9450-420a-9e6e-ea8902c018c5
2025-09-07 15:05:54.848 +03:00 [INF] 🔐 Generating Access Token for User ID: ac03a6c3-9450-420a-9e6e-ea8902c018c5
2025-09-07 15:05:55.016 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedUserName` = @__normalizedUserName_0)
LIMIT 1
2025-09-07 15:05:55.174 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-09-07 15:05:55.521 +03:00 [INF] Executed DbCommand (78ms) [Parameters=[@p22='?' (Size = 255), @p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p23='?' (Size = 4000), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (Size = 256), @p6='?' (DbType = Boolean), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (DbType = DateTime), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 256), @p15='?' (Size = 256), @p16='?' (Size = 4000), @p17='?' (Size = 4000), @p18='?' (DbType = Boolean), @p19='?' (Size = 4000), @p20='?' (DbType = Boolean), @p21='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
UPDATE `AspNetUsers` SET `AccessFailedCount` = @p0, `Age` = @p1, `ConcurrencyStamp` = @p2, `CreateAt` = @p3, `DeletedAt` = @p4, `Email` = @p5, `EmailConfirmed` = @p6, `Gender` = @p7, `ImageId` = @p8, `ImageId1` = @p9, `LastVisit` = @p10, `LockoutEnabled` = @p11, `LockoutEnd` = @p12, `Name` = @p13, `NormalizedEmail` = @p14, `NormalizedUserName` = @p15, `PasswordHash` = @p16, `PhoneNumber` = @p17, `PhoneNumberConfirmed` = @p18, `SecurityStamp` = @p19, `TwoFactorEnabled` = @p20, `UserName` = @p21
WHERE `Id` = @p22 AND `ConcurrencyStamp` = @p23;
SELECT ROW_COUNT();
2025-09-07 15:05:55.847 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__userId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a0`.`Name`
FROM `AspNetUserRoles` AS `a`
INNER JOIN `AspNetRoles` AS `a0` ON `a`.`RoleId` = `a0`.`Id`
WHERE `a`.`UserId` = @__userId_0
2025-09-07 15:05:55.914 +03:00 [INF] ✅ Access Token generated successfully for User ID: ac03a6c3-9450-420a-9e6e-ea8902c018c5
2025-09-07 15:05:55.918 +03:00 [INF] 🔑 Generating Refresh Token for User ID: ac03a6c3-9450-420a-9e6e-ea8902c018c5
2025-09-07 15:05:56.135 +03:00 [INF] ✅ RefreshToken generated and stored for User ID: ac03a6c3-9450-420a-9e6e-ea8902c018c5
2025-09-07 15:05:56.179 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.TokenDtos.TokensDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-07 15:05:56.191 +03:00 [INF] Executed action E_Commerce.Controllers.AccountController.LoginAsync (E-Commerce) in 1762.7875ms
2025-09-07 15:05:56.195 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.AccountController.LoginAsync (E-Commerce)'
2025-09-07 15:05:56.200 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Account/login - 200 1251 application/json; charset=utf-8 1867.4022ms
2025-09-07 15:06:19.756 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Products/1/Variants - application/json-patch+json 104
2025-09-07 15:06:19.763 +03:00 [INF] CORS policy execution successful.
2025-09-07 15:06:19.969 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-07 15:06:20.140 +03:00 [INF] Executed DbCommand (72ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-07 15:06:20.152 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductVariantController.CreateVariants (E-Commerce)'
2025-09-07 15:06:20.159 +03:00 [INF] Route matched with {action = "CreateVariants", controller = "ProductVariant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.ProductVariantDto]]]] CreateVariants(Int32, System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.CreateProductVariantDto]) on controller E_Commerce.Controllers.ProductVariantController (E-Commerce).
2025-09-07 15:06:20.196 +03:00 [INF] Adding variants to product: 1
2025-09-07 15:06:20.349 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Products` AS `p`
    WHERE (`p`.`Id` = @__id_0) AND `p`.`DeletedAt` IS NULL)
2025-09-07 15:06:20.607 +03:00 [INF] Checking if variant with color=string2, size="S", waist=21, length=21 already exists for product 1
2025-09-07 15:06:20.713 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__productid_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p`
    WHERE `p`.`ProductId` = @__productid_0)
2025-09-07 15:06:20.728 +03:00 [WRN] Duplicate variant found for product 1 (Color=string2, Size="S", Waist=21, Length=21)
2025-09-07 15:06:20.829 +03:00 [WRN] No new variants added for product 1. All were duplicates.
2025-09-07 15:06:20.844 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.ProductDtos.ProductVariantDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-07 15:06:20.854 +03:00 [INF] Executed action E_Commerce.Controllers.ProductVariantController.CreateVariants (E-Commerce) in 689.2268ms
2025-09-07 15:06:20.864 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductVariantController.CreateVariants (E-Commerce)'
2025-09-07 15:06:20.869 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Products/1/Variants - 400 285 application/json; charset=utf-8 1113.011ms
2025-09-07 15:06:37.961 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Products/1/Variants - application/json-patch+json 105
2025-09-07 15:06:37.972 +03:00 [INF] CORS policy execution successful.
2025-09-07 15:06:38.010 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-07 15:06:38.172 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-07 15:06:38.180 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductVariantController.CreateVariants (E-Commerce)'
2025-09-07 15:06:38.186 +03:00 [INF] Route matched with {action = "CreateVariants", controller = "ProductVariant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.ProductVariantDto]]]] CreateVariants(Int32, System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.CreateProductVariantDto]) on controller E_Commerce.Controllers.ProductVariantController (E-Commerce).
2025-09-07 15:06:38.192 +03:00 [INF] Adding variants to product: 1
2025-09-07 15:06:38.344 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Products` AS `p`
    WHERE (`p`.`Id` = @__id_0) AND `p`.`DeletedAt` IS NULL)
2025-09-07 15:06:38.578 +03:00 [INF] Checking if variant with color=string25, size="S", waist=21, length=21 already exists for product 1
2025-09-07 15:06:38.661 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__productid_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p`
    WHERE `p`.`ProductId` = @__productid_0)
2025-09-07 15:06:38.670 +03:00 [WRN] Duplicate variant found for product 1 (Color=string25, Size="S", Waist=21, Length=21)
2025-09-07 15:06:38.750 +03:00 [WRN] No new variants added for product 1. All were duplicates.
2025-09-07 15:06:38.755 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.ProductDtos.ProductVariantDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-07 15:06:38.761 +03:00 [INF] Executed action E_Commerce.Controllers.ProductVariantController.CreateVariants (E-Commerce) in 570.5211ms
2025-09-07 15:06:38.770 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductVariantController.CreateVariants (E-Commerce)'
2025-09-07 15:06:38.773 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Products/1/Variants - 400 286 application/json; charset=utf-8 812.2888ms
2025-09-07 15:08:26.596 +03:00 [INF] 2 servers were removed due to timeout
2025-09-07 15:10:05.490 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Products/1/Variants - application/json-patch+json 105
2025-09-07 15:10:05.506 +03:00 [INF] CORS policy execution successful.
2025-09-07 15:10:05.573 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-07 15:10:05.726 +03:00 [INF] Executed DbCommand (72ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-07 15:10:05.733 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductVariantController.CreateVariants (E-Commerce)'
2025-09-07 15:10:05.740 +03:00 [INF] Route matched with {action = "CreateVariants", controller = "ProductVariant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.ProductVariantDto]]]] CreateVariants(Int32, System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.CreateProductVariantDto]) on controller E_Commerce.Controllers.ProductVariantController (E-Commerce).
2025-09-07 15:10:05.798 +03:00 [INF] Adding variants to product: 1
2025-09-07 15:10:05.951 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Products` AS `p`
    WHERE (`p`.`Id` = @__id_0) AND `p`.`DeletedAt` IS NULL)
2025-09-07 15:10:06.199 +03:00 [INF] Checking if variant with color=string25, size="S", waist=21, length=21 already exists for product 1
2025-09-07 15:10:06.292 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__productId_0='?' (DbType = Int32), @__color_1='?' (Size = 4000), @__size_Value_2='?' (DbType = Int32), @__waist_Value_3='?' (DbType = Int32), @__length_Value_4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p`
    WHERE ((((`p`.`ProductId` = @__productId_0) AND (`p`.`Color` = @__color_1)) AND (`p`.`Size` = @__size_Value_2)) AND (`p`.`Waist` = @__waist_Value_3)) AND (`p`.`Length` = @__length_Value_4))
2025-09-07 15:10:06.322 +03:00 [INF] Executing CreateRangeAsync for entity ProductVariant
2025-09-07 15:10:06.384 +03:00 [INF] 1 ProductVariant entities added successfully (pending save)
2025-09-07 15:10:07.362 +03:00 [INF] Execute AddAdminOpreationAsync
2025-09-07 15:10:07.381 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-09-07 15:10:07.422 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-09-07 15:10:07.666 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (Size = 255), @p11='?' (DbType = DateTime), @p12='?' (DbType = DateTime), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = DateTime), @p16='?' (DbType = Int32), @p17='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `ProductVariants` (`Color`, `CreatedAt`, `DeletedAt`, `IsActive`, `Length`, `ModifiedAt`, `ProductId`, `Quantity`, `Size`, `Waist`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT `Id`
FROM `ProductVariants`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-09-07 15:10:08.769 +03:00 [INF] Successfully added 1 variant(s) to product 1
2025-09-07 15:10:08.784 +03:00 [INF] Executing CreatedAtActionResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.ProductDtos.ProductVariantDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-07 15:10:08.798 +03:00 [INF] Executed action E_Commerce.Controllers.ProductVariantController.CreateVariants (E-Commerce) in 3053.4596ms
2025-09-07 15:10:08.803 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductVariantController.CreateVariants (E-Commerce)'
2025-09-07 15:10:08.806 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: No route matches the supplied values.
   at Microsoft.AspNetCore.Mvc.CreatedAtActionResult.OnFormatting(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor.ExecuteAsyncCore(ActionContext context, ObjectResult result, Type objectType, Object value)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor.ExecuteAsync(ActionContext context, ObjectResult result)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at SecurityStampMiddleware.Invoke(HttpContext context)
   at E_Commerce.Middleware.UserAuthenticationMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.RateLimiting.RateLimitingMiddleware.InvokeInternal(HttpContext context, EnableRateLimitingAttribute enableRateLimitingAttribute)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-09-07 15:10:08.892 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Products/1/Variants - 500 null text/plain; charset=utf-8 3401.9805ms
2025-09-07 15:10:10.370 +03:00 [INF] Removing cache by tags: [variantlist, variantdata]
2025-09-07 15:10:10.486 +03:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__productid_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`Description`, `t`.`DiscountId`, `t`.`Gender`, `t`.`IsActive`, `t`.`ModifiedAt`, `t`.`Name`, `t`.`Price`, `t`.`Quantity`, `t`.`SubCategoryId`, `t`.`fitType`, `p0`.`Id`, `p0`.`Color`, `p0`.`CreatedAt`, `p0`.`DeletedAt`, `p0`.`IsActive`, `p0`.`Length`, `p0`.`ModifiedAt`, `p0`.`ProductId`, `p0`.`Quantity`, `p0`.`Size`, `p0`.`Waist`
FROM (
    SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
    FROM `Products` AS `p`
    WHERE (`p`.`Id` = @__productid_0) AND `p`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN `ProductVariants` AS `p0` ON `t`.`Id` = `p0`.`ProductId`
ORDER BY `t`.`Id`
2025-09-07 15:10:10.535 +03:00 [ERR] An exception occurred while iterating over the results of a query for context type 'E_Commerce.Context.AppDbContext'.
System.InvalidOperationException: Connection must be Open; current state is Closed
   at MySqlConnector.MySqlConnection.get_Session() in /_/src/MySqlConnector/MySqlConnection.cs:line 733
   at MySqlConnector.Core.ICancellableCommandExtensions.ResetCommandTimeout(ICancellableCommand command) in /_/src/MySqlConnector/Core/ICancellableCommand.cs:line 42
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 355
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: Connection must be Open; current state is Closed
   at MySqlConnector.MySqlConnection.get_Session() in /_/src/MySqlConnector/MySqlConnection.cs:line 733
   at MySqlConnector.Core.ICancellableCommandExtensions.ResetCommandTimeout(ICancellableCommand command) in /_/src/MySqlConnector/Core/ICancellableCommand.cs:line 42
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 355
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-09-07 15:10:14.134 +03:00 [INF] Removed 14 cache entries for tags: [variantlist, variantdata]
2025-09-07 15:10:35.598 +03:00 [WRN] Stopping the server due to DomainUnload or ProcessExit event...
2025-09-07 15:10:35.601 +03:00 [INF] Server mrrobot:13068:6170f9dd caught stopping signal...
2025-09-07 15:10:35.604 +03:00 [INF] Server mrrobot:13068:6170f9dd caught stopped signal...
2025-09-07 15:10:35.610 +03:00 [INF] Server mrrobot:13068:6170f9dd All dispatchers stopped
2025-09-07 15:10:35.612 +03:00 [WRN] Server mrrobot:13068:6170f9dd caught shutdown signal...
2025-09-07 15:10:36.202 +03:00 [INF] Server mrrobot:13068:6170f9dd successfully reported itself as stopped in 584.457 ms
2025-09-07 15:10:36.204 +03:00 [INF] Server mrrobot:13068:6170f9dd has been stopped in total 599.9089 ms
2025-09-07 15:10:48.211 +03:00 [INF] DB tables already exist. Exit install
2025-09-07 15:10:49.463 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-07 15:10:50.707 +03:00 [INF] Executed DbCommand (134ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-07 15:10:51.467 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-07 15:10:51.641 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-09-07 15:10:51.663 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-07 15:10:51.675 +03:00 [INF] Starting data seeding...
2025-09-07 15:10:51.701 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-07 15:10:52.240 +03:00 [INF] Executed DbCommand (107ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-09-07 15:10:52.300 +03:00 [INF] Role 'Admin' already exists.
2025-09-07 15:10:52.466 +03:00 [INF] Executed DbCommand (83ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-09-07 15:10:52.476 +03:00 [INF] Role 'User' already exists.
2025-09-07 15:10:52.647 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-09-07 15:10:52.746 +03:00 [INF] Admin user already exists. Skipping provider/method creation.
2025-09-07 15:10:52.752 +03:00 [INF] Data seeding completed successfully.
2025-09-07 15:10:53.958 +03:00 [INF] Now listening on: http://localhost:5069
2025-09-07 15:10:54.035 +03:00 [INF] Starting Hangfire Server using job storage: 'Server: mysql-3581f657-omargamal1132004-b0c1.b.aivencloud.com@Fashion_Site'
2025-09-07 15:10:54.037 +03:00 [INF] Using the following options for SQL Server job storage:
2025-09-07 15:10:54.041 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-09-07 15:10:54.046 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-09-07 15:10:54.060 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-07 15:10:54.063 +03:00 [INF] Hosting environment: Development
2025-09-07 15:10:54.066 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-09-07 15:10:54.249 +03:00 [INF] Server mrrobot:7304:6c9f37ee successfully announced in 181.2574 ms
2025-09-07 15:10:54.257 +03:00 [INF] Server mrrobot:7304:6c9f37ee is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-09-07 15:10:54.331 +03:00 [INF] Server mrrobot:7304:6c9f37ee all the dispatchers started
2025-09-07 15:10:54.652 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-09-07 15:10:54.869 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 214.1601ms
2025-09-07 15:10:54.966 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-09-07 15:10:55.233 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-09-07 15:10:55.243 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 277.3282ms
2025-09-07 15:10:55.256 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 23.1159ms
2025-09-07 15:10:55.418 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-09-07 15:10:55.729 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 310.8024ms
2025-09-07 15:11:27.642 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Products/1/Variants - application/json-patch+json 106
2025-09-07 15:11:27.655 +03:00 [INF] CORS policy execution successful.
2025-09-07 15:11:27.662 +03:00 [WRN] Failed to determine the https port for redirect.
2025-09-07 15:11:27.811 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-09-07 15:11:28.016 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-09-07 15:11:28.037 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductVariantController.CreateVariants (E-Commerce)'
2025-09-07 15:11:28.067 +03:00 [INF] Route matched with {action = "CreateVariants", controller = "ProductVariant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.ProductVariantDto]]]] CreateVariants(Int32, System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.CreateProductVariantDto]) on controller E_Commerce.Controllers.ProductVariantController (E-Commerce).
2025-09-07 15:11:28.401 +03:00 [INF] Adding variants to product: 1
2025-09-07 15:11:28.561 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Products` AS `p`
    WHERE (`p`.`Id` = @__id_0) AND `p`.`DeletedAt` IS NULL)
2025-09-07 15:11:28.801 +03:00 [INF] Checking if variant with color=string2, size="L", waist=100, length=200 already exists for product 1
2025-09-07 15:11:28.897 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__productId_0='?' (DbType = Int32), @__color_1='?' (Size = 4000), @__size_Value_2='?' (DbType = Int32), @__waist_Value_3='?' (DbType = Int32), @__length_Value_4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p`
    WHERE ((((`p`.`ProductId` = @__productId_0) AND (`p`.`Color` = @__color_1)) AND (`p`.`Size` = @__size_Value_2)) AND (`p`.`Waist` = @__waist_Value_3)) AND (`p`.`Length` = @__length_Value_4))
2025-09-07 15:11:28.911 +03:00 [INF] Executing CreateRangeAsync for entity ProductVariant
2025-09-07 15:11:28.978 +03:00 [INF] 1 ProductVariant entities added successfully (pending save)
2025-09-07 15:11:29.926 +03:00 [INF] Execute AddAdminOpreationAsync
2025-09-07 15:11:29.933 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-09-07 15:11:29.975 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-09-07 15:11:30.306 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (Size = 255), @p11='?' (DbType = DateTime), @p12='?' (DbType = DateTime), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = DateTime), @p16='?' (DbType = Int32), @p17='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `ProductVariants` (`Color`, `CreatedAt`, `DeletedAt`, `IsActive`, `Length`, `ModifiedAt`, `ProductId`, `Quantity`, `Size`, `Waist`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT `Id`
FROM `ProductVariants`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-09-07 15:11:31.381 +03:00 [INF] Successfully added 1 variant(s) to product 1
2025-09-07 15:11:31.397 +03:00 [INF] Executing CreatedAtActionResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.ProductDtos.ProductVariantDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-07 15:11:31.427 +03:00 [INF] Executed action E_Commerce.Controllers.ProductVariantController.CreateVariants (E-Commerce) in 3348.6739ms
2025-09-07 15:11:31.438 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductVariantController.CreateVariants (E-Commerce)'
2025-09-07 15:11:31.449 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: No route matches the supplied values.
   at Microsoft.AspNetCore.Mvc.CreatedAtActionResult.OnFormatting(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor.ExecuteAsyncCore(ActionContext context, ObjectResult result, Type objectType, Object value)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor.ExecuteAsync(ActionContext context, ObjectResult result)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at SecurityStampMiddleware.Invoke(HttpContext context) in D:\project_fashion\E-Commerce-API-main\MiddleWares\SecurityStampMiddleware.cs:line 75
   at E_Commerce.Middleware.UserAuthenticationMiddleware.InvokeAsync(HttpContext context) in D:\project_fashion\E-Commerce-API-main\MiddleWares\UserAuthenticationMiddleware.cs:line 38
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.RateLimiting.RateLimitingMiddleware.InvokeInternal(HttpContext context, EnableRateLimitingAttribute enableRateLimitingAttribute)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-09-07 15:11:31.513 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Products/1/Variants - 500 null text/plain; charset=utf-8 3870.4643ms
2025-09-07 15:11:37.519 +03:00 [INF] Removing cache by tags: [variantlist, variantdata]
2025-09-07 15:11:37.680 +03:00 [ERR] Failed executing DbCommand (4ms) [Parameters=[@__productid_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`Description`, `t`.`DiscountId`, `t`.`Gender`, `t`.`IsActive`, `t`.`ModifiedAt`, `t`.`Name`, `t`.`Price`, `t`.`Quantity`, `t`.`SubCategoryId`, `t`.`fitType`, `p0`.`Id`, `p0`.`Color`, `p0`.`CreatedAt`, `p0`.`DeletedAt`, `p0`.`IsActive`, `p0`.`Length`, `p0`.`ModifiedAt`, `p0`.`ProductId`, `p0`.`Quantity`, `p0`.`Size`, `p0`.`Waist`
FROM (
    SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
    FROM `Products` AS `p`
    WHERE (`p`.`Id` = @__productid_0) AND `p`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN `ProductVariants` AS `p0` ON `t`.`Id` = `p0`.`ProductId`
ORDER BY `t`.`Id`
2025-09-07 15:11:37.712 +03:00 [ERR] An exception occurred while iterating over the results of a query for context type 'E_Commerce.Context.AppDbContext'.
System.InvalidOperationException: Connection must be Open; current state is Closed
   at MySqlConnector.MySqlConnection.get_Session() in /_/src/MySqlConnector/MySqlConnection.cs:line 733
   at MySqlConnector.Core.ICancellableCommandExtensions.ResetCommandTimeout(ICancellableCommand command) in /_/src/MySqlConnector/Core/ICancellableCommand.cs:line 42
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 355
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: Connection must be Open; current state is Closed
   at MySqlConnector.MySqlConnection.get_Session() in /_/src/MySqlConnector/MySqlConnection.cs:line 733
   at MySqlConnector.Core.ICancellableCommandExtensions.ResetCommandTimeout(ICancellableCommand command) in /_/src/MySqlConnector/Core/ICancellableCommand.cs:line 42
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 355
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-09-07 15:11:37.957 +03:00 [WRN] No cache entries found for tags: [variantlist, variantdata]
2025-09-07 15:13:42.864 +03:00 [INF] DB tables already exist. Exit install
2025-09-07 15:13:44.957 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-07 15:13:46.286 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-07 15:13:46.970 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-09-07 15:13:47.149 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-09-07 15:13:47.182 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-07 15:13:47.233 +03:00 [INF] Starting data seeding...
2025-09-07 15:13:47.327 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-07 15:13:48.498 +03:00 [INF] Executed DbCommand (137ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-09-07 15:13:48.651 +03:00 [INF] Role 'Admin' already exists.
2025-09-07 15:13:48.865 +03:00 [INF] Executed DbCommand (95ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-09-07 15:13:48.871 +03:00 [INF] Role 'User' already exists.
2025-09-07 15:13:49.149 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-09-07 15:13:49.413 +03:00 [INF] Admin user already exists. Skipping provider/method creation.
2025-09-07 15:13:49.443 +03:00 [INF] Data seeding completed successfully.
2025-09-07 15:13:51.598 +03:00 [INF] Now listening on: http://localhost:5069
2025-09-07 15:13:51.751 +03:00 [INF] Starting Hangfire Server using job storage: 'Server: mysql-3581f657-omargamal1132004-b0c1.b.aivencloud.com@Fashion_Site'
2025-09-07 15:13:51.765 +03:00 [INF] Using the following options for SQL Server job storage:
2025-09-07 15:13:51.772 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-09-07 15:13:51.786 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-09-07 15:13:51.827 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-07 15:13:51.849 +03:00 [INF] Hosting environment: Development
2025-09-07 15:13:51.853 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-09-07 15:13:52.140 +03:00 [INF] Server mrrobot:16612:1a06f4a2 successfully announced in 286.4136 ms
2025-09-07 15:13:52.731 +03:00 [INF] Server mrrobot:16612:1a06f4a2 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-09-07 15:13:53.897 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-09-07 15:13:54.348 +03:00 [INF] Server mrrobot:16612:1a06f4a2 all the dispatchers started
2025-09-07 15:13:54.494 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 766.4024ms
2025-09-07 15:13:54.732 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-09-07 15:13:54.743 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 10.68ms
2025-09-07 15:13:54.803 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-09-07 15:13:54.815 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 12.2108ms
2025-09-07 15:13:55.164 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-09-07 15:13:55.643 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 479.7111ms
