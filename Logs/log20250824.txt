2025-08-24 23:30:08.359 +03:00 [INF] DB tables already exist. Exit install
2025-08-24 23:30:10.860 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-08-24 23:30:12.450 +03:00 [INF] Executed DbCommand (139ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-24 23:30:13.707 +03:00 [INF] Executed DbCommand (137ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-24 23:30:14.014 +03:00 [INF] Executed DbCommand (146ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-24 23:30:14.045 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-24 23:30:14.063 +03:00 [INF] Starting data seeding...
2025-08-24 23:30:14.099 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-24 23:30:14.719 +03:00 [INF] Executed DbCommand (182ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-24 23:30:14.790 +03:00 [INF] Role 'Admin' already exists.
2025-08-24 23:30:15.075 +03:00 [INF] Executed DbCommand (137ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-24 23:30:15.083 +03:00 [INF] Role 'User' already exists.
2025-08-24 23:30:15.414 +03:00 [INF] Executed DbCommand (170ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-24 23:30:15.499 +03:00 [INF] Admin user already exists. Skipping provider/method creation.
2025-08-24 23:30:15.504 +03:00 [INF] Data seeding completed successfully.
2025-08-24 23:30:18.288 +03:00 [INF] Now listening on: http://localhost:5069
2025-08-24 23:30:18.409 +03:00 [INF] Starting Hangfire Server using job storage: 'Server: mysql-3581f657-omargamal1132004-b0c1.b.aivencloud.com@Fashion_Site'
2025-08-24 23:30:18.463 +03:00 [INF] Using the following options for SQL Server job storage:
2025-08-24 23:30:18.464 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-08-24 23:30:18.466 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-24 23:30:18.497 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-24 23:30:18.528 +03:00 [INF] Hosting environment: Development
2025-08-24 23:30:18.573 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-08-24 23:30:18.823 +03:00 [INF] Server mrrobot:18924:fdbb38fe successfully announced in 294.8253 ms
2025-08-24 23:30:18.828 +03:00 [INF] Server mrrobot:18924:fdbb38fe is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-24 23:30:18.857 +03:00 [INF] Server mrrobot:18924:fdbb38fe all the dispatchers started
2025-08-24 23:30:19.618 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-24 23:30:20.557 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 944.9698ms
2025-08-24 23:30:20.604 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-24 23:30:20.617 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-24 23:30:20.618 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-24 23:30:20.736 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 131.3435ms
2025-08-24 23:30:20.750 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 132.7444ms
2025-08-24 23:30:20.859 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 241.3372ms
2025-08-24 23:30:20.940 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-24 23:30:21.319 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 378.9685ms
2025-08-24 23:31:19.832 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Account/login - application/json-patch+json 70
2025-08-24 23:31:19.848 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:31:19.853 +03:00 [WRN] Failed to determine the https port for redirect.
2025-08-24 23:31:21.450 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-24 23:31:21.466 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.AccountController.LoginAsync (E-Commerce)'
2025-08-24 23:31:21.497 +03:00 [INF] Route matched with {action = "LoginAsync", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.TokenDtos.TokensDto]]] LoginAsync(E_Commerce.DtoModels.AccountDtos.LoginDTo) on controller E_Commerce.Controllers.AccountController (E-Commerce).
2025-08-24 23:31:21.857 +03:00 [INF] In LoginAsync Method 
2025-08-24 23:31:22.147 +03:00 [INF] Executed DbCommand (142ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-24 23:31:22.276 +03:00 [INF] üîê Generating Access Token for User ID: d1c4400e-e5cc-4af0-919e-8b1fded727fe
2025-08-24 23:31:22.282 +03:00 [INF] üîê Generating Access Token for User ID: d1c4400e-e5cc-4af0-919e-8b1fded727fe
2025-08-24 23:31:22.578 +03:00 [INF] Executed DbCommand (141ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedUserName` = @__normalizedUserName_0)
LIMIT 1
2025-08-24 23:31:22.871 +03:00 [INF] Executed DbCommand (140ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-24 23:31:23.288 +03:00 [INF] Executed DbCommand (147ms) [Parameters=[@p22='?' (Size = 255), @p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p23='?' (Size = 4000), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (Size = 256), @p6='?' (DbType = Boolean), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (DbType = DateTime), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 256), @p15='?' (Size = 256), @p16='?' (Size = 4000), @p17='?' (Size = 4000), @p18='?' (DbType = Boolean), @p19='?' (Size = 4000), @p20='?' (DbType = Boolean), @p21='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
UPDATE `AspNetUsers` SET `AccessFailedCount` = @p0, `Age` = @p1, `ConcurrencyStamp` = @p2, `CreateAt` = @p3, `DeletedAt` = @p4, `Email` = @p5, `EmailConfirmed` = @p6, `Gender` = @p7, `ImageId` = @p8, `ImageId1` = @p9, `LastVisit` = @p10, `LockoutEnabled` = @p11, `LockoutEnd` = @p12, `Name` = @p13, `NormalizedEmail` = @p14, `NormalizedUserName` = @p15, `PasswordHash` = @p16, `PhoneNumber` = @p17, `PhoneNumberConfirmed` = @p18, `SecurityStamp` = @p19, `TwoFactorEnabled` = @p20, `UserName` = @p21
WHERE `Id` = @p22 AND `ConcurrencyStamp` = @p23;
SELECT ROW_COUNT();
2025-08-24 23:31:23.644 +03:00 [INF] Executed DbCommand (139ms) [Parameters=[@__userId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a0`.`Name`
FROM `AspNetUserRoles` AS `a`
INNER JOIN `AspNetRoles` AS `a0` ON `a`.`RoleId` = `a0`.`Id`
WHERE `a`.`UserId` = @__userId_0
2025-08-24 23:31:23.739 +03:00 [INF] ‚úÖ Access Token generated successfully for User ID: d1c4400e-e5cc-4af0-919e-8b1fded727fe
2025-08-24 23:31:23.744 +03:00 [INF] üîë Generating Refresh Token for User ID: d1c4400e-e5cc-4af0-919e-8b1fded727fe
2025-08-24 23:31:23.965 +03:00 [INF] ‚úÖ RefreshToken generated and stored for User ID: d1c4400e-e5cc-4af0-919e-8b1fded727fe
2025-08-24 23:31:24.007 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.TokenDtos.TokensDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-24 23:31:24.038 +03:00 [INF] Executed action E_Commerce.Controllers.AccountController.LoginAsync (E-Commerce) in 2529.42ms
2025-08-24 23:31:24.043 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.AccountController.LoginAsync (E-Commerce)'
2025-08-24 23:31:24.054 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Account/login - 200 1251 application/json; charset=utf-8 4222.1252ms
2025-08-24 23:32:34.033 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products?isActive=true&page=1&pageSize=10 - null null
2025-08-24 23:32:34.178 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-24 23:32:34.584 +03:00 [INF] Executed DbCommand (139ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-24 23:32:34.592 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetProducts (E-Commerce)'
2025-08-24 23:32:34.609 +03:00 [INF] Route matched with {action = "GetProducts", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.ProductDto]]]] GetProducts(System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean], Int32, Int32) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-24 23:32:34.655 +03:00 [INF] Getting cache for key: advsearch__________False_1_10_True_
2025-08-24 23:32:34.874 +03:00 [WRN] Cache miss for key: advsearch__________False_1_10_True_
2025-08-24 23:32:34.877 +03:00 [INF] Execute GetAll for entity Product
2025-08-24 23:32:35.305 +03:00 [INF] Executed DbCommand (160ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`Name`, `t`.`Description`, `t`.`Quantity`, `t`.`Gender`, `t`.`SubCategoryId`, `t`.`Price`, `t`.`CreatedAt`, `t`.`ModifiedAt`, `t`.`DeletedAt`, `t`.`fitType`, `t`.`IsActive`, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `t`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `t`.`Price`)
    ELSE `t`.`Price`
END, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`EndDate`
    ELSE NULL
END, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
    ELSE NULL
END, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
    ELSE 0.0
END, `d`.`Id`, `i`.`Id`, `i`.`Url`
FROM (
    SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
    FROM `Products` AS `p`
    WHERE `p`.`IsActive`
    ORDER BY `p`.`Name`
    LIMIT @__p_1 OFFSET @__p_0
) AS `t`
LEFT JOIN `Discount` AS `d` ON `t`.`DiscountId` = `d`.`Id`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`ProductId`
ORDER BY `t`.`Name`, `t`.`Id`, `d`.`Id`
2025-08-24 23:32:37.099 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.ProductDtos.ProductDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-24 23:32:37.110 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetProducts (E-Commerce) in 2497.2109ms
2025-08-24 23:32:37.121 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetProducts (E-Commerce)'
2025-08-24 23:32:37.125 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products?isActive=true&page=1&pageSize=10 - 200 601 application/json; charset=utf-8 3092.4141ms
2025-08-24 23:32:39.955 +03:00 [INF] Setting cache for key: advsearch__________False_1_10_True_
2025-08-24 23:32:40.225 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_10_True_ with tags: [product_search]
2025-08-24 23:33:32.573 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products/1 - null null
2025-08-24 23:33:32.593 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-24 23:33:32.892 +03:00 [INF] Executed DbCommand (137ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-24 23:33:32.896 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetProduct (E-Commerce)'
2025-08-24 23:33:32.907 +03:00 [INF] Route matched with {action = "GetProduct", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.ProductDtos.ProductDetailDto]]] GetProduct(Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-24 23:33:32.919 +03:00 [INF] Executing GetProduct for ID: 1
2025-08-24 23:33:32.925 +03:00 [INF] Retrieving product by id: 1, isActive: , deletedOnly: 
2025-08-24 23:33:32.927 +03:00 [INF] Getting cache for key: product_detail:1:isActive=:deletedOnly=
2025-08-24 23:33:33.143 +03:00 [WRN] Cache miss for key: product_detail:1:isActive=:deletedOnly=
2025-08-24 23:33:33.145 +03:00 [INF] Execute GetAll for entity Product
2025-08-24 23:33:33.187 +03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-08-24 23:33:33.503 +03:00 [INF] Executed DbCommand (157ms) [Parameters=[@__8__locals1_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`Name`, `t`.`Description`, `t`.`Quantity`, `t`.`Gender`, `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`IsActive`, `t`.`Price`, `t`.`c`, `t`.`fitType`, `t`.`SubCategoryId`, `t`.`c0`, `t`.`Id0`, `t`.`DiscountPercent`, `t`.`IsActive0`, `t`.`StartDate`, `t`.`EndDate`, `t`.`Name0`, `t`.`Description0`, `t0`.`Id`, `t0`.`Url`, `t1`.`Id`, `t1`.`IsActive`, `t1`.`CreatedAt`, `t1`.`ModifiedAt`, `t1`.`DeletedAt`, `t1`.`Color`, `t1`.`Size`, `t1`.`Waist`, `t1`.`Length`, `t1`.`Quantity`, `t1`.`ProductId`
FROM (
    SELECT `p`.`Id`, `p`.`Name`, `p`.`Description`, `p`.`Quantity`, `p`.`Gender`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`ModifiedAt`, `p`.`IsActive`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`))
        ELSE `p`.`Price`
    END AS `c`, `p`.`fitType`, `p`.`SubCategoryId`, ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) AS `c0`, `d`.`Id` AS `Id0`, `d`.`DiscountPercent`, `d`.`IsActive` AS `IsActive0`, `d`.`StartDate`, `d`.`EndDate`, `d`.`Name` AS `Name0`, `d`.`Description` AS `Description0`
    FROM `Products` AS `p`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    WHERE `p`.`Id` = @__8__locals1_id_0
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `i`.`Id`, `i`.`Url`, `i`.`ProductId`
    FROM `Images` AS `i`
    WHERE `i`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`ProductId`
LEFT JOIN (
    SELECT `p0`.`Id`, `p0`.`IsActive`, `p0`.`CreatedAt`, `p0`.`ModifiedAt`, `p0`.`DeletedAt`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity`, `p0`.`ProductId`
    FROM `ProductVariants` AS `p0`
    WHERE (`p0`.`DeletedAt` IS NULL AND `p0`.`IsActive`) AND (`p0`.`Quantity` <> 0)
) AS `t1` ON `t`.`Id` = `t1`.`ProductId`
ORDER BY `t`.`Id`, `t`.`Id0`, `t0`.`Id`
2025-08-24 23:33:33.514 +03:00 [INF] Product found: Qzd8sBPB1SKOKxjWJCHS (ID: 1)
2025-08-24 23:33:35.189 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.ProductDtos.ProductDetailDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-24 23:33:35.203 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetProduct (E-Commerce) in 2292.9517ms
2025-08-24 23:33:35.206 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetProduct (E-Commerce)'
2025-08-24 23:33:35.208 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products/1 - 200 732 application/json; charset=utf-8 2635.1097ms
2025-08-24 23:33:38.411 +03:00 [INF] Setting cache for key: product_detail:1:isActive=:deletedOnly=
2025-08-24 23:33:38.646 +03:00 [INF] Cache set successfully for key: product_detail:1:isActive=:deletedOnly= with tags: [productwithvariantdata]
2025-08-24 23:34:42.509 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-24 23:34:42.531 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 22.0783ms
2025-08-24 23:34:42.724 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-24 23:34:42.730 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-24 23:34:42.748 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-24 23:34:42.759 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 34.9508ms
2025-08-24 23:34:42.766 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 35.7624ms
2025-08-24 23:34:42.875 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 126.8292ms
2025-08-24 23:34:43.258 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-24 23:34:43.556 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 298.3893ms
2025-08-24 23:35:25.331 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-24 23:35:25.341 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 9.7994ms
2025-08-24 23:35:25.383 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-24 23:35:25.383 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-24 23:35:25.386 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-24 23:35:25.389 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 5.2712ms
2025-08-24 23:35:25.397 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 10.1461ms
2025-08-24 23:35:25.397 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 13.8484ms
2025-08-24 23:35:25.666 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-24 23:35:25.767 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 101.035ms
2025-08-24 23:35:57.405 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-24 23:35:57.419 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 13.7428ms
2025-08-24 23:35:57.646 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-24 23:35:57.648 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-24 23:35:57.650 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 4.4828ms
2025-08-24 23:35:57.650 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-24 23:35:57.661 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 12.9913ms
2025-08-24 23:35:57.666 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 16.0453ms
2025-08-24 23:35:57.846 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-24 23:35:57.984 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 138.6339ms
2025-08-24 23:36:11.466 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/hangfire - null null
2025-08-24 23:36:15.970 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/hangfire - 200 null text/html 4503.418ms
2025-08-24 23:36:15.997 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/hangfire/js18180264919116 - null null
2025-08-24 23:36:15.997 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/hangfire/css-dark181801376156980 - null null
2025-08-24 23:36:15.998 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-24 23:36:15.999 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/hangfire/css181801926633275 - null null
2025-08-24 23:36:16.021 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/hangfire/css-dark181801376156980 - 200 null text/css 24.5824ms
2025-08-24 23:36:16.026 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 28.0982ms
2025-08-24 23:36:16.026 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-24 23:36:16.046 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/hangfire/css181801926633275 - 200 null text/css 46.4699ms
2025-08-24 23:36:16.078 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/hangfire/js18180264919116 - 200 null application/javascript 81.1316ms
2025-08-24 23:36:16.099 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 72.9275ms
2025-08-24 23:36:16.133 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/hangfire/fonts/glyphicons-halflings-regular/woff2 - null null
2025-08-24 23:36:16.163 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:36:16.167 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/hangfire/fonts/glyphicons-halflings-regular/woff2 - 200 null font/woff2 33.6122ms
2025-08-24 23:36:18.243 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 258
2025-08-24 23:36:18.250 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:36:19.048 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/hangfire/jobs/enqueued - null null
2025-08-24 23:36:20.608 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2365.6445ms
2025-08-24 23:36:21.946 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/hangfire/jobs/enqueued - 200 null text/html 2897.8781ms
2025-08-24 23:36:21.969 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-24 23:36:21.968 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-24 23:36:22.046 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 76.0949ms
2025-08-24 23:36:22.069 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 100.6401ms
2025-08-24 23:36:24.067 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:36:24.075 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:36:24.462 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/hangfire/jobs/failed - null null
2025-08-24 23:36:26.988 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2921.0439ms
2025-08-24 23:36:28.628 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/hangfire/jobs/scheduled - null null
2025-08-24 23:36:29.008 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:36:29.014 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:36:29.450 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/hangfire/jobs/failed - 200 null text/html 4988.6248ms
2025-08-24 23:36:31.624 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2616.3181ms
2025-08-24 23:36:33.192 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/hangfire/jobs/scheduled - 200 null text/html 4564.4087ms
2025-08-24 23:36:33.213 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-24 23:36:33.215 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-24 23:36:33.229 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 16.6227ms
2025-08-24 23:36:33.279 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 63.5909ms
2025-08-24 23:36:35.279 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:36:35.297 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:36:37.674 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/hangfire/jobs/failed - null null
2025-08-24 23:36:37.911 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2632.8994ms
2025-08-24 23:36:39.927 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:36:39.939 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:36:42.248 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/hangfire/jobs/failed - 200 null text/html 4573.6718ms
2025-08-24 23:36:42.260 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-24 23:36:42.295 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-24 23:36:42.309 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 49.0964ms
2025-08-24 23:36:42.315 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 20.2699ms
2025-08-24 23:36:42.550 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2622.8086ms
2025-08-24 23:36:44.387 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:36:44.395 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:36:47.003 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2616.8536ms
2025-08-24 23:36:49.017 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:36:49.025 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:36:51.944 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2926.942ms
2025-08-24 23:36:55.170 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/jobs/failed/delete - application/x-www-form-urlencoded; charset=UTF-8 299
2025-08-24 23:36:55.179 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:36:55.185 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:36:55.196 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:36:57.827 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2648.748ms
2025-08-24 23:36:59.834 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:36:59.841 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:37:02.447 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2612.751ms
2025-08-24 23:37:04.452 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:37:04.463 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:37:07.075 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2623.5384ms
2025-08-24 23:37:10.039 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:37:10.045 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:37:12.661 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2622.3953ms
2025-08-24 23:37:15.034 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:37:15.046 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:37:17.668 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2633.418ms
2025-08-24 23:37:20.038 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:37:20.043 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:37:22.656 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2618.7572ms
2025-08-24 23:37:25.041 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:37:25.057 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:37:27.670 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2628.3089ms
2025-08-24 23:37:30.045 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:37:30.052 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:37:32.423 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Cart/items - application/json-patch+json 62
2025-08-24 23:37:32.427 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:37:32.434 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-24 23:37:32.669 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2624.5795ms
2025-08-24 23:37:32.727 +03:00 [INF] Executed DbCommand (137ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-24 23:37:32.749 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-08-24 23:37:32.761 +03:00 [INF] Route matched with {action = "AddItemToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] AddItemToCart(E_Commerce.DtoModels.CartDtos.CreateCartItemDto) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-08-24 23:37:32.771 +03:00 [INF] Executing AddItemToCart for product ID: 1
2025-08-24 23:37:32.784 +03:00 [INF] Adding item to cart for user: d1c4400e-e5cc-4af0-919e-8b1fded727fe, product: 1
2025-08-24 23:37:33.388 +03:00 [INF] Executed DbCommand (139ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-08-24 23:37:33.395 +03:00 [INF] Execute GetAll for entity Product
2025-08-24 23:37:33.561 +03:00 [INF] Executed DbCommand (142ms) [Parameters=[@__itemDto_ProductId_0='?' (DbType = Int32), @__itemDto_ProductVariantId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`Price`, `t`.`c`, `t`.`EndDate`, `t`.`StartDate`, `t`.`DiscountPercent`, `t`.`DeletedAt`, `t`.`IsActive`, `t0`.`Id`, `t0`.`Quantity`, `t0`.`c`
FROM (
    SELECT `p`.`Id`, `p`.`Price`, `d`.`Id` IS NOT NULL AS `c`, `d`.`EndDate`, `d`.`StartDate`, `d`.`DiscountPercent`, `d`.`DeletedAt`, `d`.`IsActive`
    FROM `Products` AS `p`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    WHERE ((`p`.`Id` = @__itemDto_ProductId_0) AND `p`.`DeletedAt` IS NULL) AND `p`.`IsActive`
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `t1`.`Id`, `t1`.`Quantity`, `t1`.`c`, `t1`.`ProductId`
    FROM (
        SELECT `p0`.`Id`, `p0`.`Quantity`, 1 AS `c`, `p0`.`ProductId`, ROW_NUMBER() OVER(PARTITION BY `p0`.`ProductId` ORDER BY `p0`.`Id`) AS `row`
        FROM `ProductVariants` AS `p0`
        WHERE (`p0`.`Id` = @__itemDto_ProductVariantId_1) AND `p0`.`IsActive`
    ) AS `t1`
    WHERE `t1`.`row` <= 1
) AS `t0` ON `t`.`Id` = `t0`.`ProductId`
2025-08-24 23:37:33.578 +03:00 [INF] Retrieving cart for user: d1c4400e-e5cc-4af0-919e-8b1fded727fe
2025-08-24 23:37:33.770 +03:00 [INF] Executed DbCommand (144ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CheckoutDate`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-08-24 23:37:33.830 +03:00 [INF] Executing CreateAsync for entity CartItem
2025-08-24 23:37:33.906 +03:00 [INF] CartItem added successfully (pending save)
2025-08-24 23:37:33.913 +03:00 [INF] Execute AddAdminOpreationAsync
2025-08-24 23:37:33.915 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-08-24 23:37:33.951 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-08-24 23:37:34.312 +03:00 [INF] Executed DbCommand (141ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (Size = 255), @p10='?' (DbType = DateTime), @p11='?' (DbType = DateTime), @p12='?' (Size = 4000), @p13='?' (Size = 4000), @p14='?' (DbType = DateTime), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `CartItems` (`AddedAt`, `CartId`, `CreatedAt`, `DeletedAt`, `ModifiedAt`, `ProductId`, `ProductVariantId`, `Quantity`, `UnitPrice`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
SELECT `Id`
FROM `CartItems`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-08-24 23:37:34.629 +03:00 [INF] Removing cache for key: cart_user_d1c4400e-e5cc-4af0-919e-8b1fded727fe
2025-08-24 23:37:35.030 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:37:35.039 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:37:35.062 +03:00 [INF] Cache removed successfully for key: cart_user_d1c4400e-e5cc-4af0-919e-8b1fded727fe
2025-08-24 23:37:35.066 +03:00 [INF] Item added to cart for user: d1c4400e-e5cc-4af0-919e-8b1fded727fe, product: 1
2025-08-24 23:37:35.070 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-24 23:37:35.077 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce) in 2313.0788ms
2025-08-24 23:37:35.082 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-08-24 23:37:35.085 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Cart/items - 200 134 application/json; charset=utf-8 2661.5377ms
2025-08-24 23:37:37.652 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2621.8785ms
2025-08-24 23:37:40.046 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:37:40.059 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:37:42.687 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2640.8428ms
2025-08-24 23:37:45.031 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:37:45.045 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:37:45.551 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/jobs/failed/delete - 204 null null 50381.0456ms
2025-08-24 23:37:45.577 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/hangfire/jobs/failed - null null
2025-08-24 23:37:47.677 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2646.6273ms
2025-08-24 23:37:50.030 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:37:50.035 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:37:50.165 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/hangfire/jobs/failed - 200 null text/html 4587.5994ms
2025-08-24 23:37:50.205 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-24 23:37:50.228 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 23.0888ms
2025-08-24 23:37:50.236 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-24 23:37:50.241 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 5.3784ms
2025-08-24 23:37:52.672 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2641.8995ms
2025-08-24 23:37:53.046 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:37:53.056 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:37:55.687 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2641.7974ms
2025-08-24 23:37:58.055 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:37:58.066 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:38:00.680 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2625.2937ms
2025-08-24 23:38:03.027 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:38:03.035 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:38:05.658 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2630.6401ms
2025-08-24 23:38:05.798 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Order/create-from-cart - application/json-patch+json 41
2025-08-24 23:38:05.803 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:38:05.813 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-24 23:38:06.094 +03:00 [INF] Executed DbCommand (140ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-24 23:38:06.100 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce)'
2025-08-24 23:38:06.106 +03:00 [INF] Route matched with {action = "CreateOrderFromCart", controller = "Order"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.OrderDtos.OrderWithPaymentDto]]] CreateOrderFromCart(E_Commerce.DtoModels.OrderDtos.CreateOrderDto) on controller E_Commerce.Controllers.OrderController (E-Commerce).
2025-08-24 23:38:06.122 +03:00 [INF] Executing CreateOrderFromCart
2025-08-24 23:38:06.134 +03:00 [INF] Creating order from cart for user: d1c4400e-e5cc-4af0-919e-8b1fded727fe
2025-08-24 23:38:06.696 +03:00 [INF] Executed DbCommand (140ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-08-24 23:38:06.843 +03:00 [INF] Executed DbCommand (139ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-08-24 23:38:06.850 +03:00 [INF] Checking if address 1 exists for customer: d1c4400e-e5cc-4af0-919e-8b1fded727fe
2025-08-24 23:38:06.993 +03:00 [INF] Executed DbCommand (139ms) [Parameters=[@__addressId_0='?' (DbType = Int32), @__customerId_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `CustomerAddresses` AS `c`
    WHERE ((`c`.`Id` = @__addressId_0) AND (`c`.`CustomerId` = @__customerId_1)) AND `c`.`DeletedAt` IS NULL)
2025-08-24 23:38:07.011 +03:00 [INF] Getting cart for user: d1c4400e-e5cc-4af0-919e-8b1fded727fe
2025-08-24 23:38:07.013 +03:00 [INF] Getting cache for key: cart_user_d1c4400e-e5cc-4af0-919e-8b1fded727fe
2025-08-24 23:38:07.228 +03:00 [WRN] Cache miss for key: cart_user_d1c4400e-e5cc-4af0-919e-8b1fded727fe
2025-08-24 23:38:07.369 +03:00 [INF] Executed DbCommand (138ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-08-24 23:38:07.377 +03:00 [INF] Execute GetAll for entity Cart
2025-08-24 23:38:07.577 +03:00 [INF] Executed DbCommand (149ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t`.`CheckoutDate`, `t`.`CreatedAt`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`FinalPrice`, `t0`.`DiscountName`, `t0`.`DiscountPrecentage`, `t0`.`MainImageUrl`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`Id1`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`UnitPrice`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`, `c`.`CheckoutDate`, `c`.`CreatedAt`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`)
        ELSE `p`.`Price`
    END AS `FinalPrice`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `DiscountName`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `DiscountPrecentage`, COALESCE((
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1), (
        SELECT `i0`.`Url`
        FROM `Images` AS `i0`
        WHERE (`p`.`Id` = `i0`.`ProductId`) AND `i0`.`DeletedAt` IS NULL
        LIMIT 1)) AS `MainImageUrl`, `p`.`IsActive`, `p0`.`Color`, `p0`.`Id` AS `Id1`, `p0`.`CreatedAt`, `p0`.`DeletedAt`, `p0`.`ModifiedAt`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `c1`.`UnitPrice`, `d`.`Id` AS `Id2`, `c1`.`CartId`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
    WHERE `p`.`IsActive` AND (`p`.`DeletedAt` IS NULL)
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id2`
2025-08-24 23:38:07.593 +03:00 [INF] Setting cache for key: cart_user_d1c4400e-e5cc-4af0-919e-8b1fded727fe
2025-08-24 23:38:07.829 +03:00 [INF] Cache set successfully for key: cart_user_d1c4400e-e5cc-4af0-919e-8b1fded727fe with tags: [cart]
2025-08-24 23:38:07.984 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.OrderDtos.OrderWithPaymentDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-24 23:38:07.989 +03:00 [INF] Executed action E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce) in 1875.2391ms
2025-08-24 23:38:07.996 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce)'
2025-08-24 23:38:07.998 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Order/create-from-cart - 400 236 application/json; charset=utf-8 2200.7378ms
2025-08-24 23:38:08.028 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:38:08.032 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:38:10.673 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2644.7669ms
2025-08-24 23:38:13.039 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:38:13.085 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:38:15.717 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2678.005ms
2025-08-24 23:38:18.042 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:38:18.050 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:38:20.982 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2940.3373ms
2025-08-24 23:38:23.039 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:38:23.046 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:38:25.681 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2642.021ms
2025-08-24 23:38:28.035 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:38:28.042 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:38:30.676 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2641.3971ms
2025-08-24 23:38:32.298 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Cart/checkout - null 0
2025-08-24 23:38:32.305 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:38:32.308 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-24 23:38:32.589 +03:00 [INF] Executed DbCommand (139ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-24 23:38:32.609 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.CheckOut (E-Commerce)'
2025-08-24 23:38:32.619 +03:00 [INF] Route matched with {action = "CheckOut", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] CheckOut() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-08-24 23:38:32.630 +03:00 [INF] Executing CheckOut
2025-08-24 23:38:32.634 +03:00 [INF] Checkout of cart for user: d1c4400e-e5cc-4af0-919e-8b1fded727fe
2025-08-24 23:38:32.637 +03:00 [INF] Retrieving cart for user: d1c4400e-e5cc-4af0-919e-8b1fded727fe
2025-08-24 23:38:32.920 +03:00 [INF] Executed DbCommand (141ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CheckoutDate`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-08-24 23:38:33.039 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:38:33.050 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:38:33.516 +03:00 [INF] Executed DbCommand (138ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
UPDATE `Cart` SET `CheckoutDate` = @p0
WHERE `Id` = @p1;
SELECT ROW_COUNT();
2025-08-24 23:38:33.526 +03:00 [INF] Removing cache by tag: cart
2025-08-24 23:38:34.174 +03:00 [INF] Removed 1 cache entries for tag: cart
2025-08-24 23:38:34.183 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-24 23:38:34.188 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.CheckOut (E-Commerce) in 1561.3576ms
2025-08-24 23:38:34.204 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.CheckOut (E-Commerce)'
2025-08-24 23:38:34.214 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Cart/checkout - 200 122 application/json; charset=utf-8 1915.8918ms
2025-08-24 23:38:35.969 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2930.2027ms
2025-08-24 23:38:38.035 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:38:38.046 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:38:40.989 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2954.151ms
2025-08-24 23:38:43.041 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:38:43.048 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:38:45.667 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Order/create-from-cart - application/json-patch+json 41
2025-08-24 23:38:45.673 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2632.0887ms
2025-08-24 23:38:45.679 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:38:45.689 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-24 23:38:45.986 +03:00 [INF] Executed DbCommand (138ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-24 23:38:45.998 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce)'
2025-08-24 23:38:46.001 +03:00 [INF] Route matched with {action = "CreateOrderFromCart", controller = "Order"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.OrderDtos.OrderWithPaymentDto]]] CreateOrderFromCart(E_Commerce.DtoModels.OrderDtos.CreateOrderDto) on controller E_Commerce.Controllers.OrderController (E-Commerce).
2025-08-24 23:38:46.007 +03:00 [INF] Executing CreateOrderFromCart
2025-08-24 23:38:46.011 +03:00 [INF] Creating order from cart for user: d1c4400e-e5cc-4af0-919e-8b1fded727fe
2025-08-24 23:38:46.574 +03:00 [INF] Executed DbCommand (140ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-08-24 23:38:46.721 +03:00 [INF] Executed DbCommand (138ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-08-24 23:38:46.731 +03:00 [INF] Checking if address 1 exists for customer: d1c4400e-e5cc-4af0-919e-8b1fded727fe
2025-08-24 23:38:46.872 +03:00 [INF] Executed DbCommand (138ms) [Parameters=[@__addressId_0='?' (DbType = Int32), @__customerId_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `CustomerAddresses` AS `c`
    WHERE ((`c`.`Id` = @__addressId_0) AND (`c`.`CustomerId` = @__customerId_1)) AND `c`.`DeletedAt` IS NULL)
2025-08-24 23:38:46.880 +03:00 [INF] Getting cart for user: d1c4400e-e5cc-4af0-919e-8b1fded727fe
2025-08-24 23:38:46.881 +03:00 [INF] Getting cache for key: cart_user_d1c4400e-e5cc-4af0-919e-8b1fded727fe
2025-08-24 23:38:47.096 +03:00 [WRN] Cache miss for key: cart_user_d1c4400e-e5cc-4af0-919e-8b1fded727fe
2025-08-24 23:38:47.237 +03:00 [INF] Executed DbCommand (138ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-08-24 23:38:47.244 +03:00 [INF] Execute GetAll for entity Cart
2025-08-24 23:38:47.400 +03:00 [INF] Executed DbCommand (150ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t`.`CheckoutDate`, `t`.`CreatedAt`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`FinalPrice`, `t0`.`DiscountName`, `t0`.`DiscountPrecentage`, `t0`.`MainImageUrl`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`Id1`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`UnitPrice`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`, `c`.`CheckoutDate`, `c`.`CreatedAt`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`)
        ELSE `p`.`Price`
    END AS `FinalPrice`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `DiscountName`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `DiscountPrecentage`, COALESCE((
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1), (
        SELECT `i0`.`Url`
        FROM `Images` AS `i0`
        WHERE (`p`.`Id` = `i0`.`ProductId`) AND `i0`.`DeletedAt` IS NULL
        LIMIT 1)) AS `MainImageUrl`, `p`.`IsActive`, `p0`.`Color`, `p0`.`Id` AS `Id1`, `p0`.`CreatedAt`, `p0`.`DeletedAt`, `p0`.`ModifiedAt`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `c1`.`UnitPrice`, `d`.`Id` AS `Id2`, `c1`.`CartId`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
    WHERE `p`.`IsActive` AND (`p`.`DeletedAt` IS NULL)
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id2`
2025-08-24 23:38:47.406 +03:00 [INF] Setting cache for key: cart_user_d1c4400e-e5cc-4af0-919e-8b1fded727fe
2025-08-24 23:38:47.627 +03:00 [INF] Cache set successfully for key: cart_user_d1c4400e-e5cc-4af0-919e-8b1fded727fe with tags: [cart]
2025-08-24 23:38:47.634 +03:00 [INF] Execute GetAll for entity ProductVariant
2025-08-24 23:38:47.798 +03:00 [INF] Executed DbCommand (138ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Color`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IsActive`, `p`.`Length`, `p`.`ModifiedAt`, `p`.`ProductId`, `p`.`Quantity`, `p`.`Size`, `p`.`Waist`
FROM `ProductVariants` AS `p`
WHERE `p`.`Id` = 1
2025-08-24 23:38:47.828 +03:00 [INF] Execute Update for entity ProductVariant
2025-08-24 23:38:47.832 +03:00 [INF] ProductVariant marked for update (pending save)
2025-08-24 23:38:47.988 +03:00 [INF] Executed DbCommand (140ms) [Parameters=[@__orderNumber_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Orders` AS `o`
    WHERE `o`.`OrderNumber` = @__orderNumber_0)
2025-08-24 23:38:47.999 +03:00 [INF] Executing CreateAsync for entity Order
2025-08-24 23:38:48.030 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:38:48.067 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:38:48.103 +03:00 [INF] Order added successfully (pending save)
2025-08-24 23:38:48.433 +03:00 [ERR] Failed executing DbCommand (141ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = DateTime), @p2='?' (DbType = Int32), @p3='?' (Size = 255), @p4='?' (DbType = DateTime), @p5='?' (DbType = DateTime), @p6='?' (DbType = Decimal), @p7='?' (DbType = DateTime), @p8='?' (Size = 500), @p9='?' (Size = 50), @p10='?' (DbType = DateTime), @p11='?' (DbType = DateTime), @p12='?' (DbType = Decimal), @p13='?' (DbType = Int32), @p14='?' (DbType = Decimal), @p15='?' (DbType = Decimal), @p16='?' (DbType = Decimal), @p27='?' (DbType = Int32), @p17='?' (Size = 4000), @p18='?' (DbType = DateTime), @p19='?' (DbType = DateTime), @p20='?' (DbType = Boolean), @p21='?' (DbType = Int32), @p22='?' (DbType = DateTime), @p23='?' (DbType = Int32), @p24='?' (DbType = Int32), @p25='?' (DbType = Int32), @p26='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `Orders` (`CancelledAt`, `CreatedAt`, `CustomerAddressId`, `CustomerId`, `DeletedAt`, `DeliveredAt`, `DiscountAmount`, `ModifiedAt`, `Notes`, `OrderNumber`, `RestockedAt`, `ShippedAt`, `ShippingCost`, `Status`, `Subtotal`, `TaxAmount`, `Total`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
SELECT `Id`
FROM `Orders`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

UPDATE `ProductVariants` SET `Color` = @p17, `CreatedAt` = @p18, `DeletedAt` = @p19, `IsActive` = @p20, `Length` = @p21, `ModifiedAt` = @p22, `ProductId` = @p23, `Quantity` = @p24, `Size` = @p25, `Waist` = @p26
WHERE `Id` = @p27;
SELECT ROW_COUNT();
2025-08-24 23:38:48.785 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'E_Commerce.Context.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Unknown column 'RestockedAt' in 'field list'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Unknown column 'RestockedAt' in 'field list'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-24 23:38:48.946 +03:00 [ERR] Exception while creating order for user d1c4400e-e5cc-4af0-919e-8b1fded727fe
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Unknown column 'RestockedAt' in 'field list'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at UnitOfWork.CommitAsync()
   at E_Commerce.Services.Order.OrderServices.CreateOrderFromCartAsync(String userId, CreateOrderDto orderDto)
2025-08-24 23:38:50.669 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2639.1271ms
2025-08-24 23:38:50.947 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.OrderDtos.OrderWithPaymentDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-24 23:38:50.950 +03:00 [INF] Executed action E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce) in 4944.6922ms
2025-08-24 23:38:50.953 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce)'
2025-08-24 23:38:50.955 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Order/create-from-cart - 500 246 application/json; charset=utf-8 5287.9062ms
2025-08-24 23:38:53.030 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:38:53.037 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:38:55.668 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2638.3466ms
2025-08-24 23:38:58.037 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:38:58.044 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:39:00.369 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2332.5991ms
2025-08-24 23:39:03.031 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:39:03.040 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:39:05.646 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2615.3026ms
2025-08-24 23:39:08.039 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:39:08.060 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:39:10.407 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2368.2776ms
2025-08-24 23:39:13.040 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:39:13.047 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:39:15.651 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2610.604ms
2025-08-24 23:39:18.038 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:39:18.051 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:39:20.658 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2620.0989ms
2025-08-24 23:39:23.043 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:39:23.050 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:39:25.662 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2618.8693ms
2025-08-24 23:39:28.042 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:39:28.052 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:39:30.661 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2618.3747ms
2025-08-24 23:39:33.035 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:39:33.044 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:39:35.670 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2634.6914ms
2025-08-24 23:39:38.040 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:39:38.048 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:39:40.975 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/hangfire/stats - 200 null application/json 2934.9056ms
2025-08-24 23:39:43.041 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/hangfire/stats - application/x-www-form-urlencoded; charset=UTF-8 392
2025-08-24 23:39:43.048 +03:00 [INF] CORS policy execution successful.
2025-08-24 23:39:55.746 +03:00 [INF] DB tables already exist. Exit install
2025-08-24 23:39:57.765 +03:00 [WRN] The foreign key property 'Customer.ImageId1' was created in shadow state because a conflicting property with the simple name 'ImageId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-08-24 23:40:00.010 +03:00 [INF] Executed DbCommand (148ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-24 23:40:01.305 +03:00 [INF] Executed DbCommand (138ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-24 23:40:01.608 +03:00 [INF] Executed DbCommand (139ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-24 23:40:01.630 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-24 23:40:01.651 +03:00 [INF] Starting data seeding...
2025-08-24 23:40:01.676 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-24 23:40:02.282 +03:00 [INF] Executed DbCommand (166ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-24 23:40:02.346 +03:00 [INF] Role 'Admin' already exists.
2025-08-24 23:40:02.625 +03:00 [INF] Executed DbCommand (137ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-24 23:40:02.634 +03:00 [INF] Role 'User' already exists.
2025-08-24 23:40:02.933 +03:00 [INF] Executed DbCommand (141ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`Gender`, `a`.`ImageId`, `a`.`ImageId1`, `a`.`LastVisit`, `a`.`Name`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-24 23:40:03.017 +03:00 [INF] Admin user already exists. Skipping provider/method creation.
2025-08-24 23:40:03.020 +03:00 [INF] Data seeding completed successfully.
2025-08-24 23:40:04.868 +03:00 [INF] Now listening on: http://localhost:5069
2025-08-24 23:40:04.944 +03:00 [INF] Starting Hangfire Server using job storage: 'Server: mysql-3581f657-omargamal1132004-b0c1.b.aivencloud.com@Fashion_Site'
2025-08-24 23:40:04.946 +03:00 [INF] Using the following options for SQL Server job storage:
2025-08-24 23:40:04.949 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-08-24 23:40:04.951 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-24 23:40:04.963 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-24 23:40:04.966 +03:00 [INF] Hosting environment: Development
2025-08-24 23:40:05.009 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-08-24 23:40:05.296 +03:00 [INF] Server mrrobot:12356:eaf2ab38 successfully announced in 284.9933 ms
2025-08-24 23:40:05.300 +03:00 [INF] Server mrrobot:12356:eaf2ab38 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-24 23:40:05.360 +03:00 [INF] Server mrrobot:12356:eaf2ab38 all the dispatchers started
